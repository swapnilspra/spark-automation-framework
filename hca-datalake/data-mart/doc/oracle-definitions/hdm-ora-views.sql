CREATE OR REPLACE FORCE VIEW HDM.VW_10KGROWTH_CHART(DATE_1, FUND_NAME, FUND_CLASS, FUND_QUOTE, FUND_CMP, FUND_SORT, WEALTH_INDEX, BENCHMARK_NAME_1, WEALTH_INDEX_1, BENCHMARK_NAME_2, WEALTH_INDEX_2, BENCHMARK_NAME_3, WEALTH_INDEX_3, BENCHMARK_NAME_4, WEALTH_INDEX_4) AS 
SELECT f.cal_day,
             f.fund_Nm,
             f.shr_cls_desc,
             f.quot_sym,
             f.fund_compst_key,
             f.fund_sort_ord,
             f.wlth_idx,
             bm1.idx_nm           bm1_idx_nm,
             bm1.idx_vltn_amt     bm1_wlth_idx,
             bm2.idx_nm           bm2_idx_nm,
             bm2.idx_vltn_amt     bm2_wlth_idx,
             bm3.idx_nm           bm3_idx_nm,
             bm3.idx_vltn_amt     bm3_wlth_idx,
             bm4.idx_nm           bm4_idx_nm,
             bm4.wlth_idx         bm4_wlth_idx
        FROM (SELECT C.cal_day,
                     c.day_key,
                     f.fund_nm,
                     f.SHR_CLS_DESC,
                     f.QUOT_SYM,
                     f.FUND_COMPST_KEY,
                     f.fund_sort_ord,
                     A.wlth_idx,
                     f.fund_key
                FROM hdm.vw_fund_valuation a,
                     hdm.vw_fund          f,
                     hdm.vw_fund_composite fc,
                     hdm.vw_calendar      c
               WHERE     a.fund_key = f.fund_key
                     AND A.day_key = c.day_key
                     AND f.fund_compst_key = fc.fund_compst_key
                     AND f.FUND_STAT_CD IN (1, 5)) f
             LEFT OUTER JOIN
             (SELECT cal_day,
                     c.day_key,
                     idx_nm,
                     b.idx_id,
                     f.fund_compst_key,
                     a.IDX_VLTN_AMT,
                     f.fund_key
                FROM hdm.vw_index_valuation a,
                     hdm.vw_calendar       c,
                     hdm.vw_benchmark_index b,
                     hdm.vw_fund           f,
                     hdm.vw_fund_composite fc,
                     hdm.vw_fund_index_rltn bf
               WHERE     a.day_key = c.day_key
                     AND c.cal_day >= f.FUND_INCPN_DT
                     AND a.bmk_idx_key = b.bmk_idx_key
                     AND f.fund_compst_key = fc.fund_compst_key
                     AND bf.fund_compst_key = fc.fund_compst_key
                     AND bf.bmk_idx_key = b.bmk_idx_key
                     AND bf.link_prio = 1
                     AND perf_run_type_key = 3
                     AND bf.GR_RET_INLSN_FLG = 'Y') bm1
                 ON     f.day_key = bm1.day_key
                    AND f.fund_compst_key = bm1.fund_compst_key
                    AND f.fund_key = bm1.fund_key
             LEFT OUTER JOIN
             (SELECT cal_day,
                     c.day_key,
                     idx_nm,
                     b.idx_id,
                     f.fund_compst_key,
                     a.IDX_VLTN_AMT,
                     f.fund_key
                FROM hdm.vw_index_valuation a,
                     hdm.vw_calendar       c,
                     hdm.vw_benchmark_index b,
                     hdm.vw_fund           f,
                     hdm.vw_fund_composite fc,
                     hdm.vw_fund_index_rltn bf
               WHERE     a.day_key = c.day_key
                     AND c.cal_day >= f.FUND_INCPN_DT
                     AND a.bmk_idx_key = b.bmk_idx_key
                     AND f.fund_compst_key = fc.fund_compst_key
                     AND bf.fund_compst_key = fc.fund_compst_key
                     AND bf.bmk_idx_key = b.bmk_idx_key
                     AND bf.link_prio = 2
                     AND perf_run_type_key = 3
                     AND bf.GR_RET_INLSN_FLG = 'Y') bm2
                 ON     f.day_key = bm2.day_key
                    AND f.fund_compst_key = bm2.fund_compst_key
                    AND f.fund_key = bm2.fund_key
             LEFT OUTER JOIN
             (SELECT cal_day,
                     c.day_key,
                     idx_nm,
                     b.idx_id,
                     f.fund_compst_key,
                     a.IDX_VLTN_AMT,
                     f.fund_key
                FROM hdm.vw_index_valuation a,
                     hdm.vw_calendar       c,
                     hdm.vw_benchmark_index b,
                     hdm.vw_fund           f,
                     hdm.vw_fund_composite fc,
                     hdm.vw_fund_index_rltn bf
               WHERE     a.day_key = c.day_key
                     AND c.cal_day >= f.FUND_INCPN_DT
                     AND a.bmk_idx_key = b.bmk_idx_key
                     AND f.fund_compst_key = fc.fund_compst_key
                     AND bf.fund_compst_key = fc.fund_compst_key
                     AND bf.bmk_idx_key = b.bmk_idx_key
                     AND bf.link_prio = 3
                     AND perf_run_type_key = 3
                     AND bf.GR_RET_INLSN_FLG = 'Y') bm3
                 ON     f.day_key = bm3.day_key
                    AND f.fund_compst_key = bm3.fund_compst_key
                    AND f.fund_key = bm3.fund_key
             LEFT OUTER JOIN
             (    SELECT cal.day_key,cal.cal_day,cal.fund_compst_key,cal.fund_key,cal.idx_nm,cal.bus_day_flg,
                 (Case When wi.wlth_idx is null then (select wlth_idx 
                                                        from hdm.vw_target_wealth_index twi, hdm.vw_calendar cl,hdm.vw_target_performance_type tp 
                                                        where twi.DAY_KEY = cl.DAY_KEY and twi.TRGT_PERF_TYPE_KEY = tp.TRGT_PERF_TYPE_KEY
                                                        and twi.FUND_KEY=cal.fund_key and tp.TRGT_PERF_TYPE='RBWM'
                                                        and cl.cal_day = (select max(cal_day) from hdm.vw_calendar where cal_day < cal.cal_day and bus_day_flg='Y'))
                                                else wi.wlth_idx end) wlth_idx
                 from    
                 (   select cal_day,day_key,fund_compst_key,b.TRGT_PERF_TYPE_KEY,trgt_perf_type_desc || replace(replace(fund_nm,'Target Retirement',''),'Fund','') Idx_nm,fund_sort_ord,fund_key,bus_day_flg
                    from hdm.vw_calendar c, hdm.vw_fund f, hdm.vw_target_performance_type b
                    where cal_day >= f.PERF_INCPN_DT - 1 and cal_day < trunc(sysdate)
                    and fund_nm like 'Target%'
                    and trgt_perf_type = 'RBWM'   
                    and f.FUND_STAT_DESC in ('Open','Soft Close')
                    AND SHR_CLS_DESC = 'Institutional Class' ) cal
                    left outer join
                (    select  day_key,wlth_idx,b.trgt_perf_type_key,trgt_perf_type_desc || replace(replace(fund_nm,'Target Retirement',''),'Fund','') Idx_nm,f.FUND_COMPST_KEY,f.fund_key
                    from hdm.vw_target_wealth_index a, hdm.vw_target_performance_type b, hdm.vw_fund f
                    where  a.fund_key=f.fund_key and a.TRGT_PERF_TYPE_KEY = b.TRGT_PERF_TYPE_KEY
                    and trgt_perf_type = 'RBWM'  ) wi
                    on  cal.day_key=wi.day_key and cal.trgt_perf_type_key=wi.trgt_perf_type_key and cal.fund_key=wi.fund_key ) BM4
                 ON     F.day_key = bm4.day_key
                    AND f.fund_compst_key = bm4.fund_compst_key
                    AND F.FUnd_key = bm4.fund_key
       WHERE bm1.idx_nm IS NOT NULL
    ORDER BY f.fund_sort_ord, f.cal_day
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCOUNT(ACCT_KEY, ACCT_TOP_LVL_CD, ACCT_TOP_LVL_DESC, ACCT_TYPE_CD, ACCT_TYPE, ACCT_NBR, FUND_NBR, TAX_ID, ACCT_STAT_CD, ACCT_STAT, ACCT_STRT_DT, LAST_MNTN_DT, DLR_LVL_CNTL_CD, DLR_LVL_CNTL_DESC, PRE_AUTHZD_CHK_ACCT_FLG, SWP_ACCT_FLG, ACH_ACCT_FLG, RE_INVST_TO_ANOTHER_ACCT_FLG, MONITORED_VIP_ACCT, FIDUCIARY_ACCT_FLG, MAILG_FLG, INTR_PARTY_FLG, MGMT_CO_EMPL_FLG, TRST_CO_NBR, TPA_NBR, CUSTODIAN_ID, TPA_ID, EXT_PLN_ID, TIN_CD, TIN_DESC, ALPHA_CD, CAP_GAINS_DSTRBTN_FLG, CHK_WRITING_ACCT_FLG, DIVD_DSTRBTN_OPT_FLG, EXPEDITED_REDMPN_ACCT_FLG, SUB_ACCT_FLG, FORGN_TAX_RT, CUM_DISCNT_NBR, LTR_OF_INTEND_NBR, TIMER_FLG, GPURCH_ACCT_FLG, EXPDT_XCHG_ACCT_FLG, PNLTY_WHG_ACCT_FLG, CERTFC_ISSUANCE_FLG, STOP_XFER_FLG, BLUESKY_XMPTN_FLG, BNK_CARD_ISSD_FLG, NAV_ACCT_FLG, PHON_CHK_REDMPN_FLG, HOUSE_ACCT_FLG, DIVD_MAIL_ACCT_FLG, STOP_PURCH_ACCT_FLG, STOP_MAIL_ACCT_FLG, FRACTIONAL_CHK_FLG, ACCT_PR_SCHED_FLG, CAP_GAINS_DSTRBTN_CD, CAP_GAINS_DSTRBTN_TYPE, DIVD_DSTRBTN_TYPE_CD, DIVD_DSTRBTN_TYPE, CUST_BIN, ACCT_ORIGINATION_ID, REGSTN_LINE_1, REGSTN_LINE_2, REGSTN_LINE_3, REGSTN_LINE_4, REGSTN_LINE_5, REGSTN_LINE_6, REGSTN_LINE_7, ST_NM, CRTY_NM, ST_CD, CRTY_CD, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, LEGACY_TYPE_DESC, FUND_STRT_DT, STOP_MAIL_DT, ACCT_SETUP_DT, INTERNET_ACCT_FLG, GRND_FATHER_ACCT_FLG, PLN_CLSFCN_FLG, MKTG_CLSFCN_FLG, MKTG_CLSFCN_DESC, REP_CD, REP_NM, DLR_ID, DLR_TYPE, HBR_DLR_ID, HBR_DLR_NM, TRST_NM, ACCT_CLSD_DT, REDMPN_FEE_XMPT_FLG, PAY_TO_PLAY_FLG, CITZN_ST_CRTY_CD, PURG_PRCSD_FLG, PURG_PRCSD_DT) AS 
SELECT "ACCT_KEY","ACCT_TOP_LVL_CD","ACCT_TOP_LVL_DESC","ACCT_TYPE_CD","ACCT_TYPE","ACCT_NBR","FUND_NBR","TAX_ID","ACCT_STAT_CD","ACCT_STAT","ACCT_STRT_DT","LAST_MNTN_DT","DLR_LVL_CNTL_CD","DLR_LVL_CNTL_DESC","PRE_AUTHZD_CHK_ACCT_FLG","SWP_ACCT_FLG","ACH_ACCT_FLG","RE_INVST_TO_ANOTHER_ACCT_FLG","MONITORED_VIP_ACCT","FIDUCIARY_ACCT_FLG","MAILG_FLG","INTR_PARTY_FLG","MGMT_CO_EMPL_FLG","TRST_CO_NBR","TPA_NBR","CUSTODIAN_ID","TPA_ID","EXT_PLN_ID","TIN_CD","TIN_DESC","ALPHA_CD","CAP_GAINS_DSTRBTN_FLG","CHK_WRITING_ACCT_FLG","DIVD_DSTRBTN_OPT_FLG","EXPEDITED_REDMPN_ACCT_FLG","SUB_ACCT_FLG","FORGN_TAX_RT","CUM_DISCNT_NBR","LTR_OF_INTEND_NBR","TIMER_FLG","GPURCH_ACCT_FLG","EXPDT_XCHG_ACCT_FLG","PNLTY_WHG_ACCT_FLG","CERTFC_ISSUANCE_FLG","STOP_XFER_FLG","BLUESKY_XMPTN_FLG","BNK_CARD_ISSD_FLG","NAV_ACCT_FLG","PHON_CHK_REDMPN_FLG","HOUSE_ACCT_FLG","DIVD_MAIL_ACCT_FLG","STOP_PURCH_ACCT_FLG","STOP_MAIL_ACCT_FLG","FRACTIONAL_CHK_FLG","ACCT_PR_SCHED_FLG","CAP_GAINS_DSTRBTN_CD","CAP_GAINS_DSTRBTN_TYPE","DIVD_DSTRBTN_TYPE_CD","DIVD_DSTRBTN_TYPE","CUST_BIN","ACCT_ORIGINATION_ID","REGSTN_LINE_1","REGSTN_LINE_2","REGSTN_LINE_3","REGSTN_LINE_4","REGSTN_LINE_5","REGSTN_LINE_6","REGSTN_LINE_7","ST_NM","CRTY_NM","ST_CD","CRTY_CD","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","LEGACY_TYPE_DESC","FUND_STRT_DT","STOP_MAIL_DT","ACCT_SETUP_DT","INTERNET_ACCT_FLG","GRND_FATHER_ACCT_FLG","PLN_CLSFCN_FLG","MKTG_CLSFCN_FLG","MKTG_CLSFCN_DESC","REP_CD","REP_NM","DLR_ID","DLR_TYPE","HBR_DLR_ID","HBR_DLR_NM","TRST_NM","ACCT_CLSD_DT","REDMPN_FEE_XMPT_FLG","PAY_TO_PLAY_FLG","CITZN_ST_CRTY_CD","PURG_PRCSD_FLG","PURG_PRCSD_DT"
FROM  ACCOUNT
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCOUNT_CATEGORY(ACCT_CAT_KEY, ACCT_CAT_DESC, MAJ_CAT_CD, MAJ_CAT_DESC, ACCT_CAT_ORDER) AS 
SELECT "ACCT_CAT_KEY",
          "ACCT_CAT_DESC",
          "MAJ_CAT_CD",
          "MAJ_CAT_DESC",
          ACCT_CAT_ORD
     FROM Account_Category
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCOUNT_POSITION(ACCT_POSN_KEY, ACCT_KEY, FUND_KEY, SHRHLDR_KEY, DLR_KEY, HBR_DLR_KEY, DLR_BRANCH_KEY, DAY_KEY, ACCT_NBR, FUND_NBR, SHRHLDR_ROLE_KEY, TOT_SHRS, TOT_BAL_AMT, UN_ISSD_SHRS, ISSD_SHRS, NAV, RSRVD_SHRS, ACCRD_DIVD_AMT, ESCRW_SHRS, COLLCTD_SHRS, COLLCTD_BAL_AMT, CURR_INCM_DIVD, CURR_LONG_TERM_CAP_GAIN, CURR_SHRT_TERM_CAP_GAIN, CURR_FORGN_W_HOLDG, CURR_DIVD_W_HOLDG, CURR_FORGN_TAX_PAID_AMT, CURR_YR_1099B_GR_REDMPN_AMT, CURR_YR_1099B_GR_W_HOLDG_AMT, COLLCTD_SHRS_NET_CHG_CNT, TOT_SHRS_NET_CHG_CNT, DSGNTD_W_HOLDG_AMT, DSGNTD_W_HOLDG_RT, DIVD_W_HOLDG_AMT, DIVD_W_HOLDG_RT, SHRT_TERM_CAP_GAIN_W_HOLDG_AMT, SHRT_TERM_CAP_GAIN_W_HOLDG_RT, LONG_TERM_CAP_GAIN_W_HOLDG_AMT, LONG_TERM_CAP_GAIN_W_HOLDG_RT, PARTITION_YR, ACCT_STAT_CD, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT ACCOUNT_POSITION.ACCT_POSN_KEY,
           ACCOUNT_POSITION.ACCT_KEY,
           ACCOUNT_POSITION.FUND_KEY,
           ACCOUNT_POSITION.SHRHLDR_KEY,
           ACCOUNT_POSITION.DLR_KEY,
           ACCOUNT_POSITION.hbr_DLR_KEY,
           ACCOUNT_POSITION.DLR_BRANCH_KEY,
           ACCOUNT_POSITION.DAY_KEY,
           ACCOUNT_POSITION.ACCT_NBR,
           FUND.FUND_NBR,
           ACCOUNT_POSITION.SHRHLDR_ROLE_KEY,
           ACCOUNT_POSITION.TOT_SHRS,
           ACCOUNT_POSITION.TOT_BAL_AMT,
           ACCOUNT_POSITION.UN_ISSD_SHRS,
           ACCOUNT_POSITION.ISSD_SHRS,
           ACCOUNT_POSITION.NAV,
           ACCOUNT_POSITION.RSRVD_SHRS,
           ACCOUNT_POSITION.ACCRD_DIVD_AMT,
           ACCOUNT_POSITION.ESCRW_SHRS,
           ACCOUNT_POSITION.COLLCTD_SHRS,
           ACCOUNT_POSITION.COLLCTD_BAL_AMT,
           ACCOUNT_POSITION.CURR_INCM_DIVD,
           ACCOUNT_POSITION.CURR_LONG_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_SHRT_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_FORGN_W_HOLDG,
           ACCOUNT_POSITION.CURR_DIVD_W_HOLDG,
           ACCOUNT_POSITION.CURR_FORGN_TAX_PAID_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_REDMPN_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_W_HOLDG_AMT,
           ACCOUNT_POSITION.COLLCTD_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.TOT_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_RT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_RT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.PARTITION_YR,
           ACCOUNT_POSITION.ACCT_STAT_CD,
           ACCOUNT_POSITION.ROW_STRT_DTTM,
           ACCOUNT_POSITION.ROW_STOP_DTTM,
           ACCOUNT_POSITION.CURR_ROW_FLG,
           ACCOUNT_POSITION.ETL_LOAD_CYC_KEY,
           ACCOUNT_POSITION.SRC_SYS_ID
      FROM Account_Position, FUND
     WHERE ACCOUNT_POSITION.FUND_KEY = FUND.FUND_KEY
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCOUNT_POSITION_HIST(ACCT_POSN_KEY, ACCT_KEY, FUND_KEY, SHRHLDR_KEY, DLR_KEY, HBR_DLR_KEY, DLR_BRANCH_KEY, DAY_KEY, ACCT_NBR, FUND_NBR, SHRHLDR_ROLE_KEY, TOT_SHRS, TOT_BAL_AMT, UN_ISSD_SHRS, ISSD_SHRS, NAV, RSRVD_SHRS, ACCRD_DIVD_AMT, ESCRW_SHRS, COLLCTD_SHRS, COLLCTD_BAL_AMT, CURR_INCM_DIVD, CURR_LONG_TERM_CAP_GAIN, CURR_SHRT_TERM_CAP_GAIN, CURR_FORGN_W_HOLDG, CURR_DIVD_W_HOLDG, CURR_FORGN_TAX_PAID_AMT, CURR_YR_1099B_GR_REDMPN_AMT, CURR_YR_1099B_GR_W_HOLDG_AMT, COLLCTD_SHRS_NET_CHG_CNT, TOT_SHRS_NET_CHG_CNT, DSGNTD_W_HOLDG_AMT, DSGNTD_W_HOLDG_RT, DIVD_W_HOLDG_AMT, DIVD_W_HOLDG_RT, SHRT_TERM_CAP_GAIN_W_HOLDG_AMT, SHRT_TERM_CAP_GAIN_W_HOLDG_RT, LONG_TERM_CAP_GAIN_W_HOLDG_AMT, LONG_TERM_CAP_GAIN_W_HOLDG_RT, PARTITION_YR, ACCT_STAT_CD, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT ACCOUNT_POSITION.ACCT_POSN_KEY,
           ACCOUNT_POSITION.ACCT_KEY,
           ACCOUNT_POSITION.FUND_KEY,
           ACCOUNT_POSITION.SHRHLDR_KEY,
           ACCOUNT_POSITION.DLR_KEY,
           ACCOUNT_POSITION.hbr_DLR_KEY,
           ACCOUNT_POSITION.DLR_BRANCH_KEY,
           ACCOUNT_POSITION.DAY_KEY,
           ACCOUNT_POSITION.ACCT_NBR,
           FUND.FUND_NBR,
           ACCOUNT_POSITION.SHRHLDR_ROLE_KEY,
           ACCOUNT_POSITION.TOT_SHRS,
           ACCOUNT_POSITION.TOT_BAL_AMT,
           ACCOUNT_POSITION.UN_ISSD_SHRS,
           ACCOUNT_POSITION.ISSD_SHRS,
           ACCOUNT_POSITION.NAV,
           ACCOUNT_POSITION.RSRVD_SHRS,
           ACCOUNT_POSITION.ACCRD_DIVD_AMT,
           ACCOUNT_POSITION.ESCRW_SHRS,
           ACCOUNT_POSITION.COLLCTD_SHRS,
           ACCOUNT_POSITION.COLLCTD_BAL_AMT,
           ACCOUNT_POSITION.CURR_INCM_DIVD,
           ACCOUNT_POSITION.CURR_LONG_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_SHRT_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_FORGN_W_HOLDG,
           ACCOUNT_POSITION.CURR_DIVD_W_HOLDG,
           ACCOUNT_POSITION.CURR_FORGN_TAX_PAID_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_REDMPN_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_W_HOLDG_AMT,
           ACCOUNT_POSITION.COLLCTD_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.TOT_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_RT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_RT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.PARTITION_YR,
           ACCOUNT_POSITION.ACCT_STAT_CD,
           ACCOUNT_POSITION.ROW_STRT_DTTM,
           ACCOUNT_POSITION.ROW_STOP_DTTM,
           ACCOUNT_POSITION.CURR_ROW_FLG,
           ACCOUNT_POSITION.ETL_LOAD_CYC_KEY,
           ACCOUNT_POSITION.SRC_SYS_ID
      FROM Account_Position_hist account_position , FUND
     WHERE ACCOUNT_POSITION.FUND_KEY = FUND.FUND_KEY
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCOUNT_POSITION_UNION(ACCT_POSN_KEY, ACCT_KEY, FUND_KEY, SHRHLDR_KEY, DLR_KEY, HBR_DLR_KEY, DLR_BRANCH_KEY, DAY_KEY, ACCT_NBR, FUND_NBR, SHRHLDR_ROLE_KEY, TOT_SHRS, TOT_BAL_AMT, UN_ISSD_SHRS, ISSD_SHRS, NAV, RSRVD_SHRS, ACCRD_DIVD_AMT, ESCRW_SHRS, COLLCTD_SHRS, COLLCTD_BAL_AMT, CURR_INCM_DIVD, CURR_LONG_TERM_CAP_GAIN, CURR_SHRT_TERM_CAP_GAIN, CURR_FORGN_W_HOLDG, CURR_DIVD_W_HOLDG, CURR_FORGN_TAX_PAID_AMT, CURR_YR_1099B_GR_REDMPN_AMT, CURR_YR_1099B_GR_W_HOLDG_AMT, COLLCTD_SHRS_NET_CHG_CNT, TOT_SHRS_NET_CHG_CNT, DSGNTD_W_HOLDG_AMT, DSGNTD_W_HOLDG_RT, DIVD_W_HOLDG_AMT, DIVD_W_HOLDG_RT, SHRT_TERM_CAP_GAIN_W_HOLDG_AMT, SHRT_TERM_CAP_GAIN_W_HOLDG_RT, LONG_TERM_CAP_GAIN_W_HOLDG_AMT, LONG_TERM_CAP_GAIN_W_HOLDG_RT, PARTITION_YR, ACCT_STAT_CD, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT ACCOUNT_POSITION.ACCT_POSN_KEY,
           ACCOUNT_POSITION.ACCT_KEY,
           ACCOUNT_POSITION.FUND_KEY,
           ACCOUNT_POSITION.SHRHLDR_KEY,
           ACCOUNT_POSITION.DLR_KEY,
           ACCOUNT_POSITION.hbr_DLR_KEY,
           ACCOUNT_POSITION.DLR_BRANCH_KEY,
           ACCOUNT_POSITION.DAY_KEY,
           ACCOUNT_POSITION.ACCT_NBR,
           FUND.FUND_NBR,
           ACCOUNT_POSITION.SHRHLDR_ROLE_KEY,
           ACCOUNT_POSITION.TOT_SHRS,
           ACCOUNT_POSITION.TOT_BAL_AMT,
           ACCOUNT_POSITION.UN_ISSD_SHRS,
           ACCOUNT_POSITION.ISSD_SHRS,
           ACCOUNT_POSITION.NAV,
           ACCOUNT_POSITION.RSRVD_SHRS,
           ACCOUNT_POSITION.ACCRD_DIVD_AMT,
           ACCOUNT_POSITION.ESCRW_SHRS,
           ACCOUNT_POSITION.COLLCTD_SHRS,
           ACCOUNT_POSITION.COLLCTD_BAL_AMT,
           ACCOUNT_POSITION.CURR_INCM_DIVD,
           ACCOUNT_POSITION.CURR_LONG_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_SHRT_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_FORGN_W_HOLDG,
           ACCOUNT_POSITION.CURR_DIVD_W_HOLDG,
           ACCOUNT_POSITION.CURR_FORGN_TAX_PAID_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_REDMPN_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_W_HOLDG_AMT,
           ACCOUNT_POSITION.COLLCTD_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.TOT_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_RT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_RT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.PARTITION_YR,
           ACCOUNT_POSITION.ACCT_STAT_CD,
           ACCOUNT_POSITION.ROW_STRT_DTTM,
           ACCOUNT_POSITION.ROW_STOP_DTTM,
           ACCOUNT_POSITION.CURR_ROW_FLG,
           ACCOUNT_POSITION.ETL_LOAD_CYC_KEY,
           ACCOUNT_POSITION.SRC_SYS_ID
      FROM Account_Position , FUND
     WHERE ACCOUNT_POSITION.FUND_KEY = FUND.FUND_KEY
     union all
     SELECT ACCOUNT_POSITION.ACCT_POSN_KEY,
           ACCOUNT_POSITION.ACCT_KEY,
           ACCOUNT_POSITION.FUND_KEY,
           ACCOUNT_POSITION.SHRHLDR_KEY,
           ACCOUNT_POSITION.DLR_KEY,
           ACCOUNT_POSITION.hbr_DLR_KEY,
           ACCOUNT_POSITION.DLR_BRANCH_KEY,
           ACCOUNT_POSITION.DAY_KEY,
           ACCOUNT_POSITION.ACCT_NBR,
           FUND.FUND_NBR,
           ACCOUNT_POSITION.SHRHLDR_ROLE_KEY,
           ACCOUNT_POSITION.TOT_SHRS,
           ACCOUNT_POSITION.TOT_BAL_AMT,
           ACCOUNT_POSITION.UN_ISSD_SHRS,
           ACCOUNT_POSITION.ISSD_SHRS,
           ACCOUNT_POSITION.NAV,
           ACCOUNT_POSITION.RSRVD_SHRS,
           ACCOUNT_POSITION.ACCRD_DIVD_AMT,
           ACCOUNT_POSITION.ESCRW_SHRS,
           ACCOUNT_POSITION.COLLCTD_SHRS,
           ACCOUNT_POSITION.COLLCTD_BAL_AMT,
           ACCOUNT_POSITION.CURR_INCM_DIVD,
           ACCOUNT_POSITION.CURR_LONG_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_SHRT_TERM_CAP_GAIN,
           ACCOUNT_POSITION.CURR_FORGN_W_HOLDG,
           ACCOUNT_POSITION.CURR_DIVD_W_HOLDG,
           ACCOUNT_POSITION.CURR_FORGN_TAX_PAID_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_REDMPN_AMT,
           ACCOUNT_POSITION.CURR_YR_1099B_GR_W_HOLDG_AMT,
           ACCOUNT_POSITION.COLLCTD_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.TOT_SHRS_NET_CHG_CNT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DSGNTD_W_HOLDG_RT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_AMT,
           ACCOUNT_POSITION.DIVD_W_HOLDG_RT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.SHRT_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_AMT,
           ACCOUNT_POSITION.LONG_TERM_CAP_GAIN_W_HOLDG_RT,
           ACCOUNT_POSITION.PARTITION_YR,
           ACCOUNT_POSITION.ACCT_STAT_CD,
           ACCOUNT_POSITION.ROW_STRT_DTTM,
           ACCOUNT_POSITION.ROW_STOP_DTTM,
           ACCOUNT_POSITION.CURR_ROW_FLG,
           ACCOUNT_POSITION.ETL_LOAD_CYC_KEY,
           ACCOUNT_POSITION.SRC_SYS_ID
      FROM Account_Position_hist account_position , FUND
     WHERE ACCOUNT_POSITION.FUND_KEY = FUND.FUND_KEY
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ACCT_YR(ACCT_SETUP_YR_KEY, ACCT_SETUP_YR) AS 
select "ACCT_SETUP_YR_KEY","ACCT_SETUP_YR" from HDM.ACCOUNT_SETUP_YEAR
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AFTER_TAX_CALCULATION(ATAX_CALC_KEY, REINV_DAY_KEY, DAY_KEY, FUND_KEY, PER_KEY, TAX_YR, CB_AMT, SHRS_CALC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ATAX_CALC_KEY","REINV_DAY_KEY","DAY_KEY","FUND_KEY","PER_KEY","TAX_YR","CB_AMT","SHRS_CALC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM After_Tax_Calculation
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AFTER_TAX_RETURN(ATAX_RET_KEY, DAY_KEY, FUND_KEY, PER_KEY, SOLD_AMT, CB_AMT, GLS_AMT, ST_TAX_GLS, LT_TAX_GLS, TAX_AMT, NET_PRCD_ATAX, STRT_PER, ANNLZN_FCTR, ATAX_RET_WO_SALE, ATAX_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ATAX_RET_KEY","DAY_KEY","FUND_KEY","PER_KEY","SOLD_AMT","CB_AMT","GLS_AMT","ST_TAX_GLS","LT_TAX_GLS","TAX_AMT","NET_PRCD_ATAX","STRT_PER","ANNLZN_FCTR","ATAX_RET_WO_SALE","ATAX_RET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM After_Tax_Return
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AFTER_TAX_WEALTH_INDEX(ATAX_WLTH_IDX_KEY, DAY_KEY, REINV_DAY_KEY, FUND_KEY, ATAX_ORDN_INCM, ATAX_LTCG, ATAX_STCG, ATAX_FORGN_TAX_CR, ATAX_TOT_DIVD, PRIR_MO_PR, CURR_MO_PR, REINV_PR, BTAX_RET, ATAX_RET, ATAX_REINV_PER_SHR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ATAX_WLTH_IDX_KEY",
          "DAY_KEY",
          "REINV_DAY_KEY",
          "FUND_KEY",
          "ATAX_ORDN_INCM",
          "ATAX_LTCG",
          "ATAX_STCG",
          "ATAX_FORGN_TAX_CR",
          "ATAX_TOT_DIVD",
          "PRIR_MO_PR",
          "CURR_MO_PR",
          "REINV_PR",
          "BTAX_RET",
          "ATAX_RET",
          "ATAX_REINV_PER_SHR",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID"
     FROM After_Tax_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_PRIVILEGE_TYPE(PRVL_TYPE_KEY, PRVL_TYPE, PRVL_TYPE_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PRVL_TYPE_KEY","PRVL_TYPE","PRVL_TYPE_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Privilege_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_QUEUE(Q_KEY, Q_CD, Q_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "Q_KEY","Q_CD","Q_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Queue
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_RECORD_TYPE(REC_TYPE_KEY, REC_CD, REC_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "REC_TYPE_KEY","REC_CD","REC_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Record_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_ROLE(ROLE_KEY, ROLE_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ROLE_KEY","ROLE_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Role
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_ROLE_PRIVILEGE(ROLE_PRVL_KEY, REC_TYPE_KEY, ROLE_KEY, PRVL_TYPE_KEY, DAY_KEY, UT_CD, EXIST_FLG, VIEW_FLG, UPDT_FLG, WK_SLCTN_FLG, LAST_MAINT_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ROLE_PRVL_KEY","REC_TYPE_KEY","ROLE_KEY","PRVL_TYPE_KEY","DAY_KEY","UT_CD","EXIST_FLG","VIEW_FLG","UPDT_FLG","WK_SLCTN_FLG","LAST_MAINT_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Role_Privilege
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_USER(USR_KEY, GRP_NM, USR_STAT_CD, USR_STAT_DESC, USR_ID, FIRST_NM, MINT, LAST_NM, TAX_ID, CLSFCN, LCK_STAT, Q_FLG, PHON_NBR, FAX_NBR, WK_SLCTN_CD, FAX_DEPT, ROUT_USR_ID, SEC_LVL_CD, UT_CD, LAST_MAINT_DT, LAST_DT, LAST_PSWD_MAINT_DT, AWD_DESKTOP_VRSN, DATA_REVS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "USR_KEY","GRP_NM","USR_STAT_CD","USR_STAT_DESC","USR_ID","FIRST_NM","MINT","LAST_NM","TAX_ID","CLSFCN","LCK_STAT","Q_FLG","PHON_NBR","FAX_NBR","WK_SLCTN_CD","FAX_DEPT","ROUT_USR_ID","SEC_LVL_CD","UT_CD","LAST_MAINT_DT","LAST_DT","LAST_PSWD_MAINT_DT","AWD_DESKTOP_VRSN","DATA_REVS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from awd_user
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_USER_QUEUE(USR_Q_KEY, Q_KEY, USR_KEY, DAY_KEY, UT_CD, EXIST_FLG, VIEW_FLG, UPDT_FLG, WK_SLCTN_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "USR_Q_KEY","Q_KEY","USR_KEY","DAY_KEY","UT_CD","EXIST_FLG","VIEW_FLG","UPDT_FLG","WK_SLCTN_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_User_Queue
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_USER_ROLE(USR_ROLE_KEY, ROLE_KEY, USR_KEY, DAY_KEY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "USR_ROLE_KEY","ROLE_KEY","USR_KEY","DAY_KEY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_User_Role
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_USER_WORK_TYPE(USR_WK_TYPE_KEY, REC_TYPE_KEY, WK_TYPE_KEY, USR_KEY, DAY_KEY, UT_CD, EXIST_FLG, VIEW_FLG, UPDT_FLG, WK_SLCTN_FLG, LAST_MAINT_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "USR_WK_TYPE_KEY","REC_TYPE_KEY","WK_TYPE_KEY","USR_KEY","DAY_KEY","UT_CD","EXIST_FLG","VIEW_FLG","UPDT_FLG","WK_SLCTN_FLG","LAST_MAINT_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_User_Work_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_AWD_WORK_TYPE(WK_TYPE_KEY, WK_TYPE_NM, WK_TYPE_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "WK_TYPE_KEY","WK_TYPE_NM","WK_TYPE_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM AWD_Work_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BALANCE_CATEGORY(BAL_CAT_KEY, CAT_DESC, CAT_MIN, CAT_MAX) AS 
select "BAL_CAT_KEY","CAT_DESC","CAT_MIN","CAT_MAX" from Balance_Category
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BENCHMARK_INDEX(BMK_IDX_KEY, IDX_ID, IDX_NM, IDX_SHRT_NM, ROBECO_IDX_ID, BLOOMBERG_SYM, IDX_TYPE, IDX_TYPE_DESC, BMK_LEGACY_ID, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BMK_IDX_KEY",
          "IDX_ID",
          "IDX_NM",
          "IDX_SHRT_NM",
          "ROBECO_IDX_ID",
          "BLOOMBERG_SYM",
          "IDX_TYPE",
          "IDX_TYPE_DESC",
          "BMK_LEGACY_ID",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID"
     FROM Benchmark_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BLUESKY_TRANSACTIONS(BLUE_SKY_TXN_KEY, DAY_KEY, FUND_KEY, REG_KEY, SHR_QTY, TXN_AMT, MTD_REPT_AMT, MTD_RE_OPEN_AMT, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CURR_ROW_FLG) AS 
SELECT "BLUE_SKY_TXN_KEY","DAY_KEY","FUND_KEY","REG_KEY","SHR_QTY","TXN_AMT","MTD_REPT_AMT","MTD_RE_OPEN_AMT","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","CURR_ROW_FLG" FROM Bluesky_Transactions
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BROKER(BRKR_KEY, POSN_TYPE_KEY, BRKR_NM, ST_STR_NBR, COMPST_NM, BRKR_ACCT_NBR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BRKR_KEY","POSN_TYPE_KEY","BRKR_NM","ST_STR_NBR","COMPST_NM","BRKR_ACCT_NBR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Broker
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BROKER_POSITION(BRKR_POSN_KEY, BRKR_KEY, DAY_KEY, SER_NBR, SUB_ADVSR_FUND_ID, ASSET_ID, THRD_PARTY_ID, OTHR_ID, TRDE_ID, ASSET_DESC, PROD_NM, ASSET_QTY, TRDE_DT, STTL_DT, TXN_TYPE, PURCH_PR, VEND_PR, MKT_VAL, COUPN, MTRY_DT, TRDE_AMT, STTL_AMT, PLDG_AMT, UN_STTLD_AMT, CONTCT_NM, PHON_DET, FAX_DET, ADDR, EMAIL_ID, NOTES, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BRKR_POSN_KEY","BRKR_KEY","DAY_KEY","SER_NBR","SUB_ADVSR_FUND_ID","ASSET_ID","THRD_PARTY_ID","OTHR_ID","TRDE_ID","ASSET_DESC","PROD_NM","ASSET_QTY","TRDE_DT","STTL_DT","TXN_TYPE","PURCH_PR","VEND_PR","MKT_VAL","COUPN","MTRY_DT","TRDE_AMT","STTL_AMT","PLDG_AMT","UN_STTLD_AMT","CONTCT_NM","PHON_DET","FAX_DET","ADDR","EMAIL_ID","NOTES","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Broker_Position
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUDGET(BUD_KEY, BUD_ID, BUD_TYPE, END_DT, FISCL_YR, INIT_BUD_W, STRT_DT, BUD_DESC, BUD_SRC, FISCL_YE_FLG, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_KEY","BUD_ID","BUD_TYPE","END_DT","FISCL_YR","INIT_BUD_W","STRT_DT","BUD_DESC","BUD_SRC","FISCL_YE_FLG","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Budget
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCOUNT(BUD_ACCT_KEY, ACCT_ID, ACCT_DESC, ACCT_TYPE, ACTV_FLG, CAT_TYPE, EXPNS_CAT, PRPD_EXPNS_FLG, ACCT_SUBT, PAYEE, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_ACCT_KEY","ACCT_ID","ACCT_DESC","ACCT_TYPE","ACTV_FLG","CAT_TYPE","EXPNS_CAT","PRPD_EXPNS_FLG","ACCT_SUBT","PAYEE","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Account
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCT_ACCRUAL(ACCT_ACCRL_KEY, ACCRL_ID, ACCRL_SRC, FISCL_YR, ACCRL_STAT, NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ACCT_ACCRL_KEY","ACCRL_ID","ACCRL_SRC","FISCL_YR","ACCRL_STAT","NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_ACCT_Accrual
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCT_ACCRUAL_FND(ACCT_ACCURAL_FUND_KEY, ACCT_ACCRL_KEY, SRC_BUD_KEY, SRC_ASSMPN_CHG_KEY, EXPNS_LINE_ITEM_KEY, BUD_FUND_COMPST_KEY, CURR_ACCT_ACCRL_FUND_KEY, ACCRL_ID, DAILY_ACCRL, ORIG_BUD, RVSD_BUD, REMNG_TO_ACCRL, FYTD_EXPNS, EFFTV_DT, ACCRL_STRT_DT, ACCRL_BY_DT, SSB_EFFTV_DT, NBR_ACCRL_DAYS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ACCT_ACCURAL_FUND_KEY","ACCT_ACCRL_KEY","SRC_BUD_KEY","SRC_ASSMPN_CHG_KEY","EXPNS_LINE_ITEM_KEY","BUD_FUND_COMPST_KEY","CURR_ACCT_ACCRL_FUND_KEY","ACCRL_ID","DAILY_ACCRL","ORIG_BUD","RVSD_BUD","REMNG_TO_ACCRL","FYTD_EXPNS","EFFTV_DT","ACCRL_STRT_DT","ACCRL_BY_DT","SSB_EFFTV_DT","NBR_ACCRL_DAYS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_ACCT_Accrual_Fnd
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCT_ADJUST_FND(ACCT_ADJMT_KEY, BUD_FUND_COMPST_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, ASSMPN_CHG_KEY, EXPNS_ACCT_KEY, PAYBL_ACCT_KEY, DBT_ACCT_KEY, CR_ACCT_KEY, CAT_ACCRL_DIM_KEY, ADJMT_ID, FISCL_YR, ADJMT_AMT, ACT_STAT, NTES, EFFTV_DT, SSB_EFFTV_DT, ADJMT_TYPE, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ACCT_ADJMT_KEY","BUD_FUND_COMPST_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","ASSMPN_CHG_KEY","EXPNS_ACCT_KEY","PAYBL_ACCT_KEY","DBT_ACCT_KEY","CR_ACCT_KEY","CAT_ACCRL_DIM_KEY","ADJMT_ID","FISCL_YR","ADJMT_AMT","ACT_STAT","NTES","EFFTV_DT","SSB_EFFTV_DT","ADJMT_TYPE","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_ACCT_Adjust_FND
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCT_TRANSFER(ACCT_XFER_KEY, XFER_ID, XFER_GRP_NM, ENTRY_NM, EFFTV_DT, SSB_EFFTV_DT, INSR_USR, INSR_TS, EDITBL_FLG, XFER_STAT, NTES, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ACCT_XFER_KEY","XFER_ID","XFER_GRP_NM","ENTRY_NM","EFFTV_DT","SSB_EFFTV_DT","INSR_USR","INSR_TS","EDITBL_FLG","XFER_STAT","NTES","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_ACCT_Transfer
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ACCT_TRANSFER_FND(ACCT_XFER_FUND_KEY, ACCT_XFER_KEY, SRC_BUD_ACCT_KEY, DEST_BUD_ACCT_KEY, SRC_EXPNS_LINE_ITEM_KEY, DEST_EXPNS_LINE_ITEM_KEY, BUD_FUND_COMPST_KEY, DBT_ACCT_KEY, CR_ACCT_KEY, XFER_ID, XFER_VAL, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ACCT_XFER_FUND_KEY","ACCT_XFER_KEY","SRC_BUD_ACCT_KEY","DEST_BUD_ACCT_KEY","SRC_EXPNS_LINE_ITEM_KEY","DEST_EXPNS_LINE_ITEM_KEY","BUD_FUND_COMPST_KEY","DBT_ACCT_KEY","CR_ACCT_KEY","XFER_ID","XFER_VAL","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Acct_Transfer_Fnd
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ASMPT_CHANGE(ASSMPN_CHG_KEY, ADJMT_TYPE, CHG_AMT, EFFTV_DT, FISCL_YR, EDITBL_FLG, ASSMPN_CHG_NTES, ASSMPN_ID, LIAB_ADJ_BUD_ID, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ASSMPN_CHG_KEY","ADJMT_TYPE","CHG_AMT","EFFTV_DT","FISCL_YR","EDITBL_FLG","ASSMPN_CHG_NTES","ASSMPN_ID","LIAB_ADJ_BUD_ID","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Asmpt_Change
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_ASMPT_CHANGE_FUND(ASSMPN_CHG_FUND_KEY, BUD_FUND_COMPST_KEY, BUD_KEY, ASSMPN_CHG_KEY, EXPNS_LINE_ITEM_KEY, DATA_SRC_DIM_KEY, RT, ALLOCN, DATA_SRC_VAL, ASSMPN_CHG_PER_FUND_NTES, ADJMT, RSDL_VAL, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ASSMPN_CHG_FUND_KEY","BUD_FUND_COMPST_KEY","BUD_KEY","ASSMPN_CHG_KEY","EXPNS_LINE_ITEM_KEY","DATA_SRC_DIM_KEY","RT","ALLOCN","DATA_SRC_VAL","ASSMPN_CHG_PER_FUND_NTES","ADJMT","RSDL_VAL","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Asmpt_change_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_CAT_ACCRUAL_DIM(CAT_ACCRL_DIM_KEY, CAT_ACCRL_ID, NTES, ACCRL_TYPE, INSR_DT, INSR_USR, RNDEDUP_TO_1PENNY_FLG, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CAT_ACCRL_DIM_KEY","CAT_ACCRL_ID","NTES","ACCRL_TYPE","INSR_DT","INSR_USR","RNDEDUP_TO_1PENNY_FLG","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Cat_Accrual_Dim
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_CAT_ACCRUAL_FACT(CAT_ACCRL_FACT_KEY, BUD_FUND_COMPST_KEY, EXPNS_ACCT_KEY, PAYBL_ACCT_KEY, DBT_ACCT_KEY, CR_ACCT_KEY, CAT_ACCRL_DIM_KEY, CAT_ACCRL_ID, DAILY_ACCRL, ADJMT_VAL, FISCL_YR, ACCRL_STAT, EFFTV_DT, SSB_EFFTV_DT, EXPN_DT, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CAT_ACCRL_FACT_KEY","BUD_FUND_COMPST_KEY","EXPNS_ACCT_KEY","PAYBL_ACCT_KEY","DBT_ACCT_KEY","CR_ACCT_KEY","CAT_ACCRL_DIM_KEY","CAT_ACCRL_ID","DAILY_ACCRL","ADJMT_VAL","FISCL_YR","ACCRL_STAT","EFFTV_DT","SSB_EFFTV_DT","EXPN_DT","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Cat_Accrual_Fact
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_CAT_ACCT_ACCRUAL(CAT_ACCT_ACCRL_KEY, CAT_ACCRL_DIM_KEY, ACCT_ACCRL_KEY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CAT_ACCT_ACCRL_KEY","CAT_ACCRL_DIM_KEY","ACCT_ACCRL_KEY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_CAT_ACCT_Accrual
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_DATA_SOURCE_DIM(DATA_SRC_DIM_KEY, DATA_SRC_ID, FISCL_YR, SRC_TYPE, SHRT_NM, SRC_NM, TNA_DT, TNA_END_DT, TNA_STRT_DT, NBR_ACCTS_DT, REG24F2_DT, DATA_SRC_NTES, INVC_STRT_DT, INVC_END_DT, INVC_FISCL_YR, INVC_FEE_TYPE, REG24F2_STRT_DT, REG24F2_END_DT, CALC_MTHD, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DATA_SRC_DIM_KEY","DATA_SRC_ID","FISCL_YR","SRC_TYPE","SHRT_NM","SRC_NM","TNA_DT","TNA_END_DT","TNA_STRT_DT","NBR_ACCTS_DT","REG24F2_DT","DATA_SRC_NTES","INVC_STRT_DT","INVC_END_DT","INVC_FISCL_YR","INVC_FEE_TYPE","REG24F2_STRT_DT","REG24F2_END_DT","CALC_MTHD","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Data_Source_Dim
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_DATA_SOURCE_FACT(DATA_SRC_FACT_KEY, DATA_SRC_DIM_KEY, TRSTE_ELCTN_KEY, QTRLY_SAL, NEG_CARROVR_BAL_YR, NEG_CARROVR_BAL_AMT, FEE_PER_MIL, FEE_RQRD_MIN, RIC_PCT, TOT_FEE, TOT_ISSR_MKT_CAP, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DATA_SRC_FACT_KEY","DATA_SRC_DIM_KEY","TRSTE_ELCTN_KEY","QTRLY_SAL","NEG_CARROVR_BAL_YR","NEG_CARROVR_BAL_AMT","FEE_PER_MIL","FEE_RQRD_MIN","RIC_PCT","TOT_FEE","TOT_ISSR_MKT_CAP","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Data_Source_Fact
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_DATA_SOURCE_FUND(BUD_DATA_SRC_FUND_KEY, DATA_SRC_DIM_KEY, BUD_FUND_COMPST_KEY, AVG_MTHLY_TNA, ISSR_PCT, RT, REQS_FEE_FLG, SRC_VAL, TOT_FEE, OTPT_VAL, ADJMT, DATA_SRC_FUND_NTE, SBY_MULTR, HBR_NBR_ACCTS, BROADRIDGE_NBR_ACCTS, REINVS, BLLBL_ACT, CAPSTK_ADJMTS, TNA_VAL, RSDL_VAL, SUBS, REDMPNS, NET_SALES_ACT, ANNL_NET_SALES_ACT, SUBS_INCLUDING_ADJMTS, AVG_DAILY_TNA, ADJ_AVG_DAILY_TNA, ALLOCN_ADJMT, ORIG_ALLOCN, GREATEST_COMMN_DENOMR, TOT_AVG_DAILY_TNA, TOT_COMPNSN, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_DATA_SRC_FUND_KEY","DATA_SRC_DIM_KEY","BUD_FUND_COMPST_KEY","AVG_MTHLY_TNA","ISSR_PCT","RT","REQS_FEE_FLG","SRC_VAL","TOT_FEE","OTPT_VAL","ADJMT","DATA_SRC_FUND_NTE","SBY_MULTR","HBR_NBR_ACCTS","BROADRIDGE_NBR_ACCTS","REINVS","BLLBL_ACT","CAPSTK_ADJMTS","TNA_VAL","RSDL_VAL","SUBS","REDMPNS","NET_SALES_ACT","ANNL_NET_SALES_ACT","SUBS_INCLUDING_ADJMTS","AVG_DAILY_TNA","ADJ_AVG_DAILY_TNA","ALLOCN_ADJMT","ORIG_ALLOCN","GREATEST_COMMN_DENOMR","TOT_AVG_DAILY_TNA","TOT_COMPNSN","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Data_Source_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_EXPENSE_LINE_ITEM(EXPNS_LINE_ITEM_KEY, EXPNS_LINE_ITEM_NM, EXPNS_LINE_ITEM_ID, LINE_ITEM_NTES, ACTV_FLG, ALLOCN_TYPE, EXPNS_ITEM_NM, EXPNS_CAT_NM, INVC_VENDS, EXPNS_ACCT_ID, PAYBL_ACCT_ID, PRAPAID_EXPNS_FLG, HDDN_FLG, HDDN_RSN, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "EXPNS_LINE_ITEM_KEY","EXPNS_LINE_ITEM_NM","EXPNS_LINE_ITEM_ID","LINE_ITEM_NTES","ACTV_FLG","ALLOCN_TYPE","EXPNS_ITEM_NM","EXPNS_CAT_NM","INVC_VENDS","EXPNS_ACCT_ID","PAYBL_ACCT_ID","PRAPAID_EXPNS_FLG","HDDN_FLG","HDDN_RSN","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Expense_Line_Item
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_FUND_COMPOSITE(BUD_FUND_COMPST_KEY, ASSET_TYPE, ASSET_TYPE_DESC, FUND_NM, FUND_ORD, SSB_CD, SSB_SHRT_CD, PARN_COMPST_ID, FUND_COMPST_ID, INCPN_DT, CLOSD_DT, INSR_USR, INSR_TS, VRSN, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_FUND_COMPST_KEY","ASSET_TYPE","ASSET_TYPE_DESC","FUND_NM","FUND_ORD","SSB_CD","SSB_SHRT_CD","PARN_COMPST_ID","FUND_COMPST_ID","INCPN_DT","CLOSD_DT","INSR_USR","INSR_TS","VRSN","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Fund_Composite
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_FUND_MULTIPLIER(FUND_MULTR_KEY, BUD_FUND_COMPST_KEY, FISCL_YR, MULTR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_MULTR_KEY","BUD_FUND_COMPST_KEY","FISCL_YR","MULTR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Fund_Multiplier
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_INVOICE(BUD_INVC_KEY, INVC_ID, ALLOCN_ID, INVC_LINE_ID, FISCL_YR, INVC_ALLOCN_TYPE, INVC_NBR, INVC_VEND, SSB_EFFTV_DT, PEND_FLG, INVC_SRC, INVC_DESC, ACCTG_DT, DEL_FLG, BUDED_FLG, RPTB1099_FLG, ACCTG_PER, NTES, INSR_TS, INSR_USR, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_INVC_KEY","INVC_ID","ALLOCN_ID","INVC_LINE_ID","FISCL_YR","INVC_ALLOCN_TYPE","INVC_NBR","INVC_VEND","SSB_EFFTV_DT","PEND_FLG","INVC_SRC","INVC_DESC","ACCTG_DT","DEL_FLG","BUDED_FLG","RPTB1099_FLG","ACCTG_PER","NTES","INSR_TS","INSR_USR","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Invoice
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_INVOICE_ALLOC(BUD_INVC_ALLOC_KEY, BUD_INVC_KEY, DATA_SRC_DIM_KEY, EXPNS_LINE_ITEM_KEY, BUD_KEY, TAX_AMT, INVC_AMT, INVC_LINE_AMT, VRSN, ALLOCN_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_INVC_ALLOC_KEY","BUD_INVC_KEY","DATA_SRC_DIM_KEY","EXPNS_LINE_ITEM_KEY","BUD_KEY","TAX_AMT","INVC_AMT","INVC_LINE_AMT","VRSN","ALLOCN_AMT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Invoice_Alloc
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_INVOICE_ALLOC_FUND(BUD_INVC_ALLOC_FUND_KEY, BUD_INVC_KEY, DATA_SRC_DIM_KEY, BUD_FUND_COMPST_KEY, EXPNS_LINE_ITEM_KEY, FUND_ADJMT, FUND_RSDL_VAL, FUND_RT, TAX_RT, FUND_DATA_SRC_VAL, FUND_ALLOCN, FUND_TAX_ALLOCN, FUND_INVC_ALLOCN, NTES, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUD_INVC_ALLOC_FUND_KEY","BUD_INVC_KEY","DATA_SRC_DIM_KEY","BUD_FUND_COMPST_KEY","EXPNS_LINE_ITEM_KEY","FUND_ADJMT","FUND_RSDL_VAL","FUND_RT","TAX_RT","FUND_DATA_SRC_VAL","FUND_ALLOCN","FUND_TAX_ALLOCN","FUND_INVC_ALLOCN","NTES","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Invoice_Alloc_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_LIABILITY(LIAB_KEY, BUD_ID, LINE_ITEM_ID, PAYBL_ACCT_ID, DATA_SRC_ID, EDITBL_FLG, NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "LIAB_KEY","BUD_ID","LINE_ITEM_ID","PAYBL_ACCT_ID","DATA_SRC_ID","EDITBL_FLG","NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Liability
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_LIABILITY_FUND(LIAB_FUND_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, BUD_ACCT_KEY, DATA_SRC_DIM_KEY, BUD_FUND_COMPST_KEY, LIAB_KEY, PRIR_YR_PMT_DIFF_BUD_KEY, ALLOCN, DATA_SRC_VAL, FYTD_LIAB, FYTD_EXPNS, PRIR_YR_FYE_LIAB, PRIR_YR_PMT_DIFF, PEND_INVC_TOT, PRCSD_INVC_TOT, REMNG_TO_ACCRUE, FYE_LIAB, NEEDED_FYE_LIAB, SUGGESTED_LIAB_ADJMT, ACTL_LIAB_ADJMT, ONE_TM_ADJMTS, LINE_ITEM_BUD, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "LIAB_FUND_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","BUD_ACCT_KEY","DATA_SRC_DIM_KEY","BUD_FUND_COMPST_KEY","LIAB_KEY","PRIR_YR_PMT_DIFF_BUD_KEY","ALLOCN","DATA_SRC_VAL","FYTD_LIAB","FYTD_EXPNS","PRIR_YR_FYE_LIAB","PRIR_YR_PMT_DIFF","PEND_INVC_TOT","PRCSD_INVC_TOT","REMNG_TO_ACCRUE","FYE_LIAB","NEEDED_FYE_LIAB","SUGGESTED_LIAB_ADJMT","ACTL_LIAB_ADJMT","ONE_TM_ADJMTS","LINE_ITEM_BUD","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID"
        from bud_liability_fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_LINEITEM_ALLOC(LINEITEM_ALLOCN_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, DATA_SRC_DIM_KEY, ALLOCN_AMT, LINE_ITEM_TO_BE_REALLOCD, NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "LINEITEM_ALLOCN_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","DATA_SRC_DIM_KEY","ALLOCN_AMT","LINE_ITEM_TO_BE_REALLOCD","NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_LineItem_Alloc
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_LINEITEM_ALLOC_FUND(LINE_ITM_ALLC_FUND_KEY, BUD_STRT_DT_KEY, BUD_FUND_COMPST_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, DATA_SRC_DIM_KEY, RT, DATA_SRC_VAL, ALLOCN_AMT, ALLOCN_PER_FUND_NTES, ADJMT, RSDL_VAL, ORIG_ALLOCN, REALLOCD_REMNG, FYTD_EXPNS, ASSMPN_CHG, TO_BE_REALLOCD, SRC_BUD_KEY, PMT_DIFFTL, ALLOCN_NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "LINE_ITM_ALLC_FUND_KEY","BUD_STRT_DT_KEY","BUD_FUND_COMPST_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","DATA_SRC_DIM_KEY","RT","DATA_SRC_VAL","ALLOCN_AMT","ALLOCN_PER_FUND_NTES","ADJMT","RSDL_VAL","ORIG_ALLOCN","REALLOCD_REMNG","FYTD_EXPNS","ASSMPN_CHG","TO_BE_REALLOCD","SRC_BUD_KEY","PMT_DIFFTL","ALLOCN_NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_LineItem_Alloc_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_LINEITEM_ALLOC_FUND_DS(LINE_ITM_ALLC_FUND_KEY, BUD_STRT_DT_KEY, BUD_FUND_COMPST_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, DATA_SRC_DIM_KEY, RT, DATA_SRC_VAL, ALLOCN_AMT, ALLOCN_PER_FUND_NTES, ADJMT, RSDL_VAL, ORIG_ALLOCN, REALLOCD_REMNG, FYTD_EXPNS, ASSMPN_CHG, TO_BE_REALLOCD, SRC_BUD_KEY, PMT_DIFFTL, ALLOCN_NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, AVG_MTHLY_TNA_DS_FUND, ISSR_PCT_DS_FUND, RT_DS_FUND, REQS_FEE_FLG_DS_FUND, SRC_VAL_DS_FUND, TOT_FEE_DS_FUND, OTPT_VAL_DS_FUND, ADJMT_DS_FUND, DATA_SRC_FUND_NTE_DS_FUND, SBY_MULTR_DS_FUND, HBR_NBR_ACCTS_DS_FUND, BROADRIDGE_NBR_ACCTS_DS_FUND, REINVS_DS_FUND, BLLBL_ACT_DS_FUND, CAPSTK_ADJMTS_DS_FUND, TNA_VAL_DS_FUND, RSDL_VAL_DS_FUND, SUBS_DS_FUND, REDMPNS_DS_FUND, NET_SALES_ACT_DS_FUND, ANNL_NET_SALES_ACT_DS_FUND, SUBS_INCLUDING_ADJMTS_DS_FUND, AVG_DAILY_TNA_DS_FUND, ADJ_AVG_DAILY_TNA_DS_FUND, ALLOCN_ADJMT_DS_FUND, ORIG_ALLOCN_DS_FUND, GREATEST_COMMN_DENOMR_DS_FUND, TOT_AVG_DAILY_TNA_DS_FUND, TOT_COMPNSN_DS_FUND, VRSN_DS_FUND) AS 
SELECT laf."LINE_ITM_ALLC_FUND_KEY",
          laf."BUD_STRT_DT_KEY",
          laf."BUD_FUND_COMPST_KEY",
          laf."BUD_KEY",
          laf."EXPNS_LINE_ITEM_KEY",
          laf."DATA_SRC_DIM_KEY",
          laf."RT",
          laf."DATA_SRC_VAL",
          laf."ALLOCN_AMT",
          laf."ALLOCN_PER_FUND_NTES",
          laf."ADJMT",
          laf."RSDL_VAL",
          laf."ORIG_ALLOCN",
          laf."REALLOCD_REMNG",
          laf."FYTD_EXPNS",
          laf."ASSMPN_CHG",
          laf."TO_BE_REALLOCD",
          laf."SRC_BUD_KEY",
          laf."PMT_DIFFTL",
          laf."ALLOCN_NTES",
          laf."INSR_USR",
          laf."INSR_TS",
          laf."VRSN",
          laf."CURR_ROW_FLG",
          laf."ROW_STRT_DTTM",
          laf."ROW_STOP_DTTM",
          laf."ETL_LOAD_CYC_KEY",
          laf."SRC_SYS_ID",
          dsf.avg_mthly_tna avg_mthly_tna_DS_FUND,
          dsf.issr_pct issr_pct_DS_FUND,
          dsf.rt rt_DS_FUND,
          dsf.reqs_fee_flg reqs_fee_flg_DS_FUND,
          dsf.src_val src_val_DS_FUND,
          dsf.tot_fee tot_fee_DS_FUND,
          dsf.otpt_val otpt_val_DS_FUND,
          dsf.adjmt adjmt_DS_FUND,
          dsf.data_src_fund_nte data_src_fund_nte_DS_FUND,
          dsf.sby_multr sby_multr_DS_FUND,
          dsf.hbr_nbr_accts hbr_nbr_accts_DS_FUND,
          dsf.broadridge_nbr_accts broadridge_nbr_accts_DS_FUND,
          dsf.reinvs reinvs_DS_FUND,
          dsf.bllbl_act bllbl_act_DS_FUND,
          dsf.capstk_adjmts capstk_adjmts_DS_FUND,
          dsf.tna_val tna_val_DS_FUND,
          dsf.rsdl_val rsdl_val_DS_FUND,
          dsf.subs subs_DS_FUND,
          dsf.redmpns redmpns_DS_FUND,
          dsf.net_sales_act net_sales_act_DS_FUND,
          dsf.annl_net_sales_act annl_net_sales_act_DS_FUND,
          dsf.subs_including_adjmts subs_including_adjmts_DS_FUND,
          dsf.avg_daily_tna avg_daily_tna_DS_FUND,
         dsf.adj_avg_daily_tna adj_avg_daily_tna_DS_FUND,
          dsf.allocn_adjmt allocn_adjmt_DS_FUND,
          dsf.orig_allocn orig_allocn_DS_FUND,
          dsf.greatest_commn_denomr greatest_commn_denomr_DS_FUND,
          dsf.tot_avg_daily_tna tot_avg_daily_tna_DS_FUND,
          dsf.tot_compnsn tot_compnsn_DS_FUND,
          dsf.vrsn vrsn_DS_FUND
     FROM hdm.vw_bud_lineitem_alloc_fund laf, hdm.vw_bud_data_source_fund dsf
    WHERE laf.data_src_dim_key = dsf.data_src_dim_key(+)
          AND laf.bud_fund_compst_key = dsf.bud_fund_compst_key(+)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_PMT_DIFF(PMT_DIFF_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, FISCL_YR, INVC_EXPCTATION, PMT_DIFFTL, REMNG_LIAB, ADJMT_TYPE, RESHUFFLE_PMT_DIFF_FLG, EDITBL_FLG, PRIR_YR_FLG, NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMT_DIFF_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","FISCL_YR","INVC_EXPCTATION","PMT_DIFFTL","REMNG_LIAB","ADJMT_TYPE","RESHUFFLE_PMT_DIFF_FLG","EDITBL_FLG","PRIR_YR_FLG","NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_PMT_Diff
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_PMT_DIFF_FND_INVC(PMT_DIFF_FUND_INVC_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, BUD_FUND_COMPST_KEY, FUND_LVL_BUD_KEY, BUD_INVC_KEY, FISCL_YR, ALLOCN_VAL, STAT, PRIR_YR_FLG, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMT_DIFF_FUND_INVC_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","BUD_FUND_COMPST_KEY","FUND_LVL_BUD_KEY","BUD_INVC_KEY","FISCL_YR","ALLOCN_VAL","STAT","PRIR_YR_FLG","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_PMT_Diff_Fnd_Invc
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_PMT_DIFF_FUND(PMT_DIFF_FUND_KEY, BUD_KEY, EXPNS_LINE_ITEM_KEY, BUD_FUND_COMPST_KEY, FUND_LVL_BUD_KEY, FISCL_YR, ORIG_ALLOCN, TOT_INVCS_PAID, TOT_INVCS_PEND, ACCT_XFERS, PMT_DIFFTL, REMNG_LIAB, ASSMPN_CHG_ALLOCN, PRIR_YR_FLG, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMT_DIFF_FUND_KEY","BUD_KEY","EXPNS_LINE_ITEM_KEY","BUD_FUND_COMPST_KEY","FUND_LVL_BUD_KEY","FISCL_YR","ORIG_ALLOCN","TOT_INVCS_PAID","TOT_INVCS_PEND","ACCT_XFERS","PMT_DIFFTL","REMNG_LIAB","ASSMPN_CHG_ALLOCN","PRIR_YR_FLG","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_PMT_Diff_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUD_TRUSTEE_ELECTION(TRSTE_ELCTN_KEY, BUD_FUND_COMPST_KEY, TRSTE_ELCTN_ID, TRSTE_NM, FISCL_YR, DATA_SRC_VAL, NTES, INSR_USR, INSR_TS, VRSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRSTE_ELCTN_KEY","BUD_FUND_COMPST_KEY","TRSTE_ELCTN_ID","TRSTE_NM","FISCL_YR","DATA_SRC_VAL","NTES","INSR_USR","INSR_TS","VRSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Bud_Trustee_Election
/



CREATE OR REPLACE FORCE VIEW HDM.VW_BUSINESS_LINE(BUS_LINE_KEY, BUS_LINE, INVC_FEE_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BUS_LINE_KEY","BUS_LINE","INVC_FEE_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Business_Line
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CALENDAR(DAY_KEY, CAL_DAY, CAL_DAY_SHRT_NM, CAL_DAY_LONG_NM, BUS_DAY_FLG, MKT_HOL_FLG, WK_CD, WK_NBR, WK_SHRT_NM, WK_LONG_NM, WK_ENDING_DT, WK_DAYS_CNT, MO_CD, MO_NBR, MO_NM, MO_SHRT_NM, MO_LONG_NM, CAL_MO_END_FLG, BUS_MO_END_FLG, MO_ENDING_DT, MO_DAYS_CNT, QTR_CD, QTR_NBR, QTR_SHRT_NM, QTR_LONG_NM, CAL_QTR_END_FLG, BUS_QTR_END_FLG, QTR_ENDING_DT, QTR_DAYS_CNT, YR_CD, YR_NBR, YR_SHRT_NM, YR_LONG_NM, YR_ENDING_DT, YE_FLG, YR_LAST_BUS_DAY_FLG, YR_DAYS_CNT, FISCL_WK_CD, FISCL_WK_NBR, FISCL_WK_SHRT_NM, FISCL_WK_LONG_NM, FISCL_WK_ENDING_DT, FISCL_WK_DAYS_CNT, FISCL_MO_CD, FISCL_MO_NBR, FISCL_MO_SHRT_NM, FISCL_MO_LONG_NM, FISCL_MO_ENDING_DT, FISCL_MO_END_FLG, FISCL_MO_LAST_BUS_DAY_FLG, FISCL_MO_DAYS_CNT, FISCL_QTR_CD, FISCL_QTR_NBR, FISCL_QTR_SHRT_NM, FISCL_QTR_LONG_NM, FISCL_QTR_ENDING_FLG, FISCL_QTR_LAST_BUS_DAY_FLG, FISCL_QTR_ENDING_DT, FISCL_QTR_DAYS_CNT, FISCL_YR_CD, FISCL_YR_SHRT_NM, FISCL_YR_LONG_NM, FISCL_YR_ENDING_DT, FISCL_YR_ENDING_FLG, FISCL_YR_LAST_BUS_DAY_FLG, FISCL_YR_NBR, FISCL_YR_DAYS_CNT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "DAY_KEY","CAL_DAY","CAL_DAY_SHRT_NM","CAL_DAY_LONG_NM","BUS_DAY_FLG","MKT_HOL_FLG","WK_CD","WK_NBR","WK_SHRT_NM","WK_LONG_NM","WK_ENDING_DT","WK_DAYS_CNT","MO_CD","MO_NBR","MO_NM","MO_SHRT_NM","MO_LONG_NM","CAL_MO_END_FLG","BUS_MO_END_FLG","MO_ENDING_DT","MO_DAYS_CNT","QTR_CD","QTR_NBR","QTR_SHRT_NM","QTR_LONG_NM","CAL_QTR_END_FLG","BUS_QTR_END_FLG","QTR_ENDING_DT","QTR_DAYS_CNT","YR_CD","YR_NBR","YR_SHRT_NM","YR_LONG_NM","YR_ENDING_DT","YE_FLG","YR_LAST_BUS_DAY_FLG","YR_DAYS_CNT","FISCL_WK_CD","FISCL_WK_NBR","FISCL_WK_SHRT_NM","FISCL_WK_LONG_NM","FISCL_WK_ENDING_DT","FISCL_WK_DAYS_CNT","FISCL_MO_CD","FISCL_MO_NBR","FISCL_MO_SHRT_NM","FISCL_MO_LONG_NM","FISCL_MO_ENDING_DT","FISCL_MO_END_FLG","FISCL_MO_LAST_BUS_DAY_FLG","FISCL_MO_DAYS_CNT","FISCL_QTR_CD","FISCL_QTR_NBR","FISCL_QTR_SHRT_NM","FISCL_QTR_LONG_NM","FISCL_QTR_ENDING_FLG","FISCL_QTR_LAST_BUS_DAY_FLG","FISCL_QTR_ENDING_DT","FISCL_QTR_DAYS_CNT","FISCL_YR_CD","FISCL_YR_SHRT_NM","FISCL_YR_LONG_NM","FISCL_YR_ENDING_DT","FISCL_YR_ENDING_FLG","FISCL_YR_LAST_BUS_DAY_FLG","FISCL_YR_NBR","FISCL_YR_DAYS_CNT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from calendar
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CASHFLOW(CASHFLOW_KEY, REG_KEY, DLR_KEY, HBR_DLR_KEY, FUND_KEY, ACCT_KEY, PMT_MTHD_KEY, TRDE_DT_KEY, SPR_SHEET_DT_KEY, SHRHLDR_KEY, CONFIRM_DT_KEY, SHRHLDR_ROLE_KEY, ACCT_NBR, FUND_NBR, SUB_SHRS, SUB_AMT, REDMPN_SHRS, REDMPN_AMT, OFRG_PR, NAV, DLR_COMMSN_AMT, UNDR_WRTR_COMMSN_AMT, ADV_COMMSN_AMT, NET_CASHFLOW_AMT, NET_SHRS, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY, TRANS_STAT) AS 
SELECT cashflow_history.cashflow_hist_key,
          cashflow_history.reg_key,
          cashflow_history.dlr_key,
          cashflow_history.hbr_dlr_key,
          cashflow_history.fund_key,
          cashflow_history.acct_key,
          cashflow_history.pmt_mthd_key,
          cashflow_history.trde_dt_key,
          cashflow_history.trde_dt_key spr_sheet_dt_key,
          cashflow_history.shrhldr_key,
          cashflow_history.confirm_dt_key,
          cashflow_history.shrhldr_key shrhldr_role_key,
          cashflow_history.acct_nbr,
          fund.fund_nbr,
          cashflow_history.sub_shrs,
          cashflow_history.sub_amt,
          cashflow_history.redmpn_shrs,
          cashflow_history.redmpn_amt,
          cashflow_history.ofrg_pr,
          cashflow_history.nav,
          cashflow_history.dlr_commsn_amt,
          cashflow_history.undr_wrtr_commsn_amt,
          cashflow_history.adv_commsn_amt,
          cashflow_history.net_cashflow_amt,
          cashflow_history.net_shrs,
          cashflow_history.row_strt_dttm,
          cashflow_history.row_stop_dttm,
          cashflow_history.curr_row_flg,
          cashflow_history.src_sys_id,
          cashflow_history.etl_load_cyc_key,
          'Settled' TRANS_STAT
     FROM cashflow_history, fund
    WHERE cashflow_history.fund_key = fund.fund_key
   UNION ALL
   SELECT sdcm_cashflow_key,
          cash.reg_key,
          cash.dlr_key,
          cash.hbr_dlr_key,
          cash.fund_key,
          cash.acct_key,
          cash.pmt_mthd_key,
          cash.trde_dt_key,
          cash.spr_sheet_dt_key,
          cash.shrhldr_key,
          cash.confirm_dt_key,
          cash.shrhldr_role_key,
          cash.acct_nbr,
          fund.fund_nbr,
          cash.sub_shrs,
          cash.sub_amt,
          cash.redmpn_shrs,
          cash.redmpn_amt,
          cash.ofrg_pr,
          cash.nav,
          cash.dlr_commsn_amt,
          cash.undr_wrtr_commsn_amt,
          cash.adv_commsn_amt,
          cash.net_cashflow_amt,
          cash.net_shrs,
          cash.row_strt_dttm,
          cash.row_stop_dttm,
          cash.curr_row_flg,
          cash.src_sys_id,
          cash.etl_load_cyc_key,
          (CASE
              WHEN CASH_CNTL_RECON_flg = 'Y' THEN 'Settled'
              ELSE 'Pending'
           END)
             TRANS_STAT
     FROM hdm.sdcm_cashflow cash, fund
    WHERE cash.fund_key = fund.fund_key
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CASHFLOW_ACTIVITY(CASHFLOW_ACT_HIST_KEY, FUND_KEY, DAY_KEY, SUB_SHRS, SUB_AMT, REDMPN_SHRS, REDMPN_AMT, NET_SHRS, NET_CASHFLOW_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "CASHFLOW_ACT_HIST_KEY","FUND_KEY","DAY_KEY","SUB_SHRS","SUB_AMT","REDMPN_SHRS","REDMPN_AMT","NET_SHRS","NET_CASHFLOW_AMT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from cashflow_activity
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CASHFLOW_HISTORY(CASHFLOW_HIST_KEY, REG_KEY, DLR_KEY, SHRHLDR_KEY, ACCT_KEY, FUND_KEY, PMT_MTHD_KEY, TRDE_DT_KEY, CONFIRM_DT_KEY, ACCT_NBR, SUB_SHRS, SUB_AMT, REDMPN_SHRS, REDMPN_AMT, OFRG_PR, NAV, DLR_COMMSN_AMT, UNDR_WRTR_COMMSN_AMT, ADV_COMMSN_AMT, NET_SHRS, NET_CASHFLOW_AMT, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CURR_ROW_FLG) AS 
SELECT "CASHFLOW_HIST_KEY","REG_KEY","DLR_KEY","SHRHLDR_KEY","ACCT_KEY","FUND_KEY","PMT_MTHD_KEY","TRDE_DT_KEY","CONFIRM_DT_KEY","ACCT_NBR","SUB_SHRS","SUB_AMT","REDMPN_SHRS","REDMPN_AMT","OFRG_PR","NAV","DLR_COMMSN_AMT","UNDR_WRTR_COMMSN_AMT","ADV_COMMSN_AMT","NET_SHRS","NET_CASHFLOW_AMT","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","CURR_ROW_FLG" FROM Cashflow_History
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CASH_HOLDING(CASH_HOLDG_KEY, FUND_COMPST_KEY, DAY_KEY, CASH, SHRT_TERM_INVMT, RECBL, PAYBL, NET_SHRS, NET_ASSET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CASH_COLTRL) AS 
select "CASH_HOLDG_KEY","FUND_COMPST_KEY","DAY_KEY","CASH","SHRT_TERM_INVMT","RECBL","PAYBL","NET_SHRS","NET_ASSET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","CASH_COLTRL" from cash_holding
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CASH_REASON(CASH_RSN__KEY, CASH_RSN_CD, CASH_RSN_DESC) AS 
SELECT "CASH_RSN__KEY","CASH_RSN_CD","CASH_RSN_DESC" FROM Cash_Reason
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_CITY_TAX_LIST(CITY_TAX_LIST_KEY, CITY_TAX_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CITY_TAX_LIST_KEY",
           "CITY_TAX_DESC",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_City_Tax_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_HARBOR_GROUP(HBR_GRP_KEY, CO_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "HBR_GRP_KEY",
           "CO_NM",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_Harbor_Group
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_SPEND_CATEGORY(SPEND_CAT_KEY, SPEND_CAT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SPEND_CAT_KEY",
           "SPEND_CAT",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_Spend_Category
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_SUPPLIER(SUPPL_KEY, SUPPL_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SUPPL_KEY",
           "SUPPL_NM",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_Supplier
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_TAX_DETAIL(TAX_DET_KEY, TAX_SUM_KEY, CITY_TAX_LIST_KEY, CITY_TAX_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TAX_DET_KEY",
           "TAX_SUM_KEY",
           "CITY_TAX_LIST_KEY",
           "CITY_TAX_AMT",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_Tax_Detail
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CCT_TAX_SUMMARY(TAX_SUM_KEY, HBR_GRP_KEY, SPEND_CAT_KEY, SUPPL_KEY, DAY_KEY, KEY_REF, LINE_MEMO, SUPPL_REF_NBR, INVC_LINE_DESC, TAX_ANLYS_CONCLSN, INVC_AMT, TOT_TAX_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TAX_SUM_KEY",
           "HBR_GRP_KEY",
           "SPEND_CAT_KEY",
           "SUPPL_KEY",
           "DAY_KEY",
           "KEY_REF",
           "LINE_MEMO",
           "SUPPL_REF_NBR",
           "INVC_LINE_DESC",
           "TAX_ANLYS_CONCLSN",
           "INVC_AMT",
           "TOT_TAX_AMT",
           "CURR_ROW_FLG",
           "ROW_STRT_DTTM",
           "ROW_STOP_DTTM",
           "ETL_LOAD_CYC_KEY",
           "SRC_SYS_ID"
      FROM CCT_Tax_Summary
/



CREATE OR REPLACE FORCE VIEW HDM.VW_COST_TYPE(COST_TYPE_KEY, COST_TYPE_ID, COST_TYPE_DESC) AS 
SELECT "COST_TYPE_KEY","COST_TYPE_ID","COST_TYPE_DESC" FROM Cost_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_COUNTRY(CRTY_KEY, CRTY_NM, CRTY_REG, CRTY_CD, CRTY_FACTSET_REG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CRTY_KEY","CRTY_NM","CRTY_REG","CRTY_CD","CRTY_FACTSET_REG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Country
/



CREATE OR REPLACE FORCE VIEW HDM.VW_COUNTRY_THRESHOLD(CRTY_THRS_KEY, CRTY_KEY, THRS_DESC, INTRL_TRIG, OFCL_TRIG, THRS_DAYS, REGLTY_FILNG_DAYS, FILNG_DAYS, INTRL_TRIG_DISPL, OFCL_TRIG_DISPL, THRS_DAYS_DISPL, REGLTY_FILNG_DISPL_DAYS, FILNG_DISPL_DAYS, THRESHOLD_TYPE, CUSTOM_IND, THRSHLD_MLSTN, THRSHLD_MLSTN_DISPL, PERIODIC_TRSHLD, PERIODIC_THRSLD_DISP, ANY_AMT_IND, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT CRTY_THRS_KEY,
          CRTY_KEY,
          THRS_DESC,
          INTRL_TRIG,
          OFCL_TRIG,
          THRS_DAYS,
          REGLTY_FILNG_DAYS,
          FILNG_DAYS,
          INTRL_TRIG_DISPL,
          OFCL_TRIG_DISPL,
          THRS_DAYS_DISPL,
          REGLTY_FILNG_DISPL_DAYS,
          FILNG_DISPL_DAYS,
          THRESHOLD_TYPE,
          CUSTOM_IND,
          THRSHLD_MLSTN,
          THRSHLD_MLSTN_DISPL,
          PERIODIC_TRSHLD,
          PERIODIC_THRSLD_DISP,
          ANY_AMT_IND,
          CURR_ROW_FLG,
          ROW_STRT_DTTM,
          ROW_STOP_DTTM,
          ETL_LOAD_CYC_KEY,
          SRC_SYS_ID
     FROM hdm.country_threshold
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CUBE_ACCT_STAT(FUND_KEY, DAY_KEY, ACCT_YR_KEY, GEND_KEY, ACCT_CAT_KEY, BAL_CAT_KEY, SUM_BAL, SUM_SHR, CNT_BAL, CNT_TAXID) AS 
select
   FUND_KEY,
   DAY_KEY,
   ACCT_setup_YR_KEY acct_yr_key,
   GEND_KEY,
   ACCT_CAT_KEY,
   BAL_CAT_KEY,
   acct_bal_amt SUM_BAL,
   tot_shrs SUM_SHR,
   acct_cnt CNT_BAL,
   shrhldr_cnt CNT_TAXID
   from HDM.ACCOUNT_STATISTICS
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CUBE_ACCT_STAT_ORIG(FUND_KEY, DAY_KEY, ACCT_YR_KEY, GEND_KEY, ACCT_CAT_KEY, BAL_CAT_KEY, SUM_BAL, SUM_SHR, CNT_BAL, CNT_TAXID) AS 
SELECT l.fund_key,
            k.day_key,
            m.acct_setup_yr_key,
            NVL (n.gend_key, 4) gend_key,
            CAST (
               (CASE
                   WHEN d.soc_cd IN (6, 201, 729)
                        OR (d.soc_cd = 24 AND cnt_shrhldr = 1)
                   THEN
                      1
                   WHEN d.soc_cd IN (70) AND c.custodian_id = 0
                   THEN
                      2
                   WHEN d.soc_cd IN (701, 702, 710, 798)
                   THEN
                      3
                   WHEN d.soc_cd IN (15)
                        OR (d.soc_cd = 24 AND cnt_shrhldr > 1)
                   THEN
                      4
                   WHEN d.soc_cd IN (20)
                   THEN
                      5
                   ELSE
                      99
                END) AS NUMBER (10))
               acct_cat_key,
            CAST (
               (CASE
                   WHEN A.TOT_shrs * A.NAV > 1000000000
                   THEN
                      1
                   WHEN A.TOT_shrs * A.NAV BETWEEN 750000000 AND 1000000000
                   THEN
                      2
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000000 AND 750000000
                   THEN
                      3
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000000 AND 500000000
                   THEN
                      4
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000000 AND 250000000
                   THEN
                      5
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000000 AND 100000000
                   THEN
                      6
                   WHEN A.TOT_shrs * A.NAV BETWEEN 25000000 AND 50000000
                   THEN
                      7
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000000 AND 25000000
                   THEN
                      8
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000000 AND 10000000
                   THEN
                      9
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000 AND 1000000
                   THEN
                      10
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000 AND 500000
                   THEN
                      11
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000 AND 250000
                   THEN
                      12
                   WHEN A.TOT_shrs * A.NAV BETWEEN 75000 AND 100000
                   THEN
                      13
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000 AND 75000
                   THEN
                      14
                   WHEN A.TOT_shrs * A.NAV BETWEEN 40000 AND 50000
                   THEN
                      15
                   WHEN A.TOT_shrs * A.NAV BETWEEN 30000 AND 40000
                   THEN
                      16
                   WHEN A.TOT_shrs * A.NAV BETWEEN 20000 AND 30000
                   THEN
                      17
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000 AND 20000
                   THEN
                      18
                   WHEN A.TOT_shrs * A.NAV BETWEEN 5000 AND 10000
                   THEN
                      19
                   WHEN A.TOT_shrs * A.NAV BETWEEN 2500 AND 5000
                   THEN
                      20
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000 AND 2500
                   THEN
                      21
                   WHEN A.TOT_shrs * A.NAV < 1000
                   THEN
                      22
                END) AS NUMBER (10))
               bal_cat_key,
            SUM (A.TOT_shrs * A.NAV) acct_bal_amt,
            SUM (a.tot_shrs) tot_shrs,
            COUNT (A.ACCT_FUND_POSN_KEY) acct_cnt,
            COUNT (DISTINCT c.tax_id) shrhldr_cnt
       FROM ADW.ACCOUNT_FUND_POSITION  a,
            adw.account_fund b,
            adw.customer_account c,
            ADW.social_code d,
            ADW.DEALER_LEVEL_CONTROLS g,
            (  SELECT CUST_ACCT_KEY,
                      COUNT (DISTINCT SHRHLDR_ROLE_KEY) cnt_SHRHLDR
                 FROM adw.account_shareholder
                WHERE curr_row_flg = 'Y'
             GROUP BY cust_acct_key) f,
            ADW.CUST_ACCT_STATUS_TYPE h,
            adw.share_class_fund j,
            HDM.CALENDAR k,
            HDM.fund l,
            HDM.ACCOUNT_SETUP_YEAR m,
            (SELECT A.CUST_ACCT_KEY,
                    a.tax_id,
                    b.tax_id_nbr,
                    a.acct_nbr,
                    b.full_lgl_nm,
                    mrtl_stat_cd,
                    brth_dt,
                    F.GEND_nm,
                    f.gend_cd,
                    g.gend_key
               FROM adw.customer_account a,
                    adw.person b,
                    ADW.ACCOUNT_SHAREHOLDER c,
                    ADW.PARTY_ROLE d,
                    ADW.GENDER f,
                    HDM.Gender g
              WHERE     A.CUST_ACCT_KEY = c.cust_acct_key
                    AND C.SHRHLDR_ROLE_KEY = D.PARTY_ROLE_KEY
                    AND D.PARTY_KEY = B.PERS_KEY
                    AND b.gend_key = f.gend_key
                    AND f.gend_cd = g.gend_cd
                    AND a.curr_row_flg = 'Y'
                    AND b.curr_row_flg = 'Y'
                    AND c.curr_row_flg = 'Y'
                    AND d.curr_row_flg = 'Y'
                    AND C.TXBL_PARTY = 'Y'
                    AND c.cust_role = 'TAX') n
      WHERE     A.ACCT_FUND_KEY = b.acct_fund_key
            AND B.CUST_ACCT_KEY = c.cust_acct_key
            AND C.soc_cd_KEY = D.soc_cd_KEY
            AND c.cust_acct_key = f.cust_acct_key(+)
            AND C.DLR_LVL_CNTL_KEY = G.DLR_LVL_CNTL_KEY
            AND b.CUST_ACCT_STAT_KEY = h.CUST_ACCT_STAT_KEY
            AND B.SHR_CLS_FUND_KEY = j.shr_cls_fund_key
            AND A.ACCT_BAL_DT = k.cal_day
            AND j.fund_nbr = l.fund_nbr
            AND b.cust_acct_key = n.cust_acct_key(+)
            AND TO_CHAR (b.acct_setup_dt, 'YYYY') = m.acct_setup_yr
            AND a.curr_row_flg = 'Y'
            AND b.curr_row_flg = 'Y'
            AND c.curr_row_flg = 'Y'
            AND d.curr_row_flg = 'Y'
            AND j.curr_row_flg = 'Y'
            AND A.ACCT_BAL_DT =
                   (SELECT MAX (cal_day)
                      FROM hdm.calendar
                     WHERE cal_day < TRUNC (SYSDATE) AND bus_day_flg = 'Y')
            AND (D.soc_CD IN
                    (6,
                     15,
                     20,
                     23,
                     24,
                     30,
                     39,
                     40,
                     41,
                     59,
                     63,
                     64,
                     68,
                     701,
                     702,
                     710,
                     798,
                     42,
                     43,
                     46,
                     47,
                     48,
                     50,
                     52,
                     56,
                     60,
                     61,
                     9,
                     62,
                     65,
                     67,
                     76,
                     97,
                     99,
                     201,
                     729)
                 OR (d.soc_cd = 70 AND c.custodian_id = 0))
            AND G.DLR_LVL_CNTL_CD = 0
            AND h.cust_acct_stat_cd = 0
   GROUP BY l.fund_key,
            k.day_key,
            m.acct_setup_yr_key,
            n.gend_key,
            CAST (
               (CASE
                   WHEN d.soc_cd IN (6, 201, 729)
                        OR (d.soc_cd = 24 AND cnt_shrhldr = 1)
                   THEN
                      1
                   WHEN d.soc_cd IN (70) AND c.custodian_id = 0
                   THEN
                      2
                   WHEN d.soc_cd IN (701, 702, 710, 798)
                   THEN
                      3
                   WHEN d.soc_cd IN (15)
                        OR (d.soc_cd = 24 AND cnt_shrhldr > 1)
                   THEN
                      4
                   WHEN d.soc_cd IN (20)
                   THEN
                      5
                   ELSE
                      99
                END) AS NUMBER (10)),
            CAST (
               (CASE
                   WHEN A.TOT_shrs * A.NAV > 1000000000
                   THEN
                      1
                   WHEN A.TOT_shrs * A.NAV BETWEEN 750000000 AND 1000000000
                   THEN
                      2
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000000 AND 750000000
                   THEN
                      3
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000000 AND 500000000
                   THEN
                      4
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000000 AND 250000000
                   THEN
                      5
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000000 AND 100000000
                   THEN
                      6
                   WHEN A.TOT_shrs * A.NAV BETWEEN 25000000 AND 50000000
                   THEN
                      7
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000000 AND 25000000
                   THEN
                      8
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000000 AND 10000000
                   THEN
                      9
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000 AND 1000000
                   THEN
                      10
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000 AND 500000
                   THEN
                      11
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000 AND 250000
                   THEN
                      12
                   WHEN A.TOT_shrs * A.NAV BETWEEN 75000 AND 100000
                   THEN
                      13
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000 AND 75000
                   THEN
                      14
                   WHEN A.TOT_shrs * A.NAV BETWEEN 40000 AND 50000
                   THEN
                      15
                   WHEN A.TOT_shrs * A.NAV BETWEEN 30000 AND 40000
                   THEN
                      16
                   WHEN A.TOT_shrs * A.NAV BETWEEN 20000 AND 30000
                   THEN
                      17
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000 AND 20000
                   THEN
                      18
                   WHEN A.TOT_shrs * A.NAV BETWEEN 5000 AND 10000
                   THEN
                      19
                   WHEN A.TOT_shrs * A.NAV BETWEEN 2500 AND 5000
                   THEN
                      20
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000 AND 2500
                   THEN
                      21
                   WHEN A.TOT_shrs * A.NAV < 1000
                   THEN
                      22
                END) AS NUMBER (10))
   UNION ALL
     SELECT l.fund_key,
            k.day_key,
            m.acct_setup_yr_key,
            4 Gend_key,
            CAST (
               (CASE
                   WHEN d.soc_cd IN (70) AND c.custodian_id = 0 THEN 7
                   ELSE 6
                END) AS NUMBER (10))
               acct_cat_key,
            CAST (
               (CASE
                   WHEN A.TOT_shrs * A.NAV > 1000000000
                   THEN
                      1
                   WHEN A.TOT_shrs * A.NAV BETWEEN 750000000 AND 1000000000
                   THEN
                      2
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000000 AND 750000000
                   THEN
                      3
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000000 AND 500000000
                   THEN
                      4
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000000 AND 250000000
                   THEN
                      5
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000000 AND 100000000
                   THEN
                      6
                   WHEN A.TOT_shrs * A.NAV BETWEEN 25000000 AND 50000000
                   THEN
                      7
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000000 AND 25000000
                   THEN
                      8
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000000 AND 10000000
                   THEN
                      9
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000 AND 1000000
                   THEN
                      10
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000 AND 500000
                   THEN
                      11
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000 AND 250000
                   THEN
                      12
                   WHEN A.TOT_shrs * A.NAV BETWEEN 75000 AND 100000
                   THEN
                      13
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000 AND 75000
                   THEN
                      14
                   WHEN A.TOT_shrs * A.NAV BETWEEN 40000 AND 50000
                   THEN
                      15
                   WHEN A.TOT_shrs * A.NAV BETWEEN 30000 AND 40000
                   THEN
                      16
                   WHEN A.TOT_shrs * A.NAV BETWEEN 20000 AND 30000
                   THEN
                      17
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000 AND 20000
                   THEN
                      18
                   WHEN A.TOT_shrs * A.NAV BETWEEN 5000 AND 10000
                   THEN
                      19
                   WHEN A.TOT_shrs * A.NAV BETWEEN 2500 AND 5000
                   THEN
                      20
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000 AND 2500
                   THEN
                      21
                   WHEN A.TOT_shrs * A.NAV < 1000
                   THEN
                      22
                END) AS NUMBER (10))
               bal_cat_key,
            SUM (A.TOT_shrs * A.NAV) sum_bal,
            SUM (a.tot_shrs) tot_shrs,
            COUNT (A.ACCT_FUND_POSN_KEY) acct_cnt,
            COUNT (DISTINCT c.tax_id) shrhldr_cnt
       FROM ADW.ACCOUNT_FUND_POSITION  a,
            adw.account_fund b,
            adw.customer_account c,
            ADW.social_code d,
            ADW.DEALER_LEVEL_CONTROLS g,
            (  SELECT CUST_ACCT_KEY,
                      COUNT (DISTINCT SHRHLDR_ROLE_KEY) cnt_SHRHLDR
                 FROM adw.account_shareholder
                WHERE curr_row_flg = 'Y'
             GROUP BY cust_acct_key) f,
            ADW.CUST_ACCT_STATUS_TYPE h,
            adw.share_class_fund j,
            HDM.CALENDAR k,
            HDM.fund l,
            HDM.ACCOUNT_SETUP_YEAR m
      WHERE     A.ACCT_FUND_KEY = b.acct_fund_key
            AND B.CUST_ACCT_KEY = c.cust_acct_key
            AND C.soc_cd_KEY = D.soc_cd_KEY
            AND c.cust_acct_key = f.cust_acct_key(+)
            AND C.DLR_LVL_CNTL_KEY = G.DLR_LVL_CNTL_KEY
            AND b.CUST_ACCT_STAT_KEY = h.CUST_ACCT_STAT_KEY
            AND B.SHR_CLS_FUND_KEY = j.shr_cls_fund_key
            AND A.ACCT_BAL_DT = k.cal_day
            AND j.fund_nbr = l.fund_nbr
            AND TO_CHAR (b.acct_setup_dt, 'YYYY') = m.acct_setup_yr
            AND a.curr_row_flg = 'Y'
            AND b.curr_row_flg = 'Y'
            AND c.curr_row_flg = 'Y'
            AND d.curr_row_flg = 'Y'
            AND j.curr_row_flg = 'Y'
            AND A.ACCT_BAL_DT =
                   (SELECT MAX (cal_day)
                      FROM hdm.calendar
                     WHERE cal_day < TRUNC (SYSDATE) AND bus_day_flg = 'Y')
            AND (G.DLR_LVL_CNTL_CD = 3
                 OR (    G.DLR_LVL_CNTL_CD = 0
                     AND C.custodian_id <> 0
                     AND d.soc_cd = 70)
                 OR (G.DLR_LVL_CNTL_CD = 0 AND d.soc_cd > 900))
            AND h.cust_acct_stat_cd = 0
   GROUP BY l.fund_key,
            k.day_key,
            m.acct_setup_yr_key,
            4,
            CAST (
               (CASE
                   WHEN d.soc_cd IN (70) AND c.custodian_id = 0 THEN 7
                   ELSE 6
                END) AS NUMBER (10)),
            CAST (
               (CASE
                   WHEN A.TOT_shrs * A.NAV > 1000000000
                   THEN
                      1
                   WHEN A.TOT_shrs * A.NAV BETWEEN 750000000 AND 1000000000
                   THEN
                      2
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000000 AND 750000000
                   THEN
                      3
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000000 AND 500000000
                   THEN
                      4
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000000 AND 250000000
                   THEN
                      5
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000000 AND 100000000
                   THEN
                      6
                   WHEN A.TOT_shrs * A.NAV BETWEEN 25000000 AND 50000000
                   THEN
                      7
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000000 AND 25000000
                   THEN
                      8
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000000 AND 10000000
                   THEN
                      9
                   WHEN A.TOT_shrs * A.NAV BETWEEN 500000 AND 1000000
                   THEN
                      10
                   WHEN A.TOT_shrs * A.NAV BETWEEN 250000 AND 500000
                   THEN
                      11
                   WHEN A.TOT_shrs * A.NAV BETWEEN 100000 AND 250000
                   THEN
                      12
                   WHEN A.TOT_shrs * A.NAV BETWEEN 75000 AND 100000
                   THEN
                      13
                   WHEN A.TOT_shrs * A.NAV BETWEEN 50000 AND 75000
                   THEN
                      14
                   WHEN A.TOT_shrs * A.NAV BETWEEN 40000 AND 50000
                   THEN
                      15
                   WHEN A.TOT_shrs * A.NAV BETWEEN 30000 AND 40000
                   THEN
                      16
                   WHEN A.TOT_shrs * A.NAV BETWEEN 20000 AND 30000
                   THEN
                      17
                   WHEN A.TOT_shrs * A.NAV BETWEEN 10000 AND 20000
                   THEN
                      18
                   WHEN A.TOT_shrs * A.NAV BETWEEN 5000 AND 10000
                   THEN
                      19
                   WHEN A.TOT_shrs * A.NAV BETWEEN 2500 AND 5000
                   THEN
                      20
                   WHEN A.TOT_shrs * A.NAV BETWEEN 1000 AND 2500
                   THEN
                      21
                   WHEN A.TOT_shrs * A.NAV < 1000
                   THEN
                      22
                END) AS NUMBER (10))
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CURRENCY(CURRCY_KEY, CURRCY_CD, CURRCY_NM, CURRCY_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CURRCY_KEY","CURRCY_CD","CURRCY_NM","CURRCY_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Currency
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CURRENT_ACCOUNT(ACCT_KEY, ACCT_TOP_LVL_CD, ACCT_TOP_LVL_DESC, ACCT_TYPE_CD, ACCT_TYPE, ACCT_NBR, FUND_NBR, TAX_ID, ACCT_STAT_CD, ACCT_STAT, ACCT_STRT_DT, LAST_MNTN_DT, DLR_LVL_CNTL_CD, DLR_LVL_CNTL_DESC, PRE_AUTHZD_CHK_ACCT_FLG, SWP_ACCT_FLG, ACH_ACCT_FLG, RE_INVST_TO_ANOTHER_ACCT_FLG, MONITORED_VIP_ACCT, FIDUCIARY_ACCT_FLG, MAILG_FLG, INTR_PARTY_FLG, MGMT_CO_EMPL_FLG, TRST_CO_NBR, TPA_NBR, CUSTODIAN_ID, TPA_ID, EXT_PLN_ID, TIN_CD, TIN_DESC, ALPHA_CD, CAP_GAINS_DSTRBTN_FLG, CHK_WRITING_ACCT_FLG, DIVD_DSTRBTN_OPT_FLG, EXPEDITED_REDMPN_ACCT_FLG, SUB_ACCT_FLG, FORGN_TAX_RT, CUM_DISCNT_NBR, LTR_OF_INTEND_NBR, TIMER_FLG, GPURCH_ACCT_FLG, EXPDT_XCHG_ACCT_FLG, PNLTY_WHG_ACCT_FLG, CERTFC_ISSUANCE_FLG, STOP_XFER_FLG, BLUESKY_XMPTN_FLG, BNK_CARD_ISSD_FLG, NAV_ACCT_FLG, PHON_CHK_REDMPN_FLG, HOUSE_ACCT_FLG, DIVD_MAIL_ACCT_FLG, STOP_PURCH_ACCT_FLG, STOP_MAIL_ACCT_FLG, FRACTIONAL_CHK_FLG, ACCT_PR_SCHED_FLG, CAP_GAINS_DSTRBTN_CD, CAP_GAINS_DSTRBTN_TYPE, DIVD_DSTRBTN_TYPE_CD, DIVD_DSTRBTN_TYPE, CUST_BIN, ACCT_ORIGINATION_ID, REGSTN_LINE_1, REGSTN_LINE_2, REGSTN_LINE_3, REGSTN_LINE_4, REGSTN_LINE_5, REGSTN_LINE_6, REGSTN_LINE_7, ST_NM, CRTY_NM, ST_CD, CRTY_CD, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, LEGACY_TYPE_DESC, FUND_STRT_DT, STOP_MAIL_DT, ACCT_SETUP_DT, INTERNET_ACCT_FLG, GRND_FATHER_ACCT_FLG, PLN_CLSFCN_FLG, MKTG_CLSFCN_FLG, MKTG_CLSFCN_DESC, REP_CD, REP_NM, DLR_ID, DLR_TYPE, HBR_DLR_ID, HBR_DLR_NM, TRST_NM, ACCT_CLSD_DT, REDMPN_FEE_XMPT_FLG) AS 
select "ACCT_KEY","ACCT_TOP_LVL_CD","ACCT_TOP_LVL_DESC","ACCT_TYPE_CD","ACCT_TYPE","ACCT_NBR","FUND_NBR","TAX_ID","ACCT_STAT_CD","ACCT_STAT","ACCT_STRT_DT","LAST_MNTN_DT","DLR_LVL_CNTL_CD","DLR_LVL_CNTL_DESC","PRE_AUTHZD_CHK_ACCT_FLG","SWP_ACCT_FLG","ACH_ACCT_FLG","RE_INVST_TO_ANOTHER_ACCT_FLG","MONITORED_VIP_ACCT","FIDUCIARY_ACCT_FLG","MAILG_FLG","INTR_PARTY_FLG","MGMT_CO_EMPL_FLG","TRST_CO_NBR","TPA_NBR","CUSTODIAN_ID","TPA_ID","EXT_PLN_ID","TIN_CD","TIN_DESC","ALPHA_CD","CAP_GAINS_DSTRBTN_FLG","CHK_WRITING_ACCT_FLG","DIVD_DSTRBTN_OPT_FLG","EXPEDITED_REDMPN_ACCT_FLG","SUB_ACCT_FLG","FORGN_TAX_RT","CUM_DISCNT_NBR","LTR_OF_INTEND_NBR","TIMER_FLG","GPURCH_ACCT_FLG","EXPDT_XCHG_ACCT_FLG","PNLTY_WHG_ACCT_FLG","CERTFC_ISSUANCE_FLG","STOP_XFER_FLG","BLUESKY_XMPTN_FLG","BNK_CARD_ISSD_FLG","NAV_ACCT_FLG","PHON_CHK_REDMPN_FLG","HOUSE_ACCT_FLG","DIVD_MAIL_ACCT_FLG","STOP_PURCH_ACCT_FLG","STOP_MAIL_ACCT_FLG","FRACTIONAL_CHK_FLG","ACCT_PR_SCHED_FLG","CAP_GAINS_DSTRBTN_CD","CAP_GAINS_DSTRBTN_TYPE","DIVD_DSTRBTN_TYPE_CD","DIVD_DSTRBTN_TYPE","CUST_BIN","ACCT_ORIGINATION_ID","REGSTN_LINE_1","REGSTN_LINE_2","REGSTN_LINE_3","REGSTN_LINE_4","REGSTN_LINE_5","REGSTN_LINE_6","REGSTN_LINE_7","ST_NM","CRTY_NM","ST_CD","CRTY_CD","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","LEGACY_TYPE_DESC","FUND_STRT_DT","STOP_MAIL_DT","ACCT_SETUP_DT","INTERNET_ACCT_FLG","GRND_FATHER_ACCT_FLG","PLN_CLSFCN_FLG","MKTG_CLSFCN_FLG","MKTG_CLSFCN_DESC","REP_CD","REP_NM","DLR_ID","DLR_TYPE","HBR_DLR_ID","HBR_DLR_NM","TRST_NM","ACCT_CLSD_DT","REDMPN_FEE_XMPT_FLG" from hdm.account where curr_row_flg='Y'
/



CREATE OR REPLACE FORCE VIEW HDM.VW_CURRENT_SHRHLDR(SHRHLDR_KEY, SHRHLDR_ROLE_KEY, SHRHLDR_TOP_LVL_CD, SHRHLDR_TOP_LVL_DESC, SHRHLDR_NM, TAX_IDNFCN_NBR, SSN_STAT_DESC, TAX_IDNFCN_TYPE, CUST_LGL_OWNR_REGSTN_DT, CUST_IDNFCN_NBR, CUST_IDNFCN_NBR_2, VIP_CUST_FLG, SEND_MKTG_INFO_FLG, INFORMED_CNSNT_FLG, PARTY_TYPE, CUST_EMPL_FLG, MGMT_CO_EMPL_FLG, LGL_STAT, GEND, BRTH_DT, DCSD_DT, EMPLMT_STAT, MRTL_STAT, CRTY_OF_CITZN_SHIP, ADDR_TYPE, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, ADDR_LINE_4, CITY, ST, PROV, CRTY, REG, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, PURG_PRCSD_FLG, PURG_PRCSD_DT) AS 
select "SHRHLDR_KEY","SHRHLDR_ROLE_KEY","SHRHLDR_TOP_LVL_CD","SHRHLDR_TOP_LVL_DESC","SHRHLDR_NM","TAX_IDNFCN_NBR","SSN_STAT_DESC","TAX_IDNFCN_TYPE","CUST_LGL_OWNR_REGSTN_DT","CUST_IDNFCN_NBR","CUST_IDNFCN_NBR_2","VIP_CUST_FLG","SEND_MKTG_INFO_FLG","INFORMED_CNSNT_FLG","PARTY_TYPE","CUST_EMPL_FLG","MGMT_CO_EMPL_FLG","LGL_STAT","GEND","BRTH_DT","DCSD_DT","EMPLMT_STAT","MRTL_STAT","CRTY_OF_CITZN_SHIP","ADDR_TYPE","ADDR_LINE_1","ADDR_LINE_2","ADDR_LINE_3","ADDR_LINE_4","CITY","ST","PROV","CRTY","REG","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","PURG_PRCSD_FLG","PURG_PRCSD_DT"
from shareholder
where CURR_ROW_FLG = 'Y'
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DAILY_AVG_ACCT_POSITION(DAILY_AVG_ACCT_POSN_KEY, DLR_KEY, DAY_KEY, FUND_KEY, ACCT_KEY, AVG_DAILY_SHRS, AVG_DAILY_BAL, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, TPA_KEY) AS 
SELECT "DAILY_AVG_ACCT_POSN_KEY","DLR_KEY","DAY_KEY","FUND_KEY","ACCT_KEY","AVG_DAILY_SHRS","AVG_DAILY_BAL","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","TPA_KEY" FROM Daily_Avg_Acct_Position
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER(DLR_KEY, DLR_TOP_LVL, DLR_TOP_LVL_DESC, DLR_GRP_ID, DLR_GRP_NM, DLR_ID, BRANCH_ESTB_DT, BRANCH_CLOSED_DT, SELLG_AGRMT_RQRD_FLG, SELLG_AGRMT_12B1_FLG, PAYOUT_FREQ_CD, PAYOUT_FREQ_DESC, STMT_FREQ_CD, STMT_FREQ_DESC, RECV_12B1_TAPE_FLG, AUTO_DIVD_CHK_FLG, WIRE_INCL_ACCRL_FLG, SIPC_INSD_FLG, DLR_FDIC_SELL_FLG, SEC_ID, MBR_SHIP_TYPE_CD, MBR_SHIP_TYPE, INVAL_REP_HNDLG_CD, INVAL_REP_HNDLG_DESC, INVMT_SLIP_ADDR_CD, INVMT_SLIP_ADDR, TRSTE_DFLT_DLR_ID, GRP_SALES_CHNL_ID, GRP_FINCL_INST_ID, DIVD_CONFIRM_SPRSN_FLG, DAILY_CONFIRM_SPRSN_FLG, ONLN_INVAL_REP_HNDLG_FLG, DLR_REP_ST_LIC_VLDN_FLG, DLR_INVAL_REP_ST_LIC_ACTN_FLG, NASD_REGSTN_VLDN_LIC_FLG, INVAL_REP_NASD_REGSTR_FLG, DLR_NM, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, ADDR_LINE_4, CITY_NM, ST, POSTL_ZIP_CD, CRTY, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, SPR_ONBS_FLG, ONBS_FLG, INTRL_CNTL_DOC_DT, LTST_CNTL_AUDT_RECPT_DT, INACTV_DT, ACTV_FLG) AS 
select "DLR_KEY","DLR_TOP_LVL","DLR_TOP_LVL_DESC","DLR_GRP_ID","DLR_GRP_NM","DLR_ID","BRANCH_ESTB_DT","BRANCH_CLOSED_DT","SELLG_AGRMT_RQRD_FLG","SELLG_AGRMT_12B1_FLG","PAYOUT_FREQ_CD","PAYOUT_FREQ_DESC","STMT_FREQ_CD","STMT_FREQ_DESC","RECV_12B1_TAPE_FLG","AUTO_DIVD_CHK_FLG","WIRE_INCL_ACCRL_FLG","SIPC_INSD_FLG","DLR_FDIC_SELL_FLG","SEC_ID","MBR_SHIP_TYPE_CD","MBR_SHIP_TYPE","INVAL_REP_HNDLG_CD","INVAL_REP_HNDLG_DESC","INVMT_SLIP_ADDR_CD","INVMT_SLIP_ADDR","TRSTE_DFLT_DLR_ID","GRP_SALES_CHNL_ID","GRP_FINCL_INST_ID","DIVD_CONFIRM_SPRSN_FLG","DAILY_CONFIRM_SPRSN_FLG","ONLN_INVAL_REP_HNDLG_FLG","DLR_REP_ST_LIC_VLDN_FLG","DLR_INVAL_REP_ST_LIC_ACTN_FLG","NASD_REGSTN_VLDN_LIC_FLG","INVAL_REP_NASD_REGSTR_FLG","DLR_NM","ADDR_LINE_1","ADDR_LINE_2","ADDR_LINE_3","ADDR_LINE_4","CITY_NM","ST","POSTL_ZIP_CD","CRTY","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","SPR_ONBS_FLG","ONBS_FLG","INTRL_CNTL_DOC_DT","LTST_CNTL_AUDT_RECPT_DT","INACTV_DT","ACTV_FLG" from dealer
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_ASSET_SUMMARY(DLR_FEE_SUM_KEY, DLR_KEY, FUND_KEY, DAY_KEY, PRIR_PER_ASSET, CURR_PER_ASSET, PRIR_PER_ELIGBL_ASSET, CURR_PER_ELIGBL_ASSET, PRIR_PER_INELIG_ASSET, CURR_PER_INELIG_ASSET, PRIR_PER_TA_ASSET, CURR_PER_TA_ASSET, PRIR_PER_TA_ELIGBL_ASSET, CURR_PER_TA_ELIGBL_ASSET, PRIR_PER_TA_INELIG_ASSET, CURR_PER_TA_INELIG_ASSET, PRIR_PER_AVG_ASSET, CURR_PER_AVG_ASSET, PRIR_PER_AVG_ELIGBL_ASSET, CURR_PER_AVG_ELIGBL_ASSET, PRIR_PER_AVG_INELIG_ASSET, CURR_PER_AVG_INELIG_ASSET, PRIR_PER_AVG_TA_ASSET, CURR_PER_AVG_TA_ASSET, PRIR_AVG_TA_ELIGBL_ASSET, CURR_AVG_TA_INELIG_ASSET, PRIR_AVG_TA_INELIG_ASSET, CURR_AVG_TA_ELIGBL_ASSET, SUB_AMT, REDMPN_AMT, NET_CASHFLOW_AMT, MKT_VAL_CHG, AVG_SUB_AMT, AVG_REDMPN_AMT, AVG_NET_AMT, AVG_MKT_VAL_CHG, DLR_TPA_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_FEE_SUM_KEY","DLR_KEY","FUND_KEY","DAY_KEY","PRIR_PER_ASSET","CURR_PER_ASSET","PRIR_PER_ELIGBL_ASSET","CURR_PER_ELIGBL_ASSET","PRIR_PER_INELIG_ASSET","CURR_PER_INELIG_ASSET","PRIR_PER_TA_ASSET","CURR_PER_TA_ASSET","PRIR_PER_TA_ELIGBL_ASSET","CURR_PER_TA_ELIGBL_ASSET","PRIR_PER_TA_INELIG_ASSET","CURR_PER_TA_INELIG_ASSET","PRIR_PER_AVG_ASSET","CURR_PER_AVG_ASSET","PRIR_PER_AVG_ELIGBL_ASSET","CURR_PER_AVG_ELIGBL_ASSET","PRIR_PER_AVG_INELIG_ASSET","CURR_PER_AVG_INELIG_ASSET","PRIR_PER_AVG_TA_ASSET","CURR_PER_AVG_TA_ASSET","PRIR_AVG_TA_ELIGBL_ASSET","CURR_AVG_TA_INELIG_ASSET","PRIR_AVG_TA_INELIG_ASSET","CURR_AVG_TA_ELIGBL_ASSET","SUB_AMT","REDMPN_AMT","NET_CASHFLOW_AMT","MKT_VAL_CHG","AVG_SUB_AMT","AVG_REDMPN_AMT","AVG_NET_AMT","AVG_MKT_VAL_CHG","DLR_TPA_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM DEALER_ASSET_SUMMARY
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_BRANCH(DLR_BRANCH_KEY, DLR_ID, BRANCH_ID, BRANCH_NM, BRANCH_ADDR_LINE_1, BRANCH_ADDR_LINE_2, BRANCH_ADDR_LINE_3, BRANCH_ADDR_LINE_4, BRANCH_CITY, BRANCH_ST_CD, BRANCH_ST, BRANCH_CRTY, BRANCH_ZIP_CD, BRANCH_ESTB_DT, BRANCH_CLOSED_DT, BRANCH_PAY_OFC_ID, BRANCH_FUNC_TYPE_ID, BRANCH_FORGN_TAX_CD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_BRANCH_KEY","DLR_ID","BRANCH_ID","BRANCH_NM","BRANCH_ADDR_LINE_1","BRANCH_ADDR_LINE_2","BRANCH_ADDR_LINE_3","BRANCH_ADDR_LINE_4","BRANCH_CITY","BRANCH_ST_CD","BRANCH_ST","BRANCH_CRTY","BRANCH_ZIP_CD","BRANCH_ESTB_DT","BRANCH_CLOSED_DT","BRANCH_PAY_OFC_ID","BRANCH_FUNC_TYPE_ID","BRANCH_FORGN_TAX_CD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Branch
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_CHANGE_CONTROL(DLR_CHG_CNTL_KEY, DLR_KEY, DAY_KEY, CHG_CNTL_ID, CHG_TYPE, CHG_DESC, RECVG_DLR_NM, RECVG_DLR_ACCT_TYPE, ACCT_MOVE_CNT, BSKY_NTFN_FLG, HBR_IMPCT, CUSIP_LIST, DELVY_DLR_MTRX_LVL, DELVY_DLR_ACCT_TYPE, ASSET_MOVE_VAL, DELVY_DLR_PLFM_NM, DELVY_DLR_FEES, RECVG_DLR_ID, RECVG_DLR_MTRX_LVL, RECVG_DLR_FEES, CNVRSN_STRT_DT, CNVRSN_END_DT, CHG_RSN, CHG_CONTNT_TYPE, CONTCT_NM, UFID_STAT, DLR_GRPING_STAT, DLR_PROF_STAT, MTF_STAT, LIVE_LINK_STAT, RFRSER_RQST, COMMFEE_CMMT, CUMDISC_CD, MTF_INLSN_FLG, AWD_SEND_VAL, MTF_EXCLN_FLG, EXCLN_CMMTS, INLSN_CMMTS, CNVRSN_STAT, DLR_TOT_ASSET_PCT, CHG_CNTL_WKFL, FEE_IMPCT_FLG, CREATR, MODFR, CREATN_DT, CHG_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_CHG_CNTL_KEY","DLR_KEY","DAY_KEY","CHG_CNTL_ID","CHG_TYPE","CHG_DESC","RECVG_DLR_NM","RECVG_DLR_ACCT_TYPE","ACCT_MOVE_CNT","BSKY_NTFN_FLG","HBR_IMPCT","CUSIP_LIST","DELVY_DLR_MTRX_LVL","DELVY_DLR_ACCT_TYPE","ASSET_MOVE_VAL","DELVY_DLR_PLFM_NM","DELVY_DLR_FEES","RECVG_DLR_ID","RECVG_DLR_MTRX_LVL","RECVG_DLR_FEES","CNVRSN_STRT_DT","CNVRSN_END_DT","CHG_RSN","CHG_CONTNT_TYPE","CONTCT_NM","UFID_STAT","DLR_GRPING_STAT","DLR_PROF_STAT","MTF_STAT","LIVE_LINK_STAT","RFRSER_RQST","COMMFEE_CMMT","CUMDISC_CD","MTF_INLSN_FLG","AWD_SEND_VAL","MTF_EXCLN_FLG","EXCLN_CMMTS","INLSN_CMMTS","CNVRSN_STAT","DLR_TOT_ASSET_PCT","CHG_CNTL_WKFL","FEE_IMPCT_FLG","CREATR","MODFR","CREATN_DT","CHG_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Change_Control
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_CHANGE_LIST(DLR_CHG_LIST_KEY, DAY_KEY, FUND_KEY, ACCT_KEY, DLR_CHG_TYPE, ACCT_MAINT_SEQ_ID, DLR_ORIG_VAL, DLR_NEW_VAL, BATCH_NBR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_CHG_LIST_KEY","DAY_KEY","FUND_KEY","ACCT_KEY","DLR_CHG_TYPE","ACCT_MAINT_SEQ_ID","DLR_ORIG_VAL","DLR_NEW_VAL","BATCH_NBR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Change_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_DST_CHANGE_LIST(FUND_NBR, ACCT_NBR, CHANGE_TYPE, CHANGE_DT, LOAD_TIME, ACCT_MNT_SEQ_ID, BATCH_NUMBER, ORIG_VALUE, NEW_VALUE) AS 
select TO_NUMBER(FUND) FUND_NBR,
 TO_NUMBER(ACCOUNT) ACCT_NBR,
 TRIM(VIEW_COLUMN_NM) CHANGE_TYPE,
 TO_DATE(TO_CHAR(SUPER_SHEET_MNT_DT,'mm/dd/yyyy'),'mm/dd/yyyy') CHANGE_DT,
 LOAD_TIME,
 ACCT_MNT_SEQ_ID,
 BATCH_NUMBER,
 TRIM(BEFORE_VALUE) ORIG_VALUE,
 TRIM(AFTER_VALUE) NEW_VALUE
from stg.STG_HBR_ACCTMAINTHIST
where trim(view_column_nm) in ('DEALER','THIRD_PARTY_ADMIN','CUMDISC')  -- LIKE  'DEALER%' OR view_column_nm LIKE 'THIRD_PARTY_ADMIN%' OR view_column_nm LIKE'CUMDISC%'
AND SUPER_SHEET_MNT_DT > ADD_MONTHS(TRUNC(SYSDATE,'mm'),-12)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_FEE_ANALYSIS(DLR_FEE_ANLYS_KEY, DLR_KEY, FUND_KEY, DAY_KEY, DLR_FEE_TYPE_KEY, CONTRCTL_RT, ACTL_FEE, ACTL_RT, AVG_DAILY_ASSET, AVG_DAILY_ASSET_PRIR_PER, AVG_ELIGBL_DAILY_ASSET, AVG_ELIGBL_ASSET_PRIR_PER, DRVVD_RT, PRIR_PER_FEE, PRIR_PER_RT, FEE_DIFF, ASSET_DIFF, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_FEE_ANLYS_KEY","DLR_KEY","FUND_KEY","DAY_KEY","DLR_FEE_TYPE_KEY","CONTRCTL_RT","ACTL_FEE","ACTL_RT","AVG_DAILY_ASSET","AVG_DAILY_ASSET_PRIR_PER","AVG_ELIGBL_DAILY_ASSET","AVG_ELIGBL_ASSET_PRIR_PER","DRVVD_RT","PRIR_PER_FEE","PRIR_PER_RT","FEE_DIFF","ASSET_DIFF","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Fee_Analysis
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_FEE_RESEARCH(DLR_FEE_RSRH_KEY, DLR_KEY, INVC_DAY_KEY, PMT_DAY_KEY, FUND_KEY, ACCT_KEY, DLR_FEE_TYPE_KEY, HBR_AVG_AUM, HBR_AVG_SHRS, FEE_BP, FEE_CALC, HBR_AVG_AUM_PREV, HBR_AVG_SHRS_PREV, INVC_FREQ_FLG, BILLG_TYPE, FEE_CHRGD, AVG_AUM, AVG_BP, FEE_CHRGD_PREV, AVG_AUM_PREV, AVG_BP_PREV, FEE_CHRGD_FLG, CUSIP_LVL_AUM_DIFF_FLG, CUSIP_LVL_FEE_DIFF_FLG, CUSIP_CURR_AUM_DIFF_FLG, ACCT_CURR_AUM_DIFF_FLG, FEE_DIFF_FLG, AUM_DIFF_FLG, NAV_MO_AVG, NAV_MO_AVG_PREV, CURR_PER_DAYS, PRIR_PER_DAYS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "DLR_FEE_RSRH_KEY","DLR_KEY","INVC_DAY_KEY","PMT_DAY_KEY","FUND_KEY","ACCT_KEY","DLR_FEE_TYPE_KEY","HBR_AVG_AUM","HBR_AVG_SHRS","FEE_BP","FEE_CALC","HBR_AVG_AUM_PREV","HBR_AVG_SHRS_PREV","INVC_FREQ_FLG","BILLG_TYPE","FEE_CHRGD","AVG_AUM","AVG_BP","FEE_CHRGD_PREV","AVG_AUM_PREV","AVG_BP_PREV","FEE_CHRGD_FLG","CUSIP_LVL_AUM_DIFF_FLG","CUSIP_LVL_FEE_DIFF_FLG","CUSIP_CURR_AUM_DIFF_FLG","ACCT_CURR_AUM_DIFF_FLG","FEE_DIFF_FLG","AUM_DIFF_FLG","NAV_MO_AVG","NAV_MO_AVG_PREV","CURR_PER_DAYS","PRIR_PER_DAYS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from dealer_fee_research
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_FEE_SCHEDULE(DLR_FEE_SCHED_KEY, DLR_KEY, FUND_KEY, DLR_FEE_TYPE_KEY, DAY_KEY, FEE_RT, BUS_LINE, INVC_FEE_DESC, CMMTS, EFFTV_STRT_DT, EFFTV_END_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_FEE_SCHED_KEY","DLR_KEY","FUND_KEY","DLR_FEE_TYPE_KEY","DAY_KEY","FEE_RT","BUS_LINE","INVC_FEE_DESC","CMMTS","EFFTV_STRT_DT","EFFTV_END_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Fee_Schedule
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_FEE_TYPE(DLR_FEE_TYPE_KEY, DLR_FEE_TYPE_CD, DLR_FEE_TYPE_DESC) AS 
SELECT "DLR_FEE_TYPE_KEY","DLR_FEE_TYPE_CD","DLR_FEE_TYPE_DESC" FROM Dealer_Fee_type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_INVOICE(DLR_INVC_KEY, DLR_FEE_TYPE_KEY, DLR_KEY, FUND_KEY, INVC_DAY_KEY, PMT_DAY_KEY, ACCT_KEY, BUS_LINE, INVC_AVG_ASSET, FEE_RT, TOT_FEE_AMT, POSN_CNT, PER_ACCT_FEE, DLR_PORTAL_ASSET, PORTAL_POSN_CNT, INVC_FREQ_FLG, INVC_NBR, INVC_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, REC_SPLT_FLG, DLR_CAT, INVC_CAT) AS 
select "DLR_INVC_KEY","DLR_FEE_TYPE_KEY","DLR_KEY","FUND_KEY","INVC_DAY_KEY","PMT_DAY_KEY","ACCT_KEY","BUS_LINE","INVC_AVG_ASSET","FEE_RT","TOT_FEE_AMT","POSN_CNT","PER_ACCT_FEE","DLR_PORTAL_ASSET","PORTAL_POSN_CNT","INVC_FREQ_FLG","INVC_NBR","INVC_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","REC_SPLT_FLG","DLR_CAT","INVC_CAT" from dealer_invoice
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_INVOICE_MODEL(DLR_INVC_MDL_KEY, DLR_FEE_TYPE_KEY, DLR_KEY, INVC_DAY_KEY, PMT_DAY_KEY, FUND_KEY, BUS_LINE, INVC_AVG_ASSET, TOT_FEE_AMT, POSN_CNT, PER_ACCT_FEE, DLR_PORTAL_ASSET, PORTAL_POSN_CNT, INVC_FREQ_FLG, REC_SPLT_FLG, INVC_NBR, INVC_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "DLR_INVC_MDL_KEY","DLR_FEE_TYPE_KEY","DLR_KEY","INVC_DAY_KEY","PMT_DAY_KEY","FUND_KEY","BUS_LINE","INVC_AVG_ASSET","TOT_FEE_AMT","POSN_CNT","PER_ACCT_FEE","DLR_PORTAL_ASSET","PORTAL_POSN_CNT","INVC_FREQ_FLG","REC_SPLT_FLG","INVC_NBR","INVC_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from dealer_invoice_model
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_INVOICE_MTF_MODEL(DLR_FEE_TYPE_KEY, DLR_KEY, INVC_DAY_KEY, FUND_KEY, BUS_LINE, INVC_AVG_ASSET, TOT_FEE_AMT, INVC_FREQ_FLG) AS 
SELECT dlr_fee_type_key,
             dlr_key,
             invc_day_key,
             fund_key,
             bus_line,
             invc_avg_asset,
             tot_fee_amt,
             invc_freq_flg
      FROM hdm.dealer_invoice_model
    UNION ALL
    SELECT dlr_fee_type_key,
             mtf.dlr_key,
             day_key,
             fund_key,
             'Calculated by Harbor' AS bus_line,
             eligbl_avg_asset,
             tot_compnsn,
             'M' AS invc_freq_flg
      FROM hdm.dealer_payment_summary mtf
     WHERE mtf.dlr_key IN (  SELECT dlr_key
                                        FROM hdm.dealer_invoice_rule
                                  GROUP BY dlr_key)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_INVOICE_TRIAL(DLR_INVC_TRL_KEY, DLR_KEY, ACCT_KEY, FUND_KEY, INVC_DAY_KEY, DLR_FEE_TYPE_KEY, PMT_DAY_KEY, FEE_RT, TOT_FEE_AMT, INVC_NBR, INVC_DT, BUS_LINE, INVC_AVG_ASSET, POSN_CNT, PER_ACCT_FEE, DLR_PORTAL_ASSET, PORTAL_POSN_CNT, INVC_FREQ_FLG, REC_SPLT_FLG, DLR_CAT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "DLR_INVC_TRL_KEY","DLR_KEY","ACCT_KEY","FUND_KEY","INVC_DAY_KEY","DLR_FEE_TYPE_KEY","PMT_DAY_KEY","FEE_RT","TOT_FEE_AMT","INVC_NBR","INVC_DT","BUS_LINE","INVC_AVG_ASSET","POSN_CNT","PER_ACCT_FEE","DLR_PORTAL_ASSET","PORTAL_POSN_CNT","INVC_FREQ_FLG","REC_SPLT_FLG","DLR_CAT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID"
from dealer_invoice_trial
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_LEVEL_CONTROL(DLR_LVL_CNTL_KEY, DLR_LVL_CNTL_CD, DLR_LVL_CNTL_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
SELECT "DLR_LVL_CNTL_KEY","DLR_LVL_CNTL_CD","DLR_LVL_CNTL_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" FROM Dealer_Level_control
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYMENT_DEAIL(DLR_PMT_DET_KEY, DAY_KEY, DLR_KEY, FUND_KEY, DLR_BRANCH_KEY, DLR_FEE_TYPE_KEY, DLR_PMT_MTHD_KEY, ACCT_KEY, WK_ORD_ID, NSCC_FLG, NSCC_NM_USE_FLG, PMT_OFST_CD, PAYEE_TYPE, SPLT_COMPNSN_FLG, PREV_COMPNSN_OVRD_TYPE, ELIGBL_COMPNSN_OVRD_TYPE, PAYOUT_TYPE_KEY, PRE_AGREED_SHR_RT, PRE_AGREED_ASSET, PRE_AGREED_FEE, PREV_SPLT_FEE, TOT_ELIGBL_RT, TOT_ELIGBL_ASSET, TOT_ELIGBL_FEE, TOT_COMPNSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, AVG_ELIGBL_BP, AVG_ELIGBL_ASSET, AVG_ELIGBL_FEES) AS 
select "DLR_PMT_DET_KEY","DAY_KEY","DLR_KEY","FUND_KEY","DLR_BRANCH_KEY","DLR_FEE_TYPE_KEY","DLR_PMT_MTHD_KEY","ACCT_KEY","WK_ORD_ID","NSCC_FLG","NSCC_NM_USE_FLG","PMT_OFST_CD","PAYEE_TYPE","SPLT_COMPNSN_FLG","PREV_COMPNSN_OVRD_TYPE","ELIGBL_COMPNSN_OVRD_TYPE","PAYOUT_TYPE_KEY","PRE_AGREED_SHR_RT","PRE_AGREED_ASSET","PRE_AGREED_FEE","PREV_SPLT_FEE","TOT_ELIGBL_RT","TOT_ELIGBL_ASSET","TOT_ELIGBL_FEE","TOT_COMPNSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","AVG_ELIGBL_BP","AVG_ELIGBL_ASSET","AVG_ELIGBL_FEES" from dealer_payment_detail
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYMENT_DETAIL(DLR_PMT_DET_KEY, DAY_KEY, DLR_KEY, FUND_KEY, DLR_BRANCH_KEY, DLR_FEE_TYPE_KEY, DLR_PMT_MTHD_KEY, ACCT_KEY, WK_ORD_ID, NSCC_FLG, NSCC_NM_USE_FLG, PMT_OFST_CD, PAYEE_TYPE, SPLT_COMPNSN_FLG, PREV_COMPNSN_OVRD_TYPE, ELIGBL_COMPNSN_OVRD_TYPE, PAYOUT_TYPE_KEY, PRE_AGREED_SHR_RT, PRE_AGREED_ASSET, PRE_AGREED_FEE, PREV_SPLT_FEE, TOT_ELIGBL_RT, TOT_ELIGBL_ASSET, TOT_ELIGBL_FEE, TOT_COMPNSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, AVG_ELIGBL_BP, AVG_ELIGBL_ASSET, AVG_ELIGBL_FEES, PMT_DAY_KEY) AS 
select "DLR_PMT_DET_KEY","DAY_KEY","DLR_KEY","FUND_KEY","DLR_BRANCH_KEY","DLR_FEE_TYPE_KEY","DLR_PMT_MTHD_KEY","ACCT_KEY","WK_ORD_ID","NSCC_FLG","NSCC_NM_USE_FLG","PMT_OFST_CD","PAYEE_TYPE","SPLT_COMPNSN_FLG","PREV_COMPNSN_OVRD_TYPE","ELIGBL_COMPNSN_OVRD_TYPE","PAYOUT_TYPE_KEY","PRE_AGREED_SHR_RT","PRE_AGREED_ASSET","PRE_AGREED_FEE","PREV_SPLT_FEE","TOT_ELIGBL_RT","TOT_ELIGBL_ASSET","TOT_ELIGBL_FEE","TOT_COMPNSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","AVG_ELIGBL_BP","AVG_ELIGBL_ASSET","AVG_ELIGBL_FEES","PMT_DAY_KEY" from dealer_payment_detail
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYMENT_METHOD(DLR_PMT_MTHD_KEY, PMT_MTHD_CD, PMT_MTHD_DESC) AS 
SELECT "DLR_PMT_MTHD_KEY","PMT_MTHD_CD","PMT_MTHD_DESC" FROM Dealer_Payment_method
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYMENT_SUMMARY(DLR_PMT_SUM_KEY, DLR_FEE_TYPE_KEY, DAY_KEY, FUND_KEY, DLR_KEY, DLR_PMT_MTHD_KEY, WK_ORD_NBR, COMPNSN_PYEE_TYPE_CD, PRE_AGREED_SCHED_OVRD_TYPE, PRE_AGREE_SHR_RT, PRE_AGREE_AVG_ASSET, PRE_AGREE_COMPNSN, ELIGBL_COMPNSN_OVRD_TYPE, ELIGBL_SHR_RT, ELIGBL_AVG_ASSET, ELIGBL_COMPNSN, TOT_COMPNSN, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, COMPNSN_DIFF, PREV_PER_COMPNSN, AVG_ASSET_DIFF, PREV_PER_ASSET, TRL_MODE_FLG, PMT_DAY_KEY, BUS_LINE) AS 
select "DLR_PMT_SUM_KEY","DLR_FEE_TYPE_KEY","DAY_KEY","FUND_KEY","DLR_KEY","DLR_PMT_MTHD_KEY","WK_ORD_NBR","COMPNSN_PYEE_TYPE_CD","PRE_AGREED_SCHED_OVRD_TYPE","PRE_AGREE_SHR_RT","PRE_AGREE_AVG_ASSET","PRE_AGREE_COMPNSN","ELIGBL_COMPNSN_OVRD_TYPE","ELIGBL_SHR_RT","ELIGBL_AVG_ASSET","ELIGBL_COMPNSN","TOT_COMPNSN","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","COMPNSN_DIFF","PREV_PER_COMPNSN","AVG_ASSET_DIFF","PREV_PER_ASSET","TRL_MODE_FLG","PMT_DAY_KEY","BUS_LINE" from dealer_payment_summary
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYMENT_TRIAL(DLR_PMT_TRL_KEY, DLR_KEY, FUND_KEY, DLR_BRANCH_KEY, DLR_FEE_TYPE_KEY, DLR_PMT_MTHD_KEY, ACCT_KEY, PAYOUT_TYPE_KEY, PMT_DAY_KEY, INVC_DAY_KEY, WK_ORD_ID, NSCC_FLG, NSCC_NM_USE_FLG, PMT_OFST_CD, PAYEE_TYPE, SPLT_COMPNSN_FLG, PREV_COMPNSN_OVRD_TYPE, ELIGBL_COMPNSN_OVRD_TYPE, PRE_AGRD_SHR_RT, PRE_AGRD_ASSET, PRE_AGRD_FEE, PREV_SPLT_FEE, TOT_ELIGBL_RT, TOT_ELIGBL_ASSET, TOT_ELIGBL_FEE, TOT_COMPNSN, AVG_ELIGBL_BP, AVG_ELIGBL_ASSET, AVG_ELIGBL_FEES, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DLR_PMT_TRL_KEY","DLR_KEY","FUND_KEY","DLR_BRANCH_KEY","DLR_FEE_TYPE_KEY","DLR_PMT_MTHD_KEY","ACCT_KEY","PAYOUT_TYPE_KEY","PMT_DAY_KEY","INVC_DAY_KEY","WK_ORD_ID","NSCC_FLG","NSCC_NM_USE_FLG","PMT_OFST_CD","PAYEE_TYPE","SPLT_COMPNSN_FLG","PREV_COMPNSN_OVRD_TYPE","ELIGBL_COMPNSN_OVRD_TYPE","PRE_AGRD_SHR_RT","PRE_AGRD_ASSET","PRE_AGRD_FEE","PREV_SPLT_FEE","TOT_ELIGBL_RT","TOT_ELIGBL_ASSET","TOT_ELIGBL_FEE","TOT_COMPNSN","AVG_ELIGBL_BP","AVG_ELIGBL_ASSET","AVG_ELIGBL_FEES","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dealer_Payment_Trial
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DEALER_PAYOUT_TYPE(PAYOUT_TYPE_KEY, PAYOUT_TYPE_CD, PAYOUT_TYPE_DESC) AS 
SELECT "PAYOUT_TYPE_KEY","PAYOUT_TYPE_CD","PAYOUT_TYPE_DESC" FROM Dealer_Payout_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DISTRIBUTION_CODE(DSTRBTN_CD_KEY, DSTRBTN_CD, DSTRBTN_DESC) AS 
select "DSTRBTN_CD_KEY","DSTRBTN_CD","DSTRBTN_DESC" from distribution_code
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DISTRIBUTION_TYPE(DSTRBTN_TYPE_KEY, DSTRBTN_TYPE_CD, DSTRBTN_TYPE_DESC) AS 
select "DSTRBTN_TYPE_KEY","DSTRBTN_TYPE_CD","DSTRBTN_TYPE_DESC" from distribution_type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DIVIDEND_TAX_RATE(DIVD_TAX_RT_KEY, TAX_YR, ORDN_INCM_RT, LTCG_RT, STCG_RT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DIVD_TAX_RT_KEY","TAX_YR","ORDN_INCM_RT","LTCG_RT","STCG_RT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Dividend_Tax_Rate
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DLP_ACCOUNTS(ACCTNBR, REG1, REG2, REG3, REG4, REG5, REG6, REG7) AS 
SELECT  
                              a.acct_nbr acctnbr,
                              a.regstn_line_1 reg1,
                              a.regstn_line_2 reg2,
                              a.regstn_line_3 reg3,
                              a.regstn_line_4 reg4,
                              a.regstn_line_5 reg5,
                              a.regstn_line_6 reg6,
                              a.regstn_line_7 reg7
  FROM hdm.vw_account a
WHERE   a.tax_id NOT IN
                      (123456789,
                       000000000,
                       111111111,
                       1,
                       341953397,
                       341953393,
                       341953399,
                       980592172,
                       561223381,
                       341572115,
                       341931837,
                       346864487,
                       341570877,
                       306006023,
                       341971614,
                       341570746,
                       341748997,
                       205075188,
                       264203992,
                       263062227,
                       271891764,
                       274941322,
                       451258204,
                       451258360,
                       030488315,
                       341570861,
                       047018428,
                       341570876,
                       263713174,
                       263713227,
                       263713261,
                       263713284,
                       263713315,
                       263713340,
                       263713369,
                       263713394,
                       263713422,
                       263713447)
      AND a.acct_nbr NOT IN
                          (60000001,
                           60100001,
                           60200001,
                           60300001,
                           60400001,
                           60500001,
                           60600001,
                           60700001,
                           60800001,
                           60900001,
                           70000001,
                           70100001,
                           70200001,
                           70300001,
                           70400001,
                           70500001,
                           70600001,
                           70700001,
                           70800001,
                           70900001,
                           80000001,
                           80100001,
                           80200001,
                           80300001,
                           80400001,
                           80500001,
                           80600001,
                           80700001,
                           80800001,
                           80900001)
    and (a.ACCT_STAT = 'Open Status' OR (a.ACCT_STAT = 'Closed Status' and last_mntn_dt >= ADD_MONTHS (TRUNC (SYSDATE, 'mm'), -24)))
group by                      
  a.acct_nbr,
  a.regstn_line_1,
  a.regstn_line_2,
  a.regstn_line_3,
  a.regstn_line_4,
  a.regstn_line_5,
  a.regstn_line_6,
  a.regstn_line_7                           
UNION ALL
SELECT 33445566,
                              'John Doe',
                              '123 Main St.',
                              'Chicago IL 66666-6666',
                              '',
                              '',
                              '',
                              ''
  FROM DUAL
UNION ALL
SELECT 33445567,
                              'Jane Doe',
                              '321 Side St.',
                              'Chicago IL 60606-6666',
                              '',
                              '',
                              '',
                              ''
  FROM DUAL
UNION ALL
SELECT 33445568,
                              'John Smith',
                              '123 Michigan Ave.',
                              'Chicago IL 60607-6666',
                              '',
                              '',
                              '',
                              ''
  FROM DUAL
UNION ALL
SELECT 33445569,
                              'Jane Smith',
                              '321 Wacker Dr.',
                              'Chicago IL 60606-6666',
                              '',
                              '',
                              '',
                              ''
  FROM DUAL
/



CREATE OR REPLACE FORCE VIEW HDM.VW_DLP_TAXID(TAX_ID) AS 
SELECT
    a.tax_id
FROM hdm.vw_account a
WHERE a.tax_id NOT IN
                  (123456789,
                   000000000,
                   111111111,
                   1,
                   341953397,
                   341953393,
                   341953399,
                   980592172,
                   561223381,
                   341572115,
                   341931837,
                   346864487,
                   341570877,
                   306006023,
                   341971614,
                   341570746,
                   341748997,
                   205075188,
                   264203992,
                   263062227,
                   271891764,
                   274941322,
                   451258204,
                   451258360,
                   030488315,
                   341570861,
                   047018428,
                   341570876,
                   263713174,
                   263713227,
                   263713261,
                   263713284,
                   263713315,
                   263713340,
                   263713369,
                   263713394,
                   263713422,
                   263713447)
  AND a.acct_nbr NOT IN
                  (60000001,
                   60100001,
                   60200001,
                   60300001,
                   60400001,
                   60500001,
                   60600001,
                   60700001,
                   60800001,
                   60900001,
                   70000001,
                   70100001,
                   70200001,
                   70300001,
                   70400001,
                   70500001,
                   70600001,
                   70700001,
                   70800001,
                   70900001,
                   80000001,
                   80100001,
                   80200001,
                   80300001,
                   80400001,
                   80500001,
                   80600001,
                   80700001,
                   80800001,
                   80900001)
  and (a.ACCT_STAT = 'Open Status' OR (a.ACCT_STAT = 'Closed Status' and last_mntn_dt >= ADD_MONTHS (TRUNC (SYSDATE, 'mm'), -24)))
GROUP BY
    a.tax_id                              
UNION ALL
SELECT 325689021
  FROM DUAL
UNION ALL
SELECT 325689022
  FROM DUAL
UNION ALL
SELECT 325689023
  FROM DUAL
UNION ALL
SELECT 325689024
  FROM DUAL
/



CREATE OR REPLACE FORCE VIEW HDM.VW_ELIGIBLE_ASSET_LIST(ELIGBL_ASSET_LIST_KEY, DLR_KEY, INLSN_EXCLN_FLG, CUM_DISCNT_NBR, SHR_CLS_CD, QLFYD_RTRMT_FLG, EFFTV_STRT_DT, EFFTV_END_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ELIGBL_ASSET_LIST_KEY","DLR_KEY","INLSN_EXCLN_FLG","CUM_DISCNT_NBR","SHR_CLS_CD","QLFYD_RTRMT_FLG","EFFTV_STRT_DT","EFFTV_END_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Eligible_Asset_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXCHANGE_TYPE(XCHG_TYPE_KEY, XCHG_TYPE_CD, XCHG_TYPE_DESC) AS 
SELECT "XCHG_TYPE_KEY","XCHG_TYPE_CD","XCHG_TYPE_DESC" FROM Exchange_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXPENSE_RATIO(DAY_KEY, FUND_KEY, EFFTV_STRT_DT, EFFTV_END_DT, NET_EXPNS_RATIO, NET_EXPNS_RATIO_YTD, GR_EXPNS_RATIO, GR_EXPNS_RATIO_YTD) AS 
SELECT day_key,
          fund_key,
          efftv_strt_dt,
          efftv_end_dt,
          net_expns_ratio,
          net_expns_ratio_ytd,
          gr_expns_ratio,
          gr_expns_ratio_YTD
     FROM MV_EXPense_RATIO
   UNION ALL
   SELECT day_key,
          fund_key,
          efftv_strt_dt,
          efftv_end_dt,
          net_expns_ratio,
          net_expns_ratio AS net_expns_ratio_ytd,
          NULL AS gr_expns_Ratio,
          NULL AS gr_expns_Ratio_Ytd
     FROM expense_ratio_History
   UNION ALL -- THIS CODE WILL COPY PREVIOUS MONTH'S ER FOR CURRENT MONTH UNTIL CURRENT MONTH IS AVAILABLE.  USED FOR ROBECO GROSS RETURN REPORT
   SELECT (SELECT day_key
             FROM calendar
            WHERE cal_day = ADD_MONTHS (c.cal_day, 1))
             day_key,
          fund_key,
          efftv_strt_dt,
          ADD_MONTHS (efftv_end_dt, 1) efftv_end_dt,
          net_expns_ratio,
          net_expns_ratio_ytd,
          gr_expns_ratio,
          gr_expns_ratio YTD
     FROM MV_EXPENSE_RATIO a, calendar c
    WHERE     a.day_key = c.day_key
          AND c.cal_day = (SELECT MAX (cal_day)
                             FROM calendar cl, mv_expense_ratio er
                            WHERE cl.day_key = er.day_key)
          AND cal_day <= ADD_MONTHS (TRUNC (SYSDATE, 'mm'), -1)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXPENSE_RATIO_HISTORY(EXPNS_RATIO_HIST_KEY, DAY_KEY, FUND_KEY, EFFTV_STRT_DT, EFFTV_END_DT, NET_EXPNS_RATIO) AS 
SELECT "EXPNS_RATIO_HIST_KEY","DAY_KEY","FUND_KEY","EFFTV_STRT_DT","EFFTV_END_DT","NET_EXPNS_RATIO" FROM Expense_Ratio_History
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXTERNAL_FUND(EXT_FUND_KEY, EXT_FUND_NM, ASSET_CLS_NM) AS 
SELECT "EXT_FUND_KEY", "EXT_FUND_NM", "ASSET_CLS_NM"
     FROM FID_External_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXTERNAL_FUND_BALANCE(EXT_FUND_BAL_KEY, FUND_KEY, DAY_KEY, EXT_SRC, SHRS, BAL_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, OFFR_ID, OFFR_NM) AS 
select "EXT_FUND_BAL_KEY","FUND_KEY","DAY_KEY","EXT_SRC","SHRS","BAL_AMT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","OFFR_ID","OFFR_NM" from external_fund_balance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXTERNAL_FUND_LIS(EXT_FUND_LIST_KEY, EXT_FUND_ID, EXT_FUND_DESC, FUND_KEY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, FUND_TICKR_SYM) AS 
select "EXT_FUND_LIST_KEY","EXT_FUND_ID","EXT_FUND_DESC","FUND_KEY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","FUND_TICKR_SYM" from external_fund_list
/



CREATE OR REPLACE FORCE VIEW HDM.VW_EXTERNAL_FUND_LIST(EXT_FUND_LIST_KEY, EXT_FUND_ID, EXT_FUND_DESC, FUND_KEY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, FUND_TICKR_SYM) AS 
select "EXT_FUND_LIST_KEY","EXT_FUND_ID","EXT_FUND_DESC","FUND_KEY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","FUND_TICKR_SYM" from external_fund_list
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FACILITY(FAC_KEY, FAC_ID, SUB_FAC_NM, FAC_FUNC_ID, DAY_KEY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FAC_KEY","FAC_ID","SUB_FAC_NM","FAC_FUNC_ID","DAY_KEY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Facility
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FEE_SCHEDULE(FEE_SCHED_KEY, DLR_KEY, FUND_KEY, DLR_FEE_TYPE_KEY, CONTRCT_STRT_DAY_KEY, CONTRCT_END_DAY_KEY, DLR_BILLG_TYPE_FLG, FEE_RT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FEE_SCHED_KEY","DLR_KEY","FUND_KEY","DLR_FEE_TYPE_KEY","CONTRCT_STRT_DAY_KEY","CONTRCT_END_DAY_KEY","DLR_BILLG_TYPE_FLG","FEE_RT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Fee_Schedule
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FEE_SCHEDULE_VIEW(DLR_KEY, FUND_KEY, BUS_LINE, INVC_FEE_DESC, FEE_12B1, FEE_SPC1, FEE_INST, FEE_MF, FEE_PAF) AS 
select dlr_key,fund_key,bus_line,(CASE WHEN dlr_fee_type_cd in ('MF','PAF') Then '' else invc_fee_desc end) invc_fee_desc,
SUM((Case When dlr_Fee_type_cd = '12B1' THEN FEE_rT end)) FEE_12B1,
SUM((Case When dlr_Fee_type_cd = 'SPC1' THEN FEE_rT end)) FEE_SPC1,
SUM((Case When dlr_Fee_type_cd IN ( 'SPC2','SPC3') THEN FEE_rT end)) FEE_INST,
SUM((Case When dlr_Fee_type_cd = 'MF' THEN FEE_rT end)) FEE_MF,
SUM((Case When dlr_Fee_type_cd = 'PAF' THEN FEE_rT end)) FEE_PAF
from dealer_fee_schedule fs 
INNER JOIN dealer_Fee_type ft ON fs.dlr_Fee_type_key=ft.dlr_fee_type_key
GROUP BY dlr_key,fund_key,bus_line,(CASE WHEN dlr_fee_type_cd in ('MF','PAF') Then '' else invc_fee_desc end)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_ASSET_CLASS(FID_ASSET_CLS_KEY, FID_ASSET_CLS_DESC) AS 
select "FID_ASSET_CLS_KEY", "FID_ASSET_CLS_DESC"
     from fiduciary_asset_class
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_ASSET_LINK(FID_ASSET_CLS_KEY, FUND_KEY) AS 
select  ac.fid_asset_cls_key, ff.fund_key
from hdm.fiduciary_asset_class ac, hdm.vw_fiduciary_fund ff
where ac.fid_asset_cls_desc = 'Domestic Equity Portfolio'
   and ff.asset_cls_nm = 'Domestic'
union   
select  ac.fid_asset_cls_key, ff.fund_key
from hdm.fiduciary_asset_class ac, hdm.vw_fiduciary_fund ff
where ac.fid_asset_cls_desc = 'International Equity Portfolio'
   and ff.asset_cls_nm = 'International and Global'   
union
select  ac.fid_asset_cls_key, ff.fund_key
from hdm.fiduciary_asset_class ac, hdm.vw_fiduciary_fund ff
where ac.fid_asset_cls_desc = 'Fixed Income Portfolio'
   and ff.asset_cls_nm = 'Fixed Income'
union
select  ac.fid_asset_cls_key, ff.fund_key
from hdm.fiduciary_asset_class ac, hdm.vw_fiduciary_fund ff
where ac.fid_asset_cls_desc = 'Total Equity Portfolio'
   and ff.asset_cls_nm in ('Domestic', 'International and Global')
union
select  ac.fid_asset_cls_key, ff.fund_key
from hdm.fiduciary_asset_class ac, hdm.vw_fiduciary_fund ff
where ac.fid_asset_cls_desc = 'Total Portfolio'
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_BENCHMARK_INDEX(EXT_BMK_IDX_KEY, IDX_NM) AS 
SELECT bmk_idx_key, idx_nm FROM hdm.benchmark_index
   UNION
   SELECT ext_bmk_key, idx_nm FROM hdm.fid_external_benchmark
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_CUSTOMER(FID_CUST_KEY, FID_CUST_NM, FID_CUST_ACCT_NBR) AS 
SELECT "FID_CUST_KEY","FID_CUST_NM","FID_CUST_ACCT_NBR" FROM Fiduciary_Customer
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_FUND(FUND_KEY, FUND_NM, FUND_NBR, SHR_CLS_DESC, ASSET_CLS_NM, FUND_SORT_ORD) AS 
SELECT fund_key,
           fund_nm,
           fund_nbr,
           shr_cls_desc,
           c.asset_cls_nm,
           f.fund_sort_ord
      FROM hdm.vw_fund f, hdm.vw_fund_composite c
     WHERE     f.fund_compst_key = c.fund_compst_key
    UNION
    SELECT ext_fund_key,
           ext_fund_nm,
           NULL,
           null,
           asset_cls_nm,
           99999
      FROM hdm.fid_external_fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FIDUCIARY_POSITION(FID_POSN_KEY, FID_CUST_KEY, DAY_KEY, FUND_KEY, NAV, SHRS, MKT_VAL, MO_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FID_POSN_KEY","FID_CUST_KEY","DAY_KEY","FUND_KEY","NAV","SHRS","MKT_VAL","MO_RET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Fiduciary_Position
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BENCHMARK_PERFORMANCE(FID_BMK_PERF_KEY, DAY_KEY, FID_ASSET_CLS_KEY, FID_CUST_KEY, PER_KEY, BMK_RET, ANNLZN_FCTR, STRT_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FID_BMK_PERF_KEY","DAY_KEY","FID_ASSET_CLS_KEY","FID_CUST_KEY","PER_KEY","BMK_RET","ANNLZN_FCTR","STRT_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Benchmark_Performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BENCHMARK_POSITION(BMK_POSN_KEY, FID_CUST_KEY, DAY_KEY, FUND_KEY, BMK_IDX_KEY, MO_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BMK_POSN_KEY",
             "FID_CUST_KEY",
             "DAY_KEY",
             "FUND_KEY",
             "BMK_IDX_KEY",
             "MO_RET",
             "CURR_ROW_FLG",
             "ROW_STRT_DTTM",
             "ROW_STOP_DTTM",
             "ETL_LOAD_CYC_KEY",
             "SRC_SYS_ID"
      FROM fid_benchmark_position
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BENCHMARK_WEIGHT(BMK_WGT_KEY, BMK_IDX_KEY, FID_CUST_KEY, FID_ASSET_CLS_KEY, FUND_KEY, EFFTV_STRT_DT, EFFTV_END_DT, BMK_WGT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BMK_WGT_KEY","BMK_IDX_KEY","FID_CUST_KEY","FID_ASSET_CLS_KEY","FUND_KEY","EFFTV_STRT_DT","EFFTV_END_DT","BMK_WGT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Benchmark_Weight
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BM_LEVEL_PERFORMANCE(BM_LVL_PERF_KEY, FUND_KEY, BMK_IDX_KEY, DAY_KEY, FID_CUST_KEY, PER_KEY, BMK_RET, ANNLZN_FCTR, STRT_DT, INCPN_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BM_LVL_PERF_KEY","FUND_KEY","BMK_IDX_KEY","DAY_KEY","FID_CUST_KEY","PER_KEY","BMK_RET","ANNLZN_FCTR","STRT_DT","INCPN_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_BM_Level_Performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BM_LEVEL_WEALTH_INDEX(BM_LVL_WLTH_IDX_KEY, FUND_KEY, BMK_IDX_KEY, DAY_KEY, FID_CUST_KEY, WLTH_IDX, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BM_LVL_WLTH_IDX_KEY","FUND_KEY","BMK_IDX_KEY","DAY_KEY","FID_CUST_KEY","WLTH_IDX","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_BM_Level_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_BM_WEALTH_INDEX(BMK_WLTH_IDX_KEY, DAY_KEY, FID_ASSET_CLS_KEY, FID_CUST_KEY, ASSET_RET, WLTH_IDX, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "BMK_WLTH_IDX_KEY","DAY_KEY","FID_ASSET_CLS_KEY","FID_CUST_KEY","ASSET_RET","WLTH_IDX","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_BM_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_CLIENT_ASSET_MIX(FID_CLIENT_ASSET_MIX_KEY, FID_ASSET_CLS_KEY, FID_CUST_KEY, INCPN_DT) AS 
SELECT "FID_CLIENT_ASSET_MIX_KEY","FID_ASSET_CLS_KEY","FID_CUST_KEY","INCPN_DT" FROM FID_Client_Asset_Mix
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_EXTERNAL_BENCHMARK(EXT_BMK_KEY, IDX_NM) AS 
SELECT "EXT_BMK_KEY","IDX_NM" FROM FID_External_Benchmark
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_EXTERNAL_FUND(EXT_FUND_KEY, EXT_FUND_NM, ASSET_CLS_NM) AS 
SELECT "EXT_FUND_KEY","EXT_FUND_NM","ASSET_CLS_NM" FROM FID_External_Fund
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_FUND_INDEX_RLTN(FUND_KEY, FUND_COMPST_KEY, BMK_IDX_KEY) AS 
SELECT f.fund_key, br.fund_compst_key, br.bmk_idx_key
      FROM hdm.fund_index_rltn br, hdm.vw_fund f, hdm.vw_fund_composite c
     WHERE     br.fund_compst_key = c.fund_compst_key
           AND f.fund_compst_key = c.fund_compst_key
           AND br.prim_bmk_flg = 'Y'
           AND br.perf_run_type_key = 1
           --AND f.shr_cls_desc = 'Institutional Class'
    UNION
    SELECT 1000001, NULL, 10000001
      FROM DUAL
    UNION
    SELECT 1000002,
           NULL,
           (SELECT bmk_idx_key
              FROM hdm.benchmark_index
             WHERE bloomberg_sym = 'SPTR')
      FROM DUAL
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_FUND_LEVEL_PERFORMANCE(FUND_LVL_PERF_KEY, FUND_KEY, DAY_KEY, FID_CUST_KEY, PER_KEY, FUND_RET, ANNLZN_FCTR, STRT_DT, INCPN_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_LVL_PERF_KEY","FUND_KEY","DAY_KEY","FID_CUST_KEY","PER_KEY","FUND_RET","ANNLZN_FCTR","STRT_DT","INCPN_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Fund_Level_Performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_FUND_LEVEL_WEALTH_INDEX(FUND_LVL_WLTH_IDX_KEY, DAY_KEY, FUND_KEY, FID_CUST_KEY, WLTH_IDX, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_LVL_WLTH_IDX_KEY","DAY_KEY","FUND_KEY","FID_CUST_KEY","WLTH_IDX","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Fund_Level_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_FUND_PERFORMANCE(FID_FUND_PERF_KEY, DAY_KEY, FID_ASSET_CLS_KEY, FID_CUST_KEY, PER_KEY, FUND_RET, ANNLZN_FCTR, STRT_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FID_FUND_PERF_KEY","DAY_KEY","FID_ASSET_CLS_KEY","FID_CUST_KEY","PER_KEY","FUND_RET","ANNLZN_FCTR","STRT_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Fund_Performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_FUND_WEALTH_INDEX(FID_WLTH_IDX_KEY, DAY_KEY, FID_ASSET_CLS_KEY, FID_CUST_KEY, MKT_VAL, ASSET_RET, WLTH_IDX, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, MKT_VAL_ADJ) AS 
select "FID_WLTH_IDX_KEY","DAY_KEY","FID_ASSET_CLS_KEY","FID_CUST_KEY","MKT_VAL","ASSET_RET","WLTH_IDX","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","MKT_VAL_ADJ" from FID_FUND_WEALTH_INDEX
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_LETTER_RECIPIENT(LTR_RECPNT_KEY, FID_CUST_KEY, RECPNT_NM, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, CITY, ST, ZIP_CD, ACTV_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "LTR_RECPNT_KEY","FID_CUST_KEY","RECPNT_NM","ADDR_LINE_1","ADDR_LINE_2","ADDR_LINE_3","CITY","ST","ZIP_CD","ACTV_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FID_Letter_Recipient
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FID_WEALTH_INDEX_TEMP(FID_ASSET_CLS_KEY, FID_CUST_KEY, DAY_KEY, ASSET_RET, WLTH_IDX) AS 
SELECT "FID_ASSET_CLS_KEY","FID_CUST_KEY","DAY_KEY","ASSET_RET","WLTH_IDX" FROM FID_Wealth_Index_Temp
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_CHARACTERISTICS(FI_CHARCTC_FACT_KEY, FUND_COMPST_KEY, DAY_KEY, FI_CHARCTC_LIST_KEY, FUND_CHARCTC_VAL, PRIM_BMK_CHARCTC, SECY_BMK_CHARCTC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CHARCTC_FACT_KEY","FUND_COMPST_KEY","DAY_KEY","FI_CHARCTC_LIST_KEY","FUND_CHARCTC_VAL","PRIM_BMK_CHARCTC","SECY_BMK_CHARCTC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Characteristics
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_CHARACTERISTIC_LIST(FI_CHARCTC_LIST_KEY, CHARCTC_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CHARCTC_LIST_KEY","CHARCTC_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Characteristic_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_COMPOSITION_MAP(FI_COMPSN_MAP_KEY, SRC_TYPE, COMPST_NM, SRC_COMPSN_NM, TRGT_COMPSN_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_COMPSN_MAP_KEY","SRC_TYPE","COMPST_NM","SRC_COMPSN_NM","TRGT_COMPSN_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Composition_Map
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_COUNTRY(FI_CRTY_KEY, REG, CRTY_TYPE, CRTY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CRTY_KEY","REG","CRTY_TYPE","CRTY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Country
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_COUNTRY_ALLOCATION(FI_CRTY_ALLOCN_KEY, FUND_COMPST_KEY, DAY_KEY, FI_CRTY_KEY, FUND_ALLOCN, PRIM_BMK_ALLOCN, SECY_BMK_ALLOCN, FUND_EXT__DUR_YR, FUND_EXT_EM_SPRD, FUND_LOC_DUR_YR, FUND_CURR_EXPSR, BMK_EXT_DUR_YR, BMK_EXT_EM_SPRD, BMK_LOC_DUR_YR, BMK_CURR_EXPSR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CRTY_ALLOCN_KEY","FUND_COMPST_KEY","DAY_KEY","FI_CRTY_KEY","FUND_ALLOCN","PRIM_BMK_ALLOCN","SECY_BMK_ALLOCN","FUND_EXT__DUR_YR","FUND_EXT_EM_SPRD","FUND_LOC_DUR_YR","FUND_CURR_EXPSR","BMK_EXT_DUR_YR","BMK_EXT_EM_SPRD","BMK_LOC_DUR_YR","BMK_CURR_EXPSR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Country_Allocation
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_CREDIT_RATING(FI_CR_RTNGS_KEY, FUND_COMPST_KEY, DAY_KEY, FI_CR_RTNG_LIST_KEY, FUND_RTNG_EXCLSV_CASH, FUND_RTNG_INCLV_CASH, PRIM_BMK_RTNG, SECY_BMK_RTNG, FUND_DWE_EXCLSV_CASH, FUND_DWE_INCLV_CASH, PRIM_BMK_DWE, SECY_BMK_DWE, FUND_EXPSR_AMT, FUND_EXPSR_RT, FUND_DUR_RT, FUND_DWE, BMK_EXPSR_RT, BMK_DUR_RT, BMK_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CR_RTNGS_KEY","FUND_COMPST_KEY","DAY_KEY","FI_CR_RTNG_LIST_KEY","FUND_RTNG_EXCLSV_CASH","FUND_RTNG_INCLV_CASH","PRIM_BMK_RTNG","SECY_BMK_RTNG","FUND_DWE_EXCLSV_CASH","FUND_DWE_INCLV_CASH","PRIM_BMK_DWE","SECY_BMK_DWE","FUND_EXPSR_AMT","FUND_EXPSR_RT","FUND_DUR_RT","FUND_DWE","BMK_EXPSR_RT","BMK_DUR_RT","BMK_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Credit_Rating
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_CREDIT_RATING_LIST(FI_CR_RTNG_LIST_KEY, CR_RTNG_NM, RTNG_SORT_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_CR_RTNG_LIST_KEY","CR_RTNG_NM","RTNG_SORT_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Credit_Rating_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_DURATION_MATURITY(FI_DUR_MTRY_KEY, FUND_COMPST_KEY, DAY_KEY, FI_TM_PER_KEY, FUND_YCA_DUR_INCLV_CASH, FUND_YCA_DUR_EXCLSV_CASH, PRIM_BMK_DUR, SECY_BMK_DUR, FUND_YCA_MTRY_INCLV_CASH, FUND_YCA_MTRY_EXCLSV_CASH, PRIM_BMK_MTRY, SECY_BMK_MTRY, FUND_DWE_INCLV_CASH, FUND_DWE_EXCLSV_CASH, PRIM_BMK_DWE, SECY_BMK_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_DUR_MTRY_KEY","FUND_COMPST_KEY","DAY_KEY","FI_TM_PER_KEY","FUND_YCA_DUR_INCLV_CASH","FUND_YCA_DUR_EXCLSV_CASH","PRIM_BMK_DUR","SECY_BMK_DUR","FUND_YCA_MTRY_INCLV_CASH","FUND_YCA_MTRY_EXCLSV_CASH","PRIM_BMK_MTRY","SECY_BMK_MTRY","FUND_DWE_INCLV_CASH","FUND_DWE_EXCLSV_CASH","PRIM_BMK_DWE","SECY_BMK_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Duration_Maturity
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_ISSUER(FI_ISSR_KEY, ISSR_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_ISSR_KEY","ISSR_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Issuer
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_SECTOR(FI_SCTR_KEY, SCTR_TYPE, SCTR_NM, SUB_SCTR_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_SCTR_KEY","SCTR_TYPE","SCTR_NM","SUB_SCTR_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Sector
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_SECTOR_ALLOCATION(FI_SCTR_ALLOCN_KEY, FUND_COMPST_KEY, DAY_KEY, FI_SCTR_KEY, FUND_WGT_EXCLSV_CASH, FUND_WGT_INCLV_CASH, PRIM_BMK_WGT, SCNDAY_BMK_WGT, FUND_DWE_EXCLSV_CASH, FUND_DWE_INCLV_CASH, PRIM_BMK_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_SCTR_ALLOCN_KEY","FUND_COMPST_KEY","DAY_KEY","FI_SCTR_KEY","FUND_WGT_EXCLSV_CASH","FUND_WGT_INCLV_CASH","PRIM_BMK_WGT","SCNDAY_BMK_WGT","FUND_DWE_EXCLSV_CASH","FUND_DWE_INCLV_CASH","PRIM_BMK_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Sector_Allocation
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_TIME_PERIOD(FI_TM_PER_KEY, TM_PER, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_TM_PER_KEY","TM_PER","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Time_Period
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_TIME_PERIOD_MAPPING(FI_TM_PER_MPNG_KEY, SRC_PER, TRGT_PER, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_TM_PER_MPNG_KEY","SRC_PER","TRGT_PER","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Time_Period_Mapping
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FI_TOP_ISSUERS(FI_TOP_ISSR_KEY, FUND_COMPST_KEY, DAY_KEY, FI_ISSR_KEY, ISSR_PCT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ROW_UPDT_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FI_TOP_ISSR_KEY","FUND_COMPST_KEY","DAY_KEY","FI_ISSR_KEY","ISSR_PCT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ROW_UPDT_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM FI_Top_Issuers
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND(FUND_KEY, ALL_FUND_CD, ALL_FUND_DESC, FUND_COMPST_KEY, SHR_CLS_CD, SHR_CLS_DESC, FUND_NM, FUND_LONG_DESC, FUND_ABRV, FUND_STAT_CD, FUND_STAT_DESC, FUND_INCPN_DT, FUND_CLOS_DT, FUND_NBR, FUND_SORT_ORD, ADDR_ID, CUSIP_ID, QUOT_SYM, ST_STR_FUND_NBR, TAX_ID, RISK_LVL, DIVD_FREQ_CD, DIVD_FREQ_DESC, CAP_GAIN_FREQ_CD, CAP_GAIN_FREQ_DESC, REG_ACCT_INIT_INVMT, IRA_ACCT_INIT_INVMT, UGMA_ACCT_INIT_INVMT, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY, PERF_INCPN_DT) AS 
SELECT "FUND_KEY","ALL_FUND_CD","ALL_FUND_DESC","FUND_COMPST_KEY","SHR_CLS_CD","SHR_CLS_DESC","FUND_NM","FUND_LONG_DESC","FUND_ABRV","FUND_STAT_CD","FUND_STAT_DESC","FUND_INCPN_DT","FUND_CLOS_DT","FUND_NBR","FUND_SORT_ORD","ADDR_ID","CUSIP_ID","QUOT_SYM","ST_STR_FUND_NBR","TAX_ID","RISK_LVL","DIVD_FREQ_CD","DIVD_FREQ_DESC","CAP_GAIN_FREQ_CD","CAP_GAIN_FREQ_DESC","REG_ACCT_INIT_INVMT","IRA_ACCT_INIT_INVMT","UGMA_ACCT_INIT_INVMT","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY","PERF_INCPN_DT" FROM FUND
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_ANNUAL_INVESTMENT(FUND_KEY, ANNL_INVMT_AMT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_KEY","ANNL_INVMT_AMT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Fund_Annual_Investment
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_BENCHMARK_RETURN_UNION(RECORD_TYPE, RETURN_KEY, PER_KEY, PER_NM, PER_SORT_ORD, BMK_IDX_KEY, INSTRUMENT, FUND_COMPST_KEY, SHR_CLS_DESC, COMPST_NM, COMPST_ORD, DAY_KEY, CAL_DAY, OFFICIAL_RETURN, ASOF_RETURN, STRT_PER, ANNLZN_FCTR, RET_PER_FLG, PERF_DISPLAY_ORDER, GEN_RPTG_FLG, DAILY_RPTG_FLG, TRGT_RPTG_FLG, RET_VRFYN_FLG) AS 
SELECT 'Fund' AS record_type,
          RET.FUND_RET_KEY return_key,
          RET.PER_KEY,
          RP.PER_NM,
          RP.PER_SORT_ORD,
          0 AS BMK_IDX_KEY,
          FND.FUND_NM INSTRUMENT,
          FC.FUND_COMPST_KEY,
          FND.SHR_CLS_DESC,
          FC.COMPST_NM,
          FC.COMPST_ORD,
          RET.DAY_KEY,
          CAL.CAL_DAY,
          RET.FUND_RET Official_Return,
          RET.ASOF_FUND_RET AsOf_Return,
          RET.STRT_PER,
          RET.ANNLZN_FCTR,
          RET.RET_PER_FLG,
          FND.FUND_SORT_ORD perf_display_order,
          'Y' GEN_RPTG_FLG,
          'Y' DAILY_RPTG_FLG,
          'Y' TRGT_RPTG_FLG,
          RET.RET_VRFYN_FLG
     FROM HDM.FUND_RETURN RET
          INNER JOIN HDM.CALENDAR CAL
             ON RET.DAY_KEY = CAL.DAY_KEY
          INNER JOIN HDM.RETURN_PERIODS RP
             ON RET.PER_KEY = RP.PER_KEY
          INNER JOIN HDM.FUND FND
             ON RET.FUND_KEY = FND.FUND_KEY
          INNER JOIN HDM.FUND_COMPOSITE FC
             ON FND.FUND_COMPST_KEY = FC.FUND_COMPST_KEY
   UNION ALL
   SELECT 'Benchmark' AS record_type,
          IRET.IDX_RET_KEY,
          IRET.PER_KEY,
          IRP.PER_NM,
          IRP.PER_SORT_ORD,
          IRET.BMK_IDX_KEY,
          IDX.IDX_NM,
          IRET.FUND_COMPST_KEY,
          IFND.SHR_CLS_DESC,
          IFC.COMPST_NM,
          IFC.COMPST_ORD,
          IRET.DAY_KEY,
          ICAL.CAL_DAY,
          IRET.IDX_RET,
          IRET.IDX_RET ASOF_FUND_RET,
          IRET.STRT_PER,
          IRET.ANNLZN_FCTR,
          IRET.RET_PER_FLG,
          IRET.PERF_DISPL_ORD,
          IRET.GEN_RPTG_FLG,
          IRET.DAILY_RPTG_FLG,
          IRET.TRGT_RPTG_FLG,
          'Y' RET_VRFYN_FLG
     FROM HDM.INDEX_RETURN IRET
          INNER JOIN HDM.CALENDAR ICAL
             ON IRET.DAY_KEY = ICAL.DAY_KEY
          INNER JOIN HDM.BENCHMARK_INDEX IDX
             ON IRET.BMK_IDX_KEY = IDX.BMK_IDX_KEY
          INNER JOIN HDM.RETURN_PERIODS IRP
             ON IRET.PER_KEY = IRP.PER_KEY
          INNER JOIN HDM.FUND_COMPOSITE IFC
             ON IRET.FUND_COMPST_KEY = IFC.FUND_COMPST_KEY
          INNER JOIN HDM.FUND IFND
             ON IFC.FUND_COMPST_KEY = IFND.FUND_COMPST_KEY
          INNER JOIN HDM.FUND_RETURN FRET
             ON IRET.DAY_KEY=FRET.DAY_KEY AND IRET.PER_KEY=FRET.PER_KEY AND IFND.FUND_KEY=FRET.FUND_KEY             
    WHERE IFND.SHR_CLS_DESC = 'Institutional Class'
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_COMPOSITE(FUND_COMPST_KEY, ALL_COMPST_CD, ALL_COMPST_DESC, ASSET_CLS_NM, ASSET_CLS_DESC, SUB_CLS_NM, SUB_CLS_DESC, STYL_NM, STYL_DESC, COMPST_CD, COMPST_NM, PERF_CD, PERF_NM, COMPST_ORD, COMPST_STAT_CD, COMPST_STAT_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, COMPST_SRC_ID, FUND_STYL, RISK_RET_ORD, COMPST_INCPN_DT, SALES_CAT, ST_STR_FUND_NBR) AS 
SELECT "FUND_COMPST_KEY","ALL_COMPST_CD","ALL_COMPST_DESC","ASSET_CLS_NM","ASSET_CLS_DESC","SUB_CLS_NM","SUB_CLS_DESC","STYL_NM","STYL_DESC","COMPST_CD","COMPST_NM","PERF_CD","PERF_NM","COMPST_ORD","COMPST_STAT_CD","COMPST_STAT_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","COMPST_SRC_ID","FUND_STYL","RISK_RET_ORD","COMPST_INCPN_DT","SALES_CAT","ST_STR_FUND_NBR" FROM hdm.FUND_COMPOSITE
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_DIVIDEND(FUND_DIVD_KEY, FUND_KEY, REC_DAY_KEY, REINVEST_DAY_KEY, PAYBL_DAY_KEY, TOT_DIVD, NET_INVMT_INCM, SHRS_OF_REC, RE_INVST_PR, ORDN_INCM, TOT_SHRT_TERM_GAINS, TOT_MID_TERM_GAINS, TOT_LONG_TERM_GAINS, SHRT_TERM_CAP_GAINS, MID_TERM_CAP_GAINS, LONG_TERM_CAP_GAINS, NON_TXBL_DISCNT, FORGN_TAX_CR, RE_INVST_IDX, EST_DIVD_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, QDI) AS 
SELECT "FUND_DIVD_KEY","FUND_KEY","REC_DAY_KEY","REINVEST_DAY_KEY","PAYBL_DAY_KEY","TOT_DIVD","NET_INVMT_INCM","SHRS_OF_REC","RE_INVST_PR","ORDN_INCM","TOT_SHRT_TERM_GAINS","TOT_MID_TERM_GAINS","TOT_LONG_TERM_GAINS","SHRT_TERM_CAP_GAINS","MID_TERM_CAP_GAINS","LONG_TERM_CAP_GAINS","NON_TXBL_DISCNT","FORGN_TAX_CR","RE_INVST_IDX","EST_DIVD_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","QDI" FROM FUND_DIVIDEND
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_EXPENSE_RATIO(FUND_EXPNS_RATIO_KEY, EXPNS_RATIO_WAVR_TYPE_KEY, FUND_KEY, SEMI_ANNL_RPT_DT, EFFTV_STRT_DT, EFFTV_END_DT, GR_EXPNS_RATIO, NET_EXPNS_RATIO, EXPNS_WAVR_RATIO, CAYMAN_RATIO, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, MANUAL_ENTRY_FLG, PER_FLG, PASS_THRU_MGMT_FEE_WAVR) AS 
select "FUND_EXPNS_RATIO_KEY","EXPNS_RATIO_WAVR_TYPE_KEY","FUND_KEY","SEMI_ANNL_RPT_DT","EFFTV_STRT_DT","EFFTV_END_DT","GR_EXPNS_RATIO","NET_EXPNS_RATIO","EXPNS_WAVR_RATIO","CAYMAN_RATIO","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","MANUAL_ENTRY_FLG","PER_FLG","PASS_THRU_MGMT_FEE_WAVR" from fund_expense_ratio
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_HOLDINGS(FUND_HOLDG_KEY, DAY_KEY, FUND_COMPST_KEY, SECR_KEY, SECR_ATTR_KEY, INDTRY_KEY, INC_CRTY_KEY, ISS_CRTY_KEY, TRDE_CRTY_KEY, NRA_TAX_CRTY_KEY, BASE_CRTY_KEY, BASE_CURRCY_KEY, LOC_CURRCY_KEY, MKT_PR_CURRCY_KEY, INCM_CURRCY_KEY, ROW_SEQ_NBR, DAYS_TO_MTRY, PAR_SHRS, ORIG_BASE_COST, ORIG_LOC_COST, IDFD_BASE_COST, IDFD_LOC_COST, BASE_MKT_VAL, LOC_MKT_VAL, CURR_BASE_PR, CURR_LOC_PR, URLZ_GL_LOC, URLZ_GL_BASE, AVG_COST_BASE_PAR_SHRS, AVG_COST_LOC_PAR_SHRS, ORIG_STRK_PR, CURR_STRK_PR, VEND_SUPPLD_ISS_CURR_PR, BASE_NET_AMORT, LOC_NET_AMORT, GR_BASE_AMT_ACCRD, GR_LOC_AMT_ACCRD, CURR_VARB_RT, PARTITION_YR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_HOLDG_KEY","DAY_KEY","FUND_COMPST_KEY","SECR_KEY","SECR_ATTR_KEY","INDTRY_KEY","INC_CRTY_KEY","ISS_CRTY_KEY","TRDE_CRTY_KEY","NRA_TAX_CRTY_KEY","BASE_CRTY_KEY","BASE_CURRCY_KEY","LOC_CURRCY_KEY","MKT_PR_CURRCY_KEY","INCM_CURRCY_KEY","ROW_SEQ_NBR","DAYS_TO_MTRY","PAR_SHRS","ORIG_BASE_COST","ORIG_LOC_COST","IDFD_BASE_COST","IDFD_LOC_COST","BASE_MKT_VAL","LOC_MKT_VAL","CURR_BASE_PR","CURR_LOC_PR","URLZ_GL_LOC","URLZ_GL_BASE","AVG_COST_BASE_PAR_SHRS","AVG_COST_LOC_PAR_SHRS","ORIG_STRK_PR","CURR_STRK_PR","VEND_SUPPLD_ISS_CURR_PR","BASE_NET_AMORT","LOC_NET_AMORT","GR_BASE_AMT_ACCRD","GR_LOC_AMT_ACCRD","CURR_VARB_RT","PARTITION_YR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM HDM.FUND_HOLDINGs
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_INDEX_RLTN(FUND_IDX_KEY, FUND_COMPST_KEY, BMK_IDX_KEY, PERF_RUN_TYPE_KEY, LINK_PRIO, RPT_SORT_ORD, PRIM_BMK_FLG, GR_RET_INLSN_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_IDX_KEY",
          "FUND_COMPST_KEY",
          "BMK_IDX_KEY",
          "PERF_RUN_TYPE_KEY",
          "LINK_PRIO",
          "RPT_SORT_ORD",
          "PRIM_BMK_FLG",
          "GR_RET_INLSN_FLG",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID"
     FROM FUND_INDEX_RLTN
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_RETURN(FUND_RET_KEY, FUND_KEY, PER_KEY, DAY_KEY, STRT_PER, FUND_RET, ANNLZN_FCTR, ASOF_FUND_RET, RET_PER_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, RET_VRFYN_FLG) AS 
SELECT "FUND_RET_KEY",
          "FUND_KEY",
          "PER_KEY",
          "DAY_KEY",
          "STRT_PER",
          "FUND_RET",
          "ANNLZN_FCTR",
          "ASOF_FUND_RET",
          "RET_PER_FLG",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID",
          "RET_VRFYN_FLG"
     FROM fund_Return
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_TRANS_HIST(TXN_HIST_KEY, TXN_TYPE_KEY, REG_KEY, REG_OF_SALE_KEY, DLR_KEY, TPA_DLR_KEY, SHRHLDR_KEY, ACCT_KEY, FUND_KEY, EFFTV_DAY_KEY, STTL_DAY_KEY, PMT_DAY_KEY, BATCH_DAY_KEY, DLR_BRANCH_KEY, TRDE_ORIG_KEY, RSN_KEY, SSN_STAT_KEY, TRDE_ENTRY_MTHD_KEY, DLR_LVL_CNTL_KEY, PMT_MTHD_KEY, SHRHLDR_ROLE_KEY, ACCT_NBR, FUND_NBR, FUND_TXN_ID, FUND_TXN_ID_2, LTR_OF_INTEND_NBR, BATCH_NBR, DISCNT_CAT, FUND_ORD_NBR, NAV_CD, ACCT_PR_SCHED, UNDR_WRTR_COMMSN_CD, CDSC_WAVR_RSN_CD, NSCC_SHRT_TERM_TRADER_WAVR_RSN, CONTRBN_TAX_YR, SHRS, SHR_PR, GR_AMT, SALES_PCT, DLR_COMMSN_AMT, UNDR_WRTR_COMMSN_AMT, NET_AMT, BLUESKY_TXN_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY, TXN_DESC, SHR_BAL_EFFCT_FLG, BLUESKY_REOPEN_ACCT_FLG, FRTO_FUND_KEY, SPR_SHEET_DAY_KEY, OPR_ID) AS 
SELECT fund_trans_hist.txn_hist_key,
           fund_trans_hist.txn_type_key,
           fund_trans_hist.reg_key,
           FUND_TRANS_HIST.REG_OF_SALE_KEY,
           fund_trans_hist.dlr_key,
           fund_trans_hist.tpa_dlr_key,
           fund_trans_hist.shrhldr_key,
           fund_trans_hist.acct_key,
           fund_trans_hist.fund_key,
           fund_trans_hist.efftv_day_key,
           fund_trans_hist.sttl_day_key,
           fund_trans_hist.pmt_day_key,
           fund_trans_hist.batch_day_key,
           fund_trans_hist.dlr_branch_key,
           fund_trans_hist.trde_orig_key,
           fund_trans_hist.rsn_key,
           fund_trans_hist.ssn_stat_key,
           fund_trans_hist.trde_entry_mthd_key,
           fund_trans_hist.dlr_lvl_cntl_key,
           fund_trans_hist.pmt_mthd_key,
           fund_trans_hist.shrhldr_role_key,
           fund_trans_hist.acct_nbr,
           fund.fund_nbr,
           fund_trans_hist.fund_txn_id,
           fund_trans_hist.fund_txn_id_2,
           fund_trans_hist.ltr_of_intend_nbr,
           fund_trans_hist.batch_nbr,
           fund_trans_hist.discnt_cat,
           fund_trans_hist.fund_ord_nbr,
           fund_trans_hist.nav_cd,
           fund_trans_hist.acct_pr_sched,
           fund_trans_hist.undr_wrtr_commsn_cd,
           fund_trans_hist.cdsc_wavr_rsn_cd,
           fund_trans_hist.nscc_shrt_term_trader_wavr_rsn,
           fund_trans_hist.contrbn_tax_yr,
           fund_trans_hist.shrs,
           fund_trans_hist.shr_pr,
           fund_trans_hist.gr_amt,
           fund_trans_hist.sales_pct,
           fund_trans_hist.dlr_commsn_amt,
           fund_trans_hist.undr_wrtr_commsn_amt,
           fund_trans_hist.net_amt,
           fund_trans_hist.bluesky_txn_flg,
           fund_trans_hist.row_strt_dttm,
           fund_trans_hist.row_stop_dttm,
           fund_trans_hist.curr_row_flg,
           fund_trans_hist.src_sys_id,
           fund_trans_hist.etl_load_cyc_key,
           fund_trans_hist.TXN_DESC,
           fund_trans_hist.SHR_BAL_EFFCT_FLG,
           fund_trans_hist.BLUESKY_REOPEN_ACCT_FLG,
           fund_trans_hist.FRTO_FUND_KEY,
           FUND_TRANS_HIST.SPR_SHEET_DAY_KEY,
           fund_trans_hist.opr_id
      FROM fund_trans_hist, fund
     WHERE fund_trans_hist.fund_key = fund.fund_key
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_VALUATION(FUND_VLTN_KEY, FUND_KEY, DAY_KEY, NAV_AMT, TOT_SHRS, PR_PER_SHR, WLTH_IDX, ASOF_PR, DAILY_PR_DIFF, ASOF_WLTH_IDX, HSG_PR_REVS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "FUND_VLTN_KEY","FUND_KEY","DAY_KEY","NAV_AMT","TOT_SHRS","PR_PER_SHR","WLTH_IDX","ASOF_PR","DAILY_PR_DIFF","ASOF_WLTH_IDX","HSG_PR_REVS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from fund_valuation
/



CREATE OR REPLACE FORCE VIEW HDM.VW_FUND_YIELD(FUND_YLD_KEY, FUND_KEY, DAY_KEY, YLD_TYPE_KEY, FUND_YLD, PREV_DAY_FUND_YLD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT FUND_YIELD."FUND_YLD_KEY",
          FUND_YIELD."FUND_KEY",
          FUND_YIELD."DAY_KEY",
          FUND_YIELD."YLD_TYPE_KEY",
          FUND_YIELD."FUND_YLD",
          lag(fund_yld) over (partition by fund_key,yld_type_key order by CAL_DAY ) prev_day_FUND_yld,
          FUND_YIELD."CURR_ROW_FLG",
          FUND_YIELD."ROW_STRT_DTTM",
          FUND_YIELD."ROW_STOP_DTTM",
          FUND_YIELD."ETL_LOAD_CYC_KEY",
          FUND_YIELD."SRC_SYS_ID"
     FROM Fund_Yield ,calendar
     Where fund_yield.day_key=calendar.day_key
/



CREATE OR REPLACE FORCE VIEW HDM.VW_GENDER(GEND_KEY, GEND_NM, GEND_CD) AS 
select "GEND_KEY","GEND_NM","GEND_CD" from hdm.gender
/



CREATE OR REPLACE FORCE VIEW HDM.VW_GROSS_RETURN(GR_RET_KEY, DAY_KEY, FUND_KEY, BMK_IDX_KEY, PER_KEY, GR_RET, INFO_RATIO, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, IDX_RET) AS 
SELECT "GR_RET_KEY","DAY_KEY","FUND_KEY","BMK_IDX_KEY","PER_KEY","GR_RET","INFO_RATIO","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","IDX_RET" FROM GROSS_RETURN
/



CREATE OR REPLACE FORCE VIEW HDM.VW_GROSS_WEALTH_INDEX(GR_WLTH_IDX_KEY, DAY_KEY, FUND_KEY, GR_WLTH_IDX, NET_WLTH_IDX, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "GR_WLTH_IDX_KEY","DAY_KEY","FUND_KEY","GR_WLTH_IDX","NET_WLTH_IDX","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Gross_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_GROUP_TRUST_LEVELS(GRP_TRST_LVL_KEY, ASSET_TYPE, PERF_THRS, ASSET_ALLOCN, ASSET_ALLOCN_PRXY, ACCPTBL_ALLOCN_PRXY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "GRP_TRST_LVL_KEY","ASSET_TYPE","PERF_THRS","ASSET_ALLOCN","ASSET_ALLOCN_PRXY","ACCPTBL_ALLOCN_PRXY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Group_Trust_Levels
/



CREATE OR REPLACE FORCE VIEW HDM.VW_HARBOR_FUND(FUND_KEY, FUND_LONG_DESC, FUND_NBR, FUND_INCPN_DT, FUND_CLOS_DT, FUND_ABRV, CUSIP_ID, FUND_STAT_DESC, QUOT_SYM, ST_STR_FUND_NBR, SHR_CLS_DESC, FUND_SORT_ORD, CLS_ORD, TARGET_FUND, FUND_COMPST_KEY, COMPST_NM, COMPST_STAT_DESC, COMPST_ORD, STYL_NM, ASSET_CLS_DESC, ALL_COMPST_DESC) AS 
SELECT FUND.FUND_KEY,
            FUND.FUND_LONG_DESC,
            fund.fund_nbr,
            FUND.FUND_INCPN_DT,
            FUND_CLOS_DT,
            FUND.FUND_ABRV,
            FUND.CUSIP_ID,
            FUND.FUND_STAT_DESC,
            FUND.QUOT_SYM,
            FUND.ST_STR_FUND_NBR,
            FUND.SHR_CLS_DESC,
            FUND.FUND_SORT_ORD,
            MAX (compst_ord) OVER (PARTITION BY asset_cls_desc) cls_ord,
            (CASE
                WHEN ASSET_CLS_DESC = 'Target Retirement Funds'
                THEN
                   'Target Fund'
                ELSE
                   'Non Target Fund'
             END)
               AS TARGET_FUND,
            cmp.fund_compst_key,
            cmp.compst_nm,
            cmp.compst_stat_desc,
            CMP.COMPST_ORD,
            CMP.STYL_NM,
            CMP.ASSET_CLS_DESC,
            CMP.ALL_COMPST_DESC
       FROM fund, fund_composite cmp
      WHERE FUND.FUND_COMPST_KEY = CMP.FUND_COMPST_KEY
   ORDER BY fund_sort_ord
/



CREATE OR REPLACE FORCE VIEW HDM.VW_HOLDINGS_FOREIGN_OWNERSHIP(HOLDG_OPEN_POSN_KEY, FUND_COMPST_KEY, SECR_KEY, INC_CRTY_KEY, ISS_CRTY_KEY, TRDE_CRTY_KEY, THRS_CRTY_KEY, DAY_KEY, TOT_LONG_POSN, ACTL_CSTDY_POSN, PEND_SALE_QTY, PEND_BUY_QTY, FREE_QTY, OSHR_QTY, PAR_SHR_QTY, TOT_SHRT_POSN, ON_LOAN_QTY, NEW_SECR_FLG, ALL_CLS_OSHR_QTY, ALL_VOTING_OSHR_QTY, ALL_NON_VOTING_OSHR_QTY, VOTING_SHR_IND, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, PRC_SHRS_CLS, PRC_SHRS_ACLS, PRC_SHRS_VOTING, PRC_SHRS_NONVOTING, BREACH_IND_CLS, BREACH_IND_ACLS, BREACH_IND_VOTING, BREACH_IND_NONVOTING, THRSH_BR_CLS, THRSH_BR_ACLS, THRSH_BR_VOTING, THRSH_BR_NONVOTING, NEW_BR_IND_CLS, NEW_BR_IND_ACLS, NEW_BR_IND_VOTING, NEW_BR_IND_NONVOTING, SPEC_ALERT_CLS, SPEC_ALERT_ACLS, SPEC_ALERT_VOTING, SPEC_ALERT_NONVOTING, PROX_INT_BR_CLS, PROX_EXT_BR_CLS, PROX_INT_BR_ACLS, PROX_EXT_BR_ACLS, PROX_INT_BR_VOTING, PROX_EXT_BR_VOTING, PROX_INT_BR_NONVOTING, PROX_EXT_BR_NONVOTING, BREACH_IND_INT_CLS, BREACH_IND_INT_ACLS, BREACH_IND_INT_VOTING, BREACH_IND_INT_NONVOTING, ISSUER_NM, ADR_SPSR_SHIP_TYPE) AS 
SELECT "HOLDG_OPEN_POSN_KEY",
          "FUND_COMPST_KEY",
          "SECR_KEY",
          "INC_CRTY_KEY",
          "ISS_CRTY_KEY",
          "TRDE_CRTY_KEY",
          "THRS_CRTY_KEY",
          "DAY_KEY",
          "TOT_LONG_POSN",
          "ACTL_CSTDY_POSN",
          "PEND_SALE_QTY",
          "PEND_BUY_QTY",
          "FREE_QTY",
          "OSHR_QTY",
          "PAR_SHR_QTY",
          "TOT_SHRT_POSN",
          "ON_LOAN_QTY",
          "NEW_SECR_FLG",
          "ALL_CLS_OSHR_QTY",
          "ALL_VOTING_OSHR_QTY",
          "ALL_NON_VOTING_OSHR_QTY",
          "VOTING_SHR_IND",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID",
          "PRC_SHRS_CLS",
          "PRC_SHRS_ACLS",
          "PRC_SHRS_VOTING",
          "PRC_SHRS_NONVOTING",
          "BREACH_IND_CLS",
          "BREACH_IND_ACLS",
          "BREACH_IND_VOTING",
          "BREACH_IND_NONVOTING",
          "THRSH_BR_CLS",
          "THRSH_BR_ACLS",
          "THRSH_BR_VOTING",
          "THRSH_BR_NONVOTING",
          "NEW_BR_IND_CLS",
          "NEW_BR_IND_ACLS",
          "NEW_BR_IND_VOTING",
          "NEW_BR_IND_NONVOTING",
          "SPEC_ALERT_CLS",
          "SPEC_ALERT_ACLS",
          "SPEC_ALERT_VOTING",
          "SPEC_ALERT_NONVOTING",
          "PROX_INT_BR_CLS",
          "PROX_EXT_BR_CLS",
          "PROX_INT_BR_ACLS",
          "PROX_EXT_BR_ACLS",
          "PROX_INT_BR_VOTING",
          "PROX_EXT_BR_VOTING",
          "PROX_INT_BR_NONVOTING",
          "PROX_EXT_BR_NONVOTING",
          "BREACH_IND_INT_CLS",
          "BREACH_IND_INT_ACLS",
          "BREACH_IND_INT_VOTING",
          "BREACH_IND_INT_NONVOTING",
          "ISSUER_NM",
          "ADR_SPSR_SHIP_TYPE"
     FROM hdm.holdings_foreign_ownership
/



CREATE OR REPLACE FORCE VIEW HDM.VW_HOLDINGS_OPEN_POSITION(HOLDG_OPEN_POSN_KEY, FUND_COMPST_KEY, SECR_KEY, INC_CRTY_KEY, ISS_CRTY_KEY, TRDE_CRTY_KEY, THRS_CRTY_KEY, DAY_KEY, TOT_LONG_POSN, ACTL_CSTDY_POSN, PEND_SALE_QTY, PEND_BUY_QTY, FREE_QTY, OSHR_QTY, PAR_SHR_QTY, TOT_SHRT_POSN, ON_LOAN_QTY, NEW_SECR_FLG, ALL_CLS_OSHR_QTY, ALL_VOTING_OSHR_QTY, ALL_NON_VOTING_OSHR_QTY, VOTING_SHR_IND, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, PRC_SHRS_CLS, PRC_SHRS_ACLS, PRC_SHRS_VOTING, PRC_SHRS_NONVOTING, BREACH_IND_CLS, BREACH_IND_ACLS, BREACH_IND_VOTING, BREACH_IND_NONVOTING, THRSH_BR_CLS, THRSH_BR_ACLS, THRSH_BR_VOTING, THRSH_BR_NONVOTING, NEW_BR_IND_CLS, NEW_BR_IND_ACLS, NEW_BR_IND_VOTING, NEW_BR_IND_NONVOTING, SPEC_ALERT_CLS, SPEC_ALERT_ACLS, SPEC_ALERT_VOTING, SPEC_ALERT_NONVOTING, PROX_INT_BR_CLS, PROX_EXT_BR_CLS, PROX_INT_BR_ACLS, PROX_EXT_BR_ACLS, PROX_INT_BR_VOTING, PROX_EXT_BR_VOTING, PROX_INT_BR_NONVOTING, PROX_EXT_BR_NONVOTING, BREACH_IND_INT_CLS, BREACH_IND_INT_ACLS, BREACH_IND_INT_VOTING, BREACH_IND_INT_NONVOTING, ISSUER_NM, ADR_SPSR_SHIP_TYPE) AS 
SELECT "HOLDG_OPEN_POSN_KEY","FUND_COMPST_KEY","SECR_KEY","INC_CRTY_KEY","ISS_CRTY_KEY","TRDE_CRTY_KEY","THRS_CRTY_KEY","DAY_KEY","TOT_LONG_POSN","ACTL_CSTDY_POSN","PEND_SALE_QTY","PEND_BUY_QTY","FREE_QTY","OSHR_QTY","PAR_SHR_QTY","TOT_SHRT_POSN","ON_LOAN_QTY","NEW_SECR_FLG","ALL_CLS_OSHR_QTY","ALL_VOTING_OSHR_QTY","ALL_NON_VOTING_OSHR_QTY","VOTING_SHR_IND","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","PRC_SHRS_CLS","PRC_SHRS_ACLS","PRC_SHRS_VOTING","PRC_SHRS_NONVOTING","BREACH_IND_CLS","BREACH_IND_ACLS","BREACH_IND_VOTING","BREACH_IND_NONVOTING","THRSH_BR_CLS","THRSH_BR_ACLS","THRSH_BR_VOTING","THRSH_BR_NONVOTING","NEW_BR_IND_CLS","NEW_BR_IND_ACLS","NEW_BR_IND_VOTING","NEW_BR_IND_NONVOTING","SPEC_ALERT_CLS","SPEC_ALERT_ACLS","SPEC_ALERT_VOTING","SPEC_ALERT_NONVOTING","PROX_INT_BR_CLS","PROX_EXT_BR_CLS","PROX_INT_BR_ACLS","PROX_EXT_BR_ACLS","PROX_INT_BR_VOTING","PROX_EXT_BR_VOTING","PROX_INT_BR_NONVOTING","PROX_EXT_BR_NONVOTING","BREACH_IND_INT_CLS","BREACH_IND_INT_ACLS","BREACH_IND_INT_VOTING","BREACH_IND_INT_NONVOTING","ISSUER_NM","ADR_SPSR_SHIP_TYPE" FROM HOLDINGS_OPEN_POSITION
/



CREATE OR REPLACE FORCE VIEW HDM.VW_HOLDINGS_TRADE_HIST(HOLDG_TRDE_HIST_KEY, FUND_COMPST_KEY, BASE_CURRCY_KEY, SECR_KEY, TRDE_DAY_KEY, HOLDG_TXN_CD_KEY, CASH_RSN__KEY, COST_TYPE_KEY, LOC_CURRCY_KEY, STTL_CURRCY_KEY, TRDE_CRTY_KEY, XCHG_TYPE_KEY, INDTRY_KEY, POST_DAY_KEY, STTL_DAY_KEY, SSB_TRDE_ID, LOT_ACCT_NBR, LOT_NBR, ACCT_END_DT, CONTRCTL_STTL_DT, STTL_LOCN_CD, STTL_DLR_ID, STK_XCHG_CITY_CD, SHRT_TERM_SECR_TYPE, EXECTG_DLR_ID, BRKR_RSN_CD, INRT, MTRY_DT, CNCL_FLG, TRDE_FLG, RSTC_FLG, SSB_TRADE_CNCL_ID, POST_TYPE_CD, SHR_QTY, TOT_AMORT_SOLD, ORIG_FACE_MBS_QTY, BASE_INTR_PURCH_SOLD, BASE_NRA_TAX_WHG, BASE_NRA_TAX_REFND, OPT_CONTRCT_UT, STRK_PR, BASE_NET_AMT, BASE_UT_PR, GR_INTR_BTSLD, BASE_TAX, BASE_COMMSN, BASE_FEES, BASE_OTHR_FEES, BASE_ID_COST, BASE_CURR_ID_COST, BASE_AMORT_BKD, XCHGRT, STTL_DT_XCHGRT, BASE_AVG_GLS, BASE_LT_GLS, BASE_SHTM_GLS, BASE_AVG_CURRCY_GLS, BASE_TAX_EXPNS_GLS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "HOLDG_TRDE_HIST_KEY","FUND_COMPST_KEY","BASE_CURRCY_KEY","SECR_KEY","TRDE_DAY_KEY","HOLDG_TXN_CD_KEY","CASH_RSN__KEY","COST_TYPE_KEY","LOC_CURRCY_KEY","STTL_CURRCY_KEY","TRDE_CRTY_KEY","XCHG_TYPE_KEY","INDTRY_KEY","POST_DAY_KEY","STTL_DAY_KEY","SSB_TRDE_ID","LOT_ACCT_NBR","LOT_NBR","ACCT_END_DT","CONTRCTL_STTL_DT","STTL_LOCN_CD","STTL_DLR_ID","STK_XCHG_CITY_CD","SHRT_TERM_SECR_TYPE","EXECTG_DLR_ID","BRKR_RSN_CD","INRT","MTRY_DT","CNCL_FLG","TRDE_FLG","RSTC_FLG","SSB_TRADE_CNCL_ID","POST_TYPE_CD","SHR_QTY","TOT_AMORT_SOLD","ORIG_FACE_MBS_QTY","BASE_INTR_PURCH_SOLD","BASE_NRA_TAX_WHG","BASE_NRA_TAX_REFND","OPT_CONTRCT_UT","STRK_PR","BASE_NET_AMT","BASE_UT_PR","GR_INTR_BTSLD","BASE_TAX","BASE_COMMSN","BASE_FEES","BASE_OTHR_FEES","BASE_ID_COST","BASE_CURR_ID_COST","BASE_AMORT_BKD","XCHGRT","STTL_DT_XCHGRT","BASE_AVG_GLS","BASE_LT_GLS","BASE_SHTM_GLS","BASE_AVG_CURRCY_GLS","BASE_TAX_EXPNS_GLS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Holdings_Trade_Hist
/



CREATE OR REPLACE FORCE VIEW HDM.VW_HOLDINGS_TXN_CODES(HOLDG_TXN_CD_KEY, TXN_TYPE_CD, TXN_TYPE_DESC, TXN_CD, TXN_CD_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "HOLDG_TXN_CD_KEY","TXN_TYPE_CD","TXN_TYPE_DESC","TXN_CD","TXN_CD_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Holdings_TXN_Codes
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INDEX_RETURN(IDX_RET_KEY, PER_KEY, BMK_IDX_KEY, FUND_COMPST_KEY, DAY_KEY, IDX_RET, STRT_PER, ANNLZN_FCTR, RET_PER_FLG, PERF_DISPL_ORD, GEN_RPTG_FLG, DAILY_RPTG_FLG, TRGT_RPTG_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "IDX_RET_KEY","PER_KEY","BMK_IDX_KEY","FUND_COMPST_KEY","DAY_KEY","IDX_RET","STRT_PER","ANNLZN_FCTR","RET_PER_FLG","PERF_DISPL_ORD","GEN_RPTG_FLG","DAILY_RPTG_FLG","TRGT_RPTG_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from index_return
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INDEX_VALUATION(IDX_VLTN_KEY, BMK_IDX_KEY, DAY_KEY, IDX_VLTN_AMT, WLTH_IDX, DAILY_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "IDX_VLTN_KEY","BMK_IDX_KEY","DAY_KEY","IDX_VLTN_AMT","WLTH_IDX","DAILY_RET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from index_valuation
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INDUSTRY(INDTRY_KEY, SCTR_CD, SCTR_DESC, INDTRY_CD, INDTRY_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "INDTRY_KEY","SCTR_CD","SCTR_DESC","INDTRY_CD","INDTRY_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Industry
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INTERMEDIARY_ISSUES(INTRM_ISS_KEY, DAY_KEY, DLR_KEY, INTRM_ISS_TYPE_KEY, ISS_CNT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "INTRM_ISS_KEY","DAY_KEY","DLR_KEY","INTRM_ISS_TYPE_KEY","ISS_CNT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Intermediary_Issues
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INTERMEDIARY_ISSUE_TYPE(INTRM_ISS_TYPE_KEY, INTRM_ISS_TYPE) AS 
SELECT "INTRM_ISS_TYPE_KEY","INTRM_ISS_TYPE" FROM Intermediary_Issue_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INVOICE_TRACKING(INVC_TRCKG_KEY, INVC_TRCKG_SUM_KEY, DLR_FEE_TYPE_KEY, SHR_CLS_CD, SHR_CLS, FEES, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "INVC_TRCKG_KEY","INVC_TRCKG_SUM_KEY","DLR_FEE_TYPE_KEY","SHR_CLS_CD","SHR_CLS","FEES","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Invoice_Tracking
/



CREATE OR REPLACE FORCE VIEW HDM.VW_INVOICE_TRACKING_SUMMARY(INVC_TRCKG_SUM_KEY, DLR_KEY, PMT_DAY_KEY, INVC_TRCKG_ID, INVC_YR, INVC_PER, INVC_RECPT_DT, INVC_TOT_AMT, PMT_TOT_AMT, ANLYST_CMMTS, INVC_ANLYST, INVC_QC1, INVC_QC2, ACCPTBL_VAR, PMT_FREQ, INVC_PER_STRT_DT, INVC_PER_END_DT, MODFR, CREATN_DT, CREATR, CHG_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "INVC_TRCKG_SUM_KEY","DLR_KEY","PMT_DAY_KEY","INVC_TRCKG_ID","INVC_YR","INVC_PER","INVC_RECPT_DT","INVC_TOT_AMT","PMT_TOT_AMT","ANLYST_CMMTS","INVC_ANLYST","INVC_QC1","INVC_QC2","ACCPTBL_VAR","PMT_FREQ","INVC_PER_STRT_DT","INVC_PER_END_DT","MODFR","CREATN_DT","CREATR","CHG_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Invoice_Tracking_Summary
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MANAGER_FINAL_SCORE(FNL_SCOR_KEY, MGR_LIST_KEY, MSR_CAT_KEY, DAY_KEY, UNIV_KEY, YR3_SCOR, YR5_SCOR, YR10_SCOR, YR3_RANK, YR5_RANK, YR10_RANK, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FNL_SCOR_KEY","MGR_LIST_KEY","MSR_CAT_KEY","DAY_KEY","UNIV_KEY","YR3_SCOR","YR5_SCOR","YR10_SCOR","YR3_RANK","YR5_RANK","YR10_RANK","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Manager_Final_Score
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MANAGER_INFORMATION(MGR_INFO_KEY, DAY_KEY, MGR_LIST_KEY, UNIV_KEY, AUM_TOT, FIRM_INCPN_YR, PROD_TOT, PRFRD_BMK, PRIM_UNIV, PROD_STAT, CURR_HOLDG_CNT, PCT_HOLDG_TOP_TEN, ANNL_LTM, CURR_CASH_POSN, WGTA_MKT_CAP, MDN_MKT_CAP, PRIM_EQTY_CAP, PRIM_EQTY_STYL, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MGR_INFO_KEY","DAY_KEY","MGR_LIST_KEY","UNIV_KEY","AUM_TOT","FIRM_INCPN_YR","PROD_TOT","PRFRD_BMK","PRIM_UNIV","PROD_STAT","CURR_HOLDG_CNT","PCT_HOLDG_TOP_TEN","ANNL_LTM","CURR_CASH_POSN","WGTA_MKT_CAP","MDN_MKT_CAP","PRIM_EQTY_CAP","PRIM_EQTY_STYL","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Manager_Information
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MANAGER_LIST(MGR_LIST_KEY, MGR_NM, PROD_NM, IDX_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MGR_LIST_KEY","MGR_NM","PROD_NM","IDX_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Manager_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MANAGER_RANK_DATA(MGR_RANK_DATA_KEY, MGR_LIST_KEY, MSR_LIST_KEY, DAY_KEY, UNIV_KEY, RET_SET, RET_VAL, RET_RANK, RET_DT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MGR_RANK_DATA_KEY","MGR_LIST_KEY","MSR_LIST_KEY","DAY_KEY","UNIV_KEY","RET_SET","RET_VAL","RET_RANK","RET_DT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Manager_Rank_Data
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MDD_CASHFLOW(MDD_CASHFLOW_KEY, REG_KEY, DLR_KEY, FUND_KEY, ACCT_KEY, TRDE_DT_KEY, CONFIRM_DT_KEY, SPR_SHEET_DAY_KEY, SUB_SHRS, SUB_AMT, REDMPN_SHRS, REDMPN_AMT, OFRG_PR, NET_CASHFLOW_AMT, NET_SHRS, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
SELECT "MDD_CASHFLOW_KEY","REG_KEY","DLR_KEY","FUND_KEY","ACCT_KEY","TRDE_DT_KEY","CONFIRM_DT_KEY","SPR_SHEET_DAY_KEY","SUB_SHRS","SUB_AMT","REDMPN_SHRS","REDMPN_AMT","OFRG_PR","NET_CASHFLOW_AMT","NET_SHRS","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" FROM MDD_Cashflow
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MEASURE_CATEGORY(MSR_CAT_KEY, MSR_CAT_DESC, SUB_CAT_DESC, CAT_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MSR_CAT_KEY","MSR_CAT_DESC","SUB_CAT_DESC","CAT_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Measure_Category
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MEASURE_LIST(MSR_LIST_KEY, MSR_CAT_KEY, MSR_ID, MSR_NM, CAT_WGT, YR3_WGT_FLG, YR5_WGT_FLG, YR10_WGT_FLG, RANK_ORD, MSR_GRP, MSR_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MSR_LIST_KEY","MSR_CAT_KEY","MSR_ID","MSR_NM","CAT_WGT","YR3_WGT_FLG","YR5_WGT_FLG","YR10_WGT_FLG","RANK_ORD","MSR_GRP","MSR_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Measure_List
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MONEY_MARKET_ACTIVITY(MONY_MKT_KEY, FUND_KEY, DAY_KEY, GAIN_LOSS_AMT, DSTRBTN_AMT, DIVD_PAYBL_AMT, BASIS_POINTS, DAYS_TO_MTRY, INTR_W_GAIN_LOSS, INTR_WO_GAIN_LOSS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, WEIGHTED_AVG_LIFE, NET_ASSET_AT_COST, NET_ASSET_AT_MKT, INVMT_AT_COST, INVMT_AT_VAL, MKT_BASED_PR, SUB_W_DRV_IN_AMT, REDMPN_AMT, NET_SHRHLDR_CASH_FLOW_AMT, DAILY_LQD_ASSET_AMT, DAILY_LQD_ASSET_RT, WKL_LQD_ASSET_AMT, WKL_LQD_ASSET_RT, SHDW_NAV, CNST_NAV) AS 
select "MONY_MKT_KEY","FUND_KEY","DAY_KEY","GAIN_LOSS_AMT","DSTRBTN_AMT","DIVD_PAYBL_AMT","BASIS_POINTS","DAYS_TO_MTRY","INTR_W_GAIN_LOSS","INTR_WO_GAIN_LOSS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","WEIGHTED_AVG_LIFE","NET_ASSET_AT_COST","NET_ASSET_AT_MKT","INVMT_AT_COST","INVMT_AT_VAL","MKT_BASED_PR","SUB_W_DRV_IN_AMT","REDMPN_AMT","NET_SHRHLDR_CASH_FLOW_AMT","DAILY_LQD_ASSET_AMT","DAILY_LQD_ASSET_RT","WKL_LQD_ASSET_AMT","WKL_LQD_ASSET_RT","SHDW_NAV","CNST_NAV"
  from money_market_activity
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MONTHLY_AVG_POSITION(MTHLY_AVG_POSN_KEY, DLR_KEY, FUND_KEY, DAY_KEY, TOT_SHRS, TOT_BAL_AMT, TOT_AMT_EXCL_TPA, TOT_ELIGBL_BAL, TOT_ELIGBL_EXCL_TPA, DLR_TPA_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "MTHLY_AVG_POSN_KEY","DLR_KEY","FUND_KEY","DAY_KEY","TOT_SHRS","TOT_BAL_AMT","TOT_AMT_EXCL_TPA","TOT_ELIGBL_BAL","TOT_ELIGBL_EXCL_TPA","DLR_TPA_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from monthly_avg_position
/



CREATE OR REPLACE FORCE VIEW HDM.VW_MONTHLY_AVG_POSN_DRAFT(MTHLY_AVG_POSN_DRFT_KEY, DLR_KEY, DAY_KEY, FUND_KEY, TOT_SHRS, TOT_BAL_AMT, TOT_AMT_EXCL_TPA, TOT_ELIGBL_BAL, TOT_ELIGBL_EXCL_TPA, DLR_TPA_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MTHLY_AVG_POSN_DRFT_KEY","DLR_KEY","DAY_KEY","FUND_KEY","TOT_SHRS","TOT_BAL_AMT","TOT_AMT_EXCL_TPA","TOT_ELIGBL_BAL","TOT_ELIGBL_EXCL_TPA","DLR_TPA_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM MONTHLY_AVG_POSN_DRAFT
/



CREATE OR REPLACE FORCE VIEW HDM.VW_OPERATOR(OPR_KEY, DAY_KEY, OPR_ID, FIRST_LOGON_DT, IWS_ACCESS_CD, LAST_LOGON_DT, OPR_SECR_LAST_MAINT, LAST_MAINT_OPR, LOGON_CNT, OPR_EXPN_FLG, OPR_NM, EXPCTD_STRT_DT, LAST_PSWD_RST_DT, PSWD_CHG_DT, PSWD_TRY_CNT, TA3270_ACCESS_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, PARN_OPR_KEY) AS 
select "OPR_KEY","DAY_KEY","OPR_ID","FIRST_LOGON_DT","IWS_ACCESS_CD","LAST_LOGON_DT","OPR_SECR_LAST_MAINT","LAST_MAINT_OPR","LOGON_CNT","OPR_EXPN_FLG","OPR_NM","EXPCTD_STRT_DT","LAST_PSWD_RST_DT","PSWD_CHG_DT","PSWD_TRY_CNT","TA3270_ACCESS_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","PARN_OPR_KEY" from  operator
/



CREATE OR REPLACE FORCE VIEW HDM.VW_OPERATOR_FUNCTION(OPR_FUNC_KEY, DAY_KEY, FAC_KEY, OPR_KEY, AUTHZN_FLG, OPR_FUNC_LAST_MNTN_DT, ADD_FUNC_FLG, BRWS_FUNC_FLG, DEL_FUNC_FLG, UPDT_FUNC_FLG, MINR_ADD_FLG, MINR_BRWS_FLG, MINR_DEL_FLG, MINR_UPDT_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "OPR_FUNC_KEY","DAY_KEY","FAC_KEY","OPR_KEY","AUTHZN_FLG","OPR_FUNC_LAST_MNTN_DT","ADD_FUNC_FLG","BRWS_FUNC_FLG","DEL_FUNC_FLG","UPDT_FUNC_FLG","MINR_ADD_FLG","MINR_BRWS_FLG","MINR_DEL_FLG","MINR_UPDT_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Operator_Function
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PAYMENT_METHOD(PMT_MTHD_KEY, PMT_MTHD_TOP_LVL_CD, PMT_MTHD_TOP_LVL_DESC, PMT_MTHD_CD, PMT_MTHD_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
select "PMT_MTHD_KEY","PMT_MTHD_TOP_LVL_CD","PMT_MTHD_TOP_LVL_DESC","PMT_MTHD_CD","PMT_MTHD_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" from payment_method
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PENDING_ALL_TRADE(PEND_ALL_TRDE_KEY, DLR_KEY, FUND_KEY, ACCT_KEY, TXN_TYPE_KEY, TRDE_DAY_KEY, STTL_DAY_KEY, LOG_DAY_KEY, TXN_REF_ID, GRP_TXN_REF, ENTRY_TYPE, NCA_FLG, RVRS_FLG, TRDE_DELVY_FLG, REP_CD, AFT_HRS_FLG, NSCC_CONFRM_ID, TRDE_SRC, DLN_LEVY, PLN_ID, TXN_PR, GR_CASH_VAL, CB_VAL, TXN_TAX_AMT, SHR_VAL, NET_CASH_VAL, LTST_BATCH_FLG, LOAD_SEQ_NBR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, ROW_UPDT_DTTM) AS 
SELECT "PEND_ALL_TRDE_KEY","DLR_KEY","FUND_KEY","ACCT_KEY","TXN_TYPE_KEY","TRDE_DAY_KEY","STTL_DAY_KEY","LOG_DAY_KEY","TXN_REF_ID","GRP_TXN_REF","ENTRY_TYPE","NCA_FLG","RVRS_FLG","TRDE_DELVY_FLG","REP_CD","AFT_HRS_FLG","NSCC_CONFRM_ID","TRDE_SRC","DLN_LEVY","PLN_ID","TXN_PR","GR_CASH_VAL","CB_VAL","TXN_TAX_AMT","SHR_VAL","NET_CASH_VAL","LTST_BATCH_FLG","LOAD_SEQ_NBR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","ROW_UPDT_DTTM" FROM Pending_All_Trade
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PENDING_TRADE(PEND_TRDE_KEY, DLR_KEY, FUND_KEY, ACCT_KEY, TXN_TYPE_KEY, TRDE_DAY_KEY, STTL_DAY_KEY, LOG_DAY_KEY, TXN_REF_ID, GRP_TXN_REF, ENTRY_TYPE, NCA_FLG, RVRS_FLG, TRDE_DELVY_FLG, REP_CD, AFT_HRS_FLG, NSCC_CONFRM_ID, TRDE_SRC, DLN_LEVY, PLN_ID, TXN_PR, GR_CASH_VAL, CB_VAL, TXN_TAX_AMT, SHR_VAL, NET_CASH_VAL, LTST_BATCH_FLG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, LOAD_SEQ_NBR) AS 
select "PEND_TRDE_KEY","DLR_KEY","FUND_KEY","ACCT_KEY","TXN_TYPE_KEY","TRDE_DAY_KEY","STTL_DAY_KEY","LOG_DAY_KEY","TXN_REF_ID","GRP_TXN_REF","ENTRY_TYPE","NCA_FLG","RVRS_FLG","TRDE_DELVY_FLG","REP_CD","AFT_HRS_FLG","NSCC_CONFRM_ID","TRDE_SRC","DLN_LEVY","PLN_ID","TXN_PR","GR_CASH_VAL","CB_VAL","TXN_TAX_AMT","SHR_VAL","NET_CASH_VAL","LTST_BATCH_FLG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","LOAD_SEQ_NBR" from pending_trade
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PERF_RUN_TYPE(PERF_RUN_TYPE_KEY, RUN_TYPE_CD, RUN_TYPE_DESC) AS 
SELECT "PERF_RUN_TYPE_KEY", "RUN_TYPE_CD", "RUN_TYPE_DESC"
     FROM Perf_Run_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_ACCOUNT_REFERENCE(PMC_ACCT_REF_KEY, FUND_COMPST_KEY, PMC_ACCT_NBR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMC_ACCT_REF_KEY","FUND_COMPST_KEY","PMC_ACCT_NBR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Account_Reference
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_COUNTRY_BREAKOUT(CRTY_BRK_OUT_KEY, FUND_COMPST_KEY, PMC_REG_KEY, DAY_KEY, ACCT_EXT_DUR_YR, ACCT_EXT_EM_SPRD, ACCT_LOC_DUR_YR, ACCT_CURR_EXPSR, BMK_EXT_DUR_YR, BMK_EXT_EM_SPRD, BMK_LOC_DUR_YR, BMK_CURR_EXPSR, VAR_EXT_DUR_YR, VAR_EXT_EM_SPRD, VAR_LOC_DUR_YR, VAR_CURR_EXPSR, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "CRTY_BRK_OUT_KEY","FUND_COMPST_KEY","PMC_REG_KEY","DAY_KEY","ACCT_EXT_DUR_YR","ACCT_EXT_EM_SPRD","ACCT_LOC_DUR_YR","ACCT_CURR_EXPSR","BMK_EXT_DUR_YR","BMK_EXT_EM_SPRD","BMK_LOC_DUR_YR","BMK_CURR_EXPSR","VAR_EXT_DUR_YR","VAR_EXT_EM_SPRD","VAR_LOC_DUR_YR","VAR_CURR_EXPSR","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Country_Breakout
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_DERIVATIVES(DERVTV_KEY, DERVTV_BUCKT_KEY, DAY_KEY, FUND_COMPST_KEY, NTIONAL_AMT, MKT_VAL, MKT_VAL_PCT, DUR_PCT, DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DERVTV_KEY","DERVTV_BUCKT_KEY","DAY_KEY","FUND_COMPST_KEY","NTIONAL_AMT","MKT_VAL","MKT_VAL_PCT","DUR_PCT","DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Derivatives
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_DERIVATIVE_BUCKET(DERVTV_BUCKT_KEY, DERVTV_BUCKT_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DERVTV_BUCKT_KEY","DERVTV_BUCKT_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Derivative_Bucket
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_DURATION_BREAKOUT(PMC_DUR_BRK_OUT_KEY, DUR_BUCKT_KEY, FUND_COMPST_KEY, DAY_KEY, ACCT_DUR_PCT, ACCT_DWE, BMK_DUR_PCT, BMK_DWE, VAR_DUR_PCT, VAR_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMC_DUR_BRK_OUT_KEY","DUR_BUCKT_KEY","FUND_COMPST_KEY","DAY_KEY","ACCT_DUR_PCT","ACCT_DWE","BMK_DUR_PCT","BMK_DWE","VAR_DUR_PCT","VAR_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Duration_Breakout
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_DURATION_BUCKET(DUR_BUCKT_KEY, DUR_BUCKT_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "DUR_BUCKT_KEY","DUR_BUCKT_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Duration_Bucket
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MATURITY_BREAKOUT(MTRY_BRK_OUT_KEY, PMC_MTRY_BUCKT_KEY, FUND_COMPST_KEY, DAY_KEY, ACCT_MKT_VAL, ACCT_MKT_VAL_PCT, BMK_MKT_VAL_PCT, VAR_MKT_VAL_PCT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MTRY_BRK_OUT_KEY","PMC_MTRY_BUCKT_KEY","FUND_COMPST_KEY","DAY_KEY","ACCT_MKT_VAL","ACCT_MKT_VAL_PCT","BMK_MKT_VAL_PCT","VAR_MKT_VAL_PCT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Maturity_Breakout
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MATURITY_BUCKET(PMC_MTRY_BUCKT_KEY, MTRY_BUCKT_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, MTRY_BUCKT_TYPE) AS 
select "PMC_MTRY_BUCKT_KEY","MTRY_BUCKT_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","MTRY_BUCKT_TYPE" from pimco_maturity_bucket
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MKT_COMMODITY(MKT_CMDTY_KEY, PMC_SCTR_KEY, FUND_COMPST_KEY, DAY_KEY, BMK_MKT_VAL_PCT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MKT_CMDTY_KEY","PMC_SCTR_KEY","FUND_COMPST_KEY","DAY_KEY","BMK_MKT_VAL_PCT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_MKT_Commodity
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MKT_COUNTRY(MKT_CNTR_KEY, CRTY_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MKT_CNTR_KEY","CRTY_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Mkt_Country
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MKT_MATURITY(MKTG_MTRY_KEY, DAY_KEY, FUND_COMPST_KEY, PMC_MTRY_BUCKT_KEY, FUND_MTRY, BMK_MTRY, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MKTG_MTRY_KEY","DAY_KEY","FUND_COMPST_KEY","PMC_MTRY_BUCKT_KEY","FUND_MTRY","BMK_MTRY","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_MKT_Maturity
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MKT_QUALITY(MKT_QUAL_KEY, DAY_KEY, FUND_COMPST_KEY, PMC_QUAL_BUCKT_KEY, FUND_QUAL_RTNG, BMK_QUAL_RTNG, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MKT_QUAL_KEY","DAY_KEY","FUND_COMPST_KEY","PMC_QUAL_BUCKT_KEY","FUND_QUAL_RTNG","BMK_QUAL_RTNG","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_MKT_Quality
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_MKT_SURVEY(MKT_SRVY_KEY, DAY_KEY, FUND_COMPST_KEY, MKT_CNTR_KEY, FUND_CRTY_PCT, FUND_CURRCY_PCT, BMK_CRTY_PCT, BMK_CURRCY_PCT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "MKT_SRVY_KEY","DAY_KEY","FUND_COMPST_KEY","MKT_CNTR_KEY","FUND_CRTY_PCT","FUND_CURRCY_PCT","BMK_CRTY_PCT","BMK_CURRCY_PCT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_MKT_Survey
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_QUALITY_BREAKOUT(QUAL_BRK_OUT_KEY, PMC_QUAL_BUCKT_KEY, FUND_COMPST_KEY, DAY_KEY, ACCT_EXPSR_AMT, ACCT_EXPSR_PCT, ACCT_DUR_PCT, ACCT_DWE, BMK_EXPSR_PCT, BMK_DUR_PCT, BMK_DWE, VAR_EXPSR_PCT, VAR_DUR_PCT, VAR_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "QUAL_BRK_OUT_KEY","PMC_QUAL_BUCKT_KEY","FUND_COMPST_KEY","DAY_KEY","ACCT_EXPSR_AMT","ACCT_EXPSR_PCT","ACCT_DUR_PCT","ACCT_DWE","BMK_EXPSR_PCT","BMK_DUR_PCT","BMK_DWE","VAR_EXPSR_PCT","VAR_DUR_PCT","VAR_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Quality_Breakout
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_QUALITY_BUCKET(PMC_QUAL_BUCKT_KEY, QUAL_BUCKT_NM, QUAL_SORT_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, QUAL_BUCKT_TYPE) AS 
select "PMC_QUAL_BUCKT_KEY","QUAL_BUCKT_NM","QUAL_SORT_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","QUAL_BUCKT_TYPE" from pimco_quality_bucket
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_REGION(PMC_REG_KEY, MKT_TYPE_DESC, REG_CD, REG_DESC, CRTY_ID, CRTY_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMC_REG_KEY","MKT_TYPE_DESC","REG_CD","REG_DESC","CRTY_ID","CRTY_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Region
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_SECTOR(PMC_SCTR_KEY, SCTR_TYPE, SCTR_LVL_DESC, SCTR_SUB_LVL_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PMC_SCTR_KEY","SCTR_TYPE","SCTR_LVL_DESC","SCTR_SUB_LVL_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Sector
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_SECTOR_BREAKOUT(SCTR_BRK_OUT_KEY, PMC_SCTR_KEY, FUND_COMPST_KEY, DAY_KEY, ACCT_MKT_VAL, ACCT_MKT_VAL_PCT, ACCT_DUR_PCT, ACCT_DWE, BMK_MKT_VAL_PCT, BMK_DUR_PCT, BMK_DWE, VAR_MKT_VAL_PCT, VAR_DUR_PCT, VAR_DWE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SCTR_BRK_OUT_KEY","PMC_SCTR_KEY","FUND_COMPST_KEY","DAY_KEY","ACCT_MKT_VAL","ACCT_MKT_VAL_PCT","ACCT_DUR_PCT","ACCT_DWE","BMK_MKT_VAL_PCT","BMK_DUR_PCT","BMK_DWE","VAR_MKT_VAL_PCT","VAR_DUR_PCT","VAR_DWE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM PIMCO_Sector_Breakout
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PIMCO_STATISTICS(PMC_STATS_KEY, DAY_KEY, FUND_COMPST_KEY, MKT_VAL, QTRLY_CONTRBN, EST_INCM, EST_YTM, EFFTV_DUR, AVG_MTRY, AVG_QUAL, AVG_COUPN, CURR_YLD, BMK_AVG_QUAL, BMK_EFFTV_DUR, BMK_CURR_YLD, BMK_PMC_DUR, BMK_EST_YTM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, TOT_NET_ASSET, FINC_ASSET, NET_ASSET_N_CASH, FUND_ISS_CNT, BMK_ISS_CNT, BMK_AVG_MKT_COUPN, BMK_WGTA_MTRY) AS 
SELECT "PMC_STATS_KEY","DAY_KEY","FUND_COMPST_KEY","MKT_VAL","QTRLY_CONTRBN","EST_INCM","EST_YTM","EFFTV_DUR","AVG_MTRY","AVG_QUAL","AVG_COUPN","CURR_YLD","BMK_AVG_QUAL","BMK_EFFTV_DUR","BMK_CURR_YLD","BMK_PMC_DUR","BMK_EST_YTM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","TOT_NET_ASSET","FINC_ASSET","NET_ASSET_N_CASH","FUND_ISS_CNT","BMK_ISS_CNT","BMK_AVG_MKT_COUPN","BMK_WGTA_MTRY" FROM PIMCO_Statistics
/



CREATE OR REPLACE FORCE VIEW HDM.VW_POSITION_TYPE(POSN_TYPE_KEY, POSN_CD, POSN_DESC) AS 
SELECT "POSN_TYPE_KEY","POSN_CD","POSN_DESC" FROM Position_Type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_PRO_EXPENSE_RATIO(PRO_EXPNS_RATIO_KEY, DAY_KEY, FUND_KEY, GR_EXPNS_RATIO, NET_EXPNS_RATIO, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PRO_EXPNS_RATIO_KEY","DAY_KEY","FUND_KEY","GR_EXPNS_RATIO","NET_EXPNS_RATIO","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Pro_Expense_Ratio
/



CREATE OR REPLACE FORCE VIEW HDM.VW_REASON_CODE(RSN_KEY, ENTITY_RSN_CD, ENTITY_DESC, RSN_CD, RSN_SHRT_DESC, RSN_LONG_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CURR_ROW_FLG) AS 
SELECT    
   RSN_KEY,
   ENTITY_RSN_CD  , 
   ENTITY_DESC ,
   RSN_CD,
   RSN_SHRT_DESC,
   RSN_LONG_DESC,
   ROW_STRT_DTTM,
   ROW_STOP_DTTM,
   ETL_LOAD_CYC_KEY,
   SRC_SYS_ID,
   CURR_ROW_FLG
     FROM Reason_Code
/



CREATE OR REPLACE FORCE VIEW HDM.VW_REGION(REG_KEY, ST_CD, ST_NM, MKTG_REG_ID, MKTG_REG_NM, CRTY_CD, CRTY_NM, GLBL_REG_CD, GLBL_REG_NM, REG_TYPE_CD, REG_TYPE_NM, TOP_LVL_REG_CD, TOP_LVL_REG_NM, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CURR_ROW_FLG) AS 
SELECT "REG_KEY","ST_CD","ST_NM","MKTG_REG_ID","MKTG_REG_NM","CRTY_CD","CRTY_NM","GLBL_REG_CD","GLBL_REG_NM","REG_TYPE_CD","REG_TYPE_NM","TOP_LVL_REG_CD","TOP_LVL_REG_NM","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","CURR_ROW_FLG" FROM Region
/



CREATE OR REPLACE FORCE VIEW HDM.VW_REPORT_FILTERS(FILTR_TYPE, FILTR_VAL, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, FILTR_EMP_VAL, TRSTE_FLG, OFFR_FLG) AS 
select "FILTR_TYPE","FILTR_VAL","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","FILTR_EMP_VAL","TRSTE_FLG","OFFR_FLG" from report_filters
/



CREATE OR REPLACE FORCE VIEW HDM.VW_RETURN_PERIODS(PER_KEY, PER_NM, PER_DESC, PER_UT, PER_MSR, ANNL_FCTR, DAILY_MSR_FLG, MO_END_MSR_FLG, PER_SORT_ORD, FULL_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "PER_KEY",
          "PER_NM",
          "PER_DESC",
          "PER_UT",
          "PER_MSR",
          "ANNL_FCTR",
          "DAILY_MSR_FLG",
          "MO_END_MSR_FLG",
          "PER_SORT_ORD",
          "FULL_DESC",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID"
     FROM Return_Periods
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SDCM_CASHFLOW(SDCM_CASHFLOW_KEY, REG_KEY, PMT_MTHD_KEY, DLR_KEY, SHRHLDR_KEY, ACCT_KEY, FUND_KEY, SPR_SHEET_DT_KEY, TRDE_DT_KEY, CONFIRM_DT_KEY, SHRHLDR_ROLE_KEY, ACCT_NBR, SUB_SHRS, SUB_AMT, REDMPN_SHRS, REDMPN_AMT, OFRG_PR, NAV, DLR_COMMSN_AMT, UNDR_WRTR_COMMSN_AMT, ADV_COMMSN_AMT, NET_SHRS, NET_CASHFLOW_AMT, CASH_CNTL_RECON_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
select "SDCM_CASHFLOW_KEY","REG_KEY","PMT_MTHD_KEY","DLR_KEY","SHRHLDR_KEY","ACCT_KEY","FUND_KEY","SPR_SHEET_DT_KEY","TRDE_DT_KEY","CONFIRM_DT_KEY","SHRHLDR_ROLE_KEY","ACCT_NBR","SUB_SHRS","SUB_AMT","REDMPN_SHRS","REDMPN_AMT","OFRG_PR","NAV","DLR_COMMSN_AMT","UNDR_WRTR_COMMSN_AMT","ADV_COMMSN_AMT","NET_SHRS","NET_CASHFLOW_AMT","CASH_CNTL_RECON_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" from sdcm_cashflow
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SDCM_FUND_BALANCE(FUND_BAL_KEY, FUND_KEY, DAY_KEY, TOT_FUND_SHRS, TOT_FUND_ASSET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_BAL_KEY","FUND_KEY","DAY_KEY","TOT_FUND_SHRS","TOT_FUND_ASSET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SDCM_Fund_Balance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SECURITY(SECR_KEY, SEDOL_ID, ISIN_ID, TCKR_SYM, SECR_NM, ISSUER_NM, GLBL_ISSUER_NM, INVMT_TYPE_CD, INVMT_TYPE_DESC, DTC_CUSIP, ASSET_ID, MUNCPL_SECR_ST_CD, MUNCPL_SECR_ST, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
select "SECR_KEY","SEDOL_ID","ISIN_ID","TCKR_SYM","SECR_NM","ISSUER_NM","GLBL_ISSUER_NM","INVMT_TYPE_CD","INVMT_TYPE_DESC","DTC_CUSIP","ASSET_ID","MUNCPL_SECR_ST_CD","MUNCPL_SECR_ST","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" from security
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SECURITY_ATTRIBUTES(SECR_ATTR_KEY, ASSET_ID, SSB_FUND_NBR, LOT_ACCT_NBR, SECR_TYPE, CUSIP_ID, CASH_ID, SPOT_ID, FWD_ID, SHRT_TERM_PURCH_DT, SHRT_TERM_STTL_DT, ORIG_ISS_DT, MTRY_DT, MOODY_RTNG, S_P_RTNG, CALL_PUT_IND, REPO_NBR, SSB_TRDE_ID, FX_BRKR_CD, RPT_CLS_CD, RPT_CLS_DESC, ISS_CLS_CD, ISS_CLS_DESC, NBR_OF_CONTRCT, ORIG_FACE_AMT, FX_CLOSG_IND, INVMT_IND, INVMT_DESC, ASSET_GRP_CD, ASSET_GRP_DESC, INVMT_MKT_VAL_FLG, MKT_VAL_CD, MKT_VAL_DESC, POSN_TYPE_CD, POSN_TYPE_DESC, ORIG_COUPN_RT, VARB_RT_FREQ_CD, VARB_RT_FREQ_DESC, VARB_RT_CHG_DT, MKT_PR_SRC_CD, MKT_PR_SRC_VEND, MKT_PR_SRC_DESC, POOL_TYPE_CD, POOL_TYPE_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SECR_ATTR_KEY","ASSET_ID","SSB_FUND_NBR","LOT_ACCT_NBR","SECR_TYPE","CUSIP_ID","CASH_ID","SPOT_ID","FWD_ID","SHRT_TERM_PURCH_DT","SHRT_TERM_STTL_DT","ORIG_ISS_DT","MTRY_DT","MOODY_RTNG","S_P_RTNG","CALL_PUT_IND","REPO_NBR","SSB_TRDE_ID","FX_BRKR_CD","RPT_CLS_CD","RPT_CLS_DESC","ISS_CLS_CD","ISS_CLS_DESC","NBR_OF_CONTRCT","ORIG_FACE_AMT","FX_CLOSG_IND","INVMT_IND","INVMT_DESC","ASSET_GRP_CD","ASSET_GRP_DESC","INVMT_MKT_VAL_FLG","MKT_VAL_CD","MKT_VAL_DESC","POSN_TYPE_CD","POSN_TYPE_DESC","ORIG_COUPN_RT","VARB_RT_FREQ_CD","VARB_RT_FREQ_DESC","VARB_RT_CHG_DT","MKT_PR_SRC_CD","MKT_PR_SRC_VEND","MKT_PR_SRC_DESC","POOL_TYPE_CD","POOL_TYPE_DESC","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Security_Attributes
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SECURITY_LATEST(SECR_KEY, SEDOL_ID, ISIN_ID, TCKR_SYM, SECR_NM, ISSUER_NM, GLBL_ISSUER_NM, INVMT_TYPE_CD, INVMT_TYPE_DESC, DTC_CUSIP, ASSET_ID, MUNCPL_SECR_ST_CD, MUNCPL_SECR_ST, CURR_ROW_FLG, ASSET_GRP_CD, ASSET_GRP_DESC) AS 
SELECT DISTINCT s."SECR_KEY",
                   s."SEDOL_ID",
                   s."ISIN_ID",
                   s."TCKR_SYM",
                   s."SECR_NM",
                   s."ISSUER_NM",
                   s."GLBL_ISSUER_NM",
                   s."INVMT_TYPE_CD",
                   s."INVMT_TYPE_DESC",
                   s."DTC_CUSIP",
                   s."ASSET_ID",
                   s."MUNCPL_SECR_ST_CD",
                   s."MUNCPL_SECR_ST",
                   s."CURR_ROW_FLG",
                   sa.asset_grp_cd,
                   sa.asset_grp_desc
     FROM hdm.vw_security s,
          hdm.vw_security_attributes sa,
          hdm.vw_fund_holdings h,
          hdm.vw_calendar c
    WHERE     s.secr_key = h.secr_key
          AND h.secr_attr_key = sa.secr_attr_key
          AND h.day_key = c.day_key
          AND c.cal_day = (SELECT MAX (cal_day)
                             FROM hdm.vw_fund_holdings h, hdm.vw_calendar c
                            WHERE c.day_key = h.day_key)
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SHAREHOLDER(SHRHLDR_KEY, SHRHLDR_ROLE_KEY, SHRHLDR_TOP_LVL_CD, SHRHLDR_TOP_LVL_DESC, SHRHLDR_NM, TAX_IDNFCN_NBR, SSN_STAT_DESC, TAX_IDNFCN_TYPE, CUST_LGL_OWNR_REGSTN_DT, CUST_IDNFCN_NBR, CUST_IDNFCN_NBR_2, VIP_CUST_FLG, SEND_MKTG_INFO_FLG, INFORMED_CNSNT_FLG, PARTY_TYPE, CUST_EMPL_FLG, MGMT_CO_EMPL_FLG, LGL_STAT, GEND, BRTH_DT, DCSD_DT, EMPLMT_STAT, MRTL_STAT, CRTY_OF_CITZN_SHIP, ADDR_TYPE, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, ADDR_LINE_4, CITY, ST, PROV, CRTY, REG, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, ETL_LOAD_CYC_KEY, SRC_SYS_ID, PURG_PRCSD_FLG, PURG_PRCSD_DT) AS 
select "SHRHLDR_KEY","SHRHLDR_ROLE_KEY","SHRHLDR_TOP_LVL_CD","SHRHLDR_TOP_LVL_DESC","SHRHLDR_NM","TAX_IDNFCN_NBR","SSN_STAT_DESC","TAX_IDNFCN_TYPE","CUST_LGL_OWNR_REGSTN_DT","CUST_IDNFCN_NBR","CUST_IDNFCN_NBR_2","VIP_CUST_FLG","SEND_MKTG_INFO_FLG","INFORMED_CNSNT_FLG","PARTY_TYPE","CUST_EMPL_FLG","MGMT_CO_EMPL_FLG","LGL_STAT","GEND","BRTH_DT","DCSD_DT","EMPLMT_STAT","MRTL_STAT","CRTY_OF_CITZN_SHIP","ADDR_TYPE","ADDR_LINE_1","ADDR_LINE_2","ADDR_LINE_3","ADDR_LINE_4","CITY","ST","PROV","CRTY","REG","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","ETL_LOAD_CYC_KEY","SRC_SYS_ID","PURG_PRCSD_FLG","PURG_PRCSD_DT"
from shareholder
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SHAREHOLDER_DISTRIB(SHRHLDR_DSTRBTN_KEY, ACCT_KEY, SHRHLDR_KEY, FUND_KEY, DSTRBTN_CD_KEY, DSTRBTN_TYPE_KEY, REC_DAY_KEY, PAYBL_DAY_KEY, RE_INVST_DAY_KEY, DSTRBTN_RT_PER_SHR, FUND_EXPNS_RATIO, RE_INVMT_SHR_PR, PNLTY_W_HOLDING_RT, DIVD_TYPE, LTCG_FLG, FUND_EXPNS_AMT, FUND_EXPNS_ALLOCN_CD, SHR_RE_INVSTD, SHR_BAL_AFT_DSTRBTN, SHRS_ISSD, DSTRBTN_AMT, SUB_ACCTG_FEE, OTHR_FEES, FORGN_TAX_W_HOLDING_RT, FORGN_TAX_W_HOLDING_AMT, US_W_HOLDING_AMT, NRA_WHG_AMT, CUM_DISCNT_NBR, EXT_PLN_ID, WIRE_TXN_GRP, BAL_IND, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SHRHLDR_DSTRBTN_KEY","ACCT_KEY","SHRHLDR_KEY","FUND_KEY","DSTRBTN_CD_KEY","DSTRBTN_TYPE_KEY","REC_DAY_KEY","PAYBL_DAY_KEY","RE_INVST_DAY_KEY","DSTRBTN_RT_PER_SHR","FUND_EXPNS_RATIO","RE_INVMT_SHR_PR","PNLTY_W_HOLDING_RT","DIVD_TYPE","LTCG_FLG","FUND_EXPNS_AMT","FUND_EXPNS_ALLOCN_CD","SHR_RE_INVSTD","SHR_BAL_AFT_DSTRBTN","SHRS_ISSD","DSTRBTN_AMT","SUB_ACCTG_FEE","OTHR_FEES","FORGN_TAX_W_HOLDING_RT","FORGN_TAX_W_HOLDING_AMT","US_W_HOLDING_AMT","NRA_WHG_AMT","CUM_DISCNT_NBR","EXT_PLN_ID","WIRE_TXN_GRP","BAL_IND","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Shareholder_Distrib
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SHDR_ACCT_FUND(ACCT_KEY, FUND_KEY, DLR_KEY, DLR_BRANCH_KEY, SHRHLDR_KEY, REG_KEY, PRIM_SHRHLDR_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, CURR_ROW_FLG) AS 
SELECT   "ACCT_KEY",
            "FUND_KEY",
            "DLR_KEY",
            "DLR_BRANCH_KEY",
            "SHRHLDR_KEY",
            "REG_KEY",
            "PRIM_SHRHLDR_FLG",
            "ROW_STRT_DTTM",
            "ROW_STOP_DTTM",
            "ETL_LOAD_CYC_KEY",
            "SRC_SYS_ID",
            "CURR_ROW_FLG"
     FROM   SHDR_ACCT_FUND
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_FUND_PARAMETERS(FUND_PARM_KEY, FUND_KEY, MIN_OTST_PERF_LVL) AS 
SELECT "FUND_PARM_KEY","FUND_KEY","MIN_OTST_PERF_LVL" FROM SMIP_Fund_Parameters
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_FUND_PERFORMANCE(SMIP_FUND_PERF_KEY, SMIP_MTRIC_KEY, DAY_KEY, FUND_KEY, OUT_PERF_BASIS_PT, WGT_NET_OUT_PERF, WGT_MIN_OTST_PERF, FUND_PEER_GRP_QNTL_RANK, IDX_PEER_GRP_QNTL_RANK, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SMIP_FUND_PERF_KEY","SMIP_MTRIC_KEY","DAY_KEY","FUND_KEY","OUT_PERF_BASIS_PT","WGT_NET_OUT_PERF","WGT_MIN_OTST_PERF","FUND_PEER_GRP_QNTL_RANK","IDX_PEER_GRP_QNTL_RANK","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SMIP_Fund_Performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_FUND_PERF_LEVEL(FUND_PERF_LVL_KEY, FUND_KEY, MIN_PERF_RT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "FUND_PERF_LVL_KEY","FUND_KEY","MIN_PERF_RT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SMIP_Fund_Perf_Level
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_GROUP_TRUST_PERF(GRP_TRST_PERF_KEY, SMIP_MTRIC_KEY, DAY_KEY, GRP_TRST_PERF, BMK_PERF, PERF_DIFF, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "GRP_TRST_PERF_KEY","SMIP_MTRIC_KEY","DAY_KEY","GRP_TRST_PERF","BMK_PERF","PERF_DIFF","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SMIP_Group_Trust_Perf
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_METRICS(SMIP_MTRIC_KEY, MTRIC_CD, MTRIC_NM, MTRIC_WGT, PER_NM, PER_WGT, PER_KEY, EXPCTD_PERF, ABNML_THRS, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SMIP_MTRIC_KEY","MTRIC_CD","MTRIC_NM","MTRIC_WGT","PER_NM","PER_WGT","PER_KEY","EXPCTD_PERF","ABNML_THRS","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SMIP_Metrics
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_PERFORMANCE(SMIP_PERF_KEY, SMIP_MTRIC_KEY, DAY_KEY, FUND_CNT, PERFM_FUND_CNT, PERFM_FUND_PCTG, PERF_VAR_PCTG, MIN_OTST_PERF, WGT_PERF_PCTG, OUT_PERF_BASIS_PT, WGT_NET_OUT_PERF, FUND_THRS_BMK_CNT, FUND_THRS_BMK_PCT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, FUND_MEET_BMK_CNT, FUND_MEET_BMK_PCT, QNTL_AVG_PCT, AVG_ACTL_PERF_PCT, QNTL_WGT_PERF) AS 
select "SMIP_PERF_KEY","SMIP_MTRIC_KEY","DAY_KEY","FUND_CNT","PERFM_FUND_CNT","PERFM_FUND_PCTG","PERF_VAR_PCTG","MIN_OTST_PERF","WGT_PERF_PCTG","OUT_PERF_BASIS_PT","WGT_NET_OUT_PERF","FUND_THRS_BMK_CNT","FUND_THRS_BMK_PCT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID","FUND_MEET_BMK_CNT","FUND_MEET_BMK_PCT","QNTL_AVG_PCT","AVG_ACTL_PERF_PCT","QNTL_WGT_PERF" from smip_performance
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SMIP_QUINTILE_PERF(SMIP_QUNITILE_PERF_KEY, SMIP_MTRIC_KEY, FUND_KEY, BMK_IDX_KEY, DAY_KEY, FUND_RET, IDX_RET, FUND_PEER_GRP_RANK, IDX_PEER_GRP_RANK, FUND_PEER_GRP_QNTL, IDX_PEER_GRP_QNTL, PEER_GRP_AVG, PEER_GRP_CNT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "SMIP_QUNITILE_PERF_KEY","SMIP_MTRIC_KEY","FUND_KEY","BMK_IDX_KEY","DAY_KEY","FUND_RET","IDX_RET","FUND_PEER_GRP_RANK","IDX_PEER_GRP_RANK","FUND_PEER_GRP_QNTL","IDX_PEER_GRP_QNTL","PEER_GRP_AVG","PEER_GRP_CNT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM SMIP_Quintile_Perf
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SOCIAL_SECURITY_STATUS(SSN_STAT_KEY, SSN_STAT_CD, SSN_STAT_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
SELECT "SSN_STAT_KEY","SSN_STAT_CD","SSN_STAT_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" FROM Social_Security_Status
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SUBSEQUENT_MIN_POSITIONS(DATA_SOURCE, ACCT_NBR, ACCT_STAT, REGSTN_LINE_1, DLR_LVL_CNTL_CD, DLR_LVL_CNTL_DESC, FUND_NBR, FUND_SORT_ORD, COMPST_NM, AMT, REG_ACCT_INIT_INVMT, CAL_DAY, CUSTODIAN_ID) AS 
SELECT   'Acct Position' AS Data_Source,
            HDM.VW_CURRENT_ACCOUNT.ACCT_NBR,
            HDM.VW_CURRENT_ACCOUNT.ACCT_STAT,
            HDM.VW_CURRENT_ACCOUNT.REGSTN_LINE_1,
            HDM.VW_CURRENT_ACCOUNT.DLR_LVL_CNTL_CD,
            HDM.VW_CURRENT_ACCOUNT.DLR_LVL_CNTL_DESC,
            HDM.VW_FUND.FUND_NBR,
            HDM.VW_FUND.FUND_SORT_ORD,
            HDM.VW_FUND_COMPOSITE.COMPST_NM,
            HDM.VW_ACCOUNT_POSITION.TOT_BAL_AMT Amt,
            HDM.VW_FUND.REG_ACCT_INIT_INVMT,
            HDM.VW_CALENDAR.CAL_DAY,
            HDM.VW_CURRENT_ACCOUNT.CUSTODIAN_ID
     FROM   HDM.VW_CURRENT_ACCOUNT,
            HDM.VW_FUND,
            HDM.VW_FUND_COMPOSITE,
            HDM.VW_ACCOUNT_POSITION,
            HDM.VW_CALENDAR,
            HDM.VW_DEALER
    WHERE       (HDM.VW_ACCOUNT_POSITION.DLR_KEY = HDM.VW_DEALER.DLR_KEY)
            AND (HDM.VW_ACCOUNT_POSITION.DAY_KEY = HDM.VW_CALENDAR.DAY_KEY)
            AND (HDM.VW_FUND.FUND_KEY = HDM.VW_ACCOUNT_POSITION.FUND_KEY)
            AND (HDM.VW_CURRENT_ACCOUNT.ACCT_NBR =
                    HDM.VW_ACCOUNT_POSITION.ACCT_NBR
                 AND HDM.VW_CURRENT_ACCOUNT.FUND_NBR =
                       HDM.VW_ACCOUNT_POSITION.FUND_NBR)
            AND (HDM.VW_FUND.FUND_COMPST_KEY =
                    HDM.VW_FUND_COMPOSITE.FUND_COMPST_KEY)
            AND              --subquery to constrain for TWO business days ago
               HDM.VW_CALENDAR.DAY_KEY =
                  (SELECT   DAY_KEY
                     FROM   VW_CALENDAR
                    WHERE   CAL_DAY =
                               (SELECT   MAX (cal_day)
                                  FROM   vw_calendar
                                 WHERE   VW_CALENDAR.BUS_DAY_FLG = 'Y'
                                         AND cal_day <
                                               (SELECT   MAX (cal_day)
                                                  FROM   vw_calendar
                                                 WHERE   CAL_DAY BETWEEN (TRUNC(SYSDATE)
                                                                          - 7)
                                                                     AND  TRUNC(SYSDATE
                                                                                - 1)
                                                         AND BUS_DAY_FLG =
                                                               'Y')))
            AND HDM.VW_CURRENT_ACCOUNT.DLR_LVL_CNTL_CD <> 3
            AND HDM.VW_FUND.SHR_CLS_DESC = 'Institutional Class'
            AND HDM.VW_CURRENT_ACCOUNT.ACCT_STAT <> 'Closed Status '
            AND HDM.VW_DEALER.DLR_ID = '5471'
            AND TO_CHAR (HDM.VW_CURRENT_ACCOUNT.ACCT_NBR)
               || TO_CHAR (HDM.VW_CURRENT_ACCOUNT.FUND_NBR) IN
                     ( --filter for who had a transaction ONE business day ago
                      SELECT    TO_CHAR (HDM.VW_CURRENT_ACCOUNT.ACCT_NBR)
                                || TO_CHAR (HDM.VW_CURRENT_ACCOUNT.FUND_NBR)
                                   AS ACCT_NBR_w_FUND_NBR
                         FROM   HDM.VW_CURRENT_ACCOUNT,
                                HDM.VW_FUND,
                                HDM.VW_FUND_COMPOSITE,
                                HDM.VW_FUND_TRANS_HIST TRAN,
                                HDM.VW_CALENDAR,
                                HDM.VW_DEALER
                        WHERE       (TRAN.FUND_KEY = HDM.VW_FUND.FUND_KEY)
                                AND (TRAN.DLR_KEY = HDM.VW_DEALER.DLR_KEY)
                                AND (TRAN.STTL_DAY_KEY = vw_CALENDAR.DAY_KEY)
                                AND (HDM.VW_CURRENT_ACCOUNT.ACCT_NBR =
                                        TRAN.ACCT_NBR)
                                AND (HDM.VW_CURRENT_ACCOUNT.FUND_NBR =
                                        TRAN.FUND_NBR)
                                AND (HDM.VW_FUND.FUND_COMPST_KEY =
                                        HDM.VW_FUND_COMPOSITE.FUND_COMPST_KEY)
                                AND HDM.VW_CALENDAR.DAY_KEY =
                                      (SELECT   DAY_KEY
                                         FROM   VW_CALENDAR
                                        WHERE   CAL_DAY =
                                                   (SELECT   MAX (CAL_DAY)
                                                      FROM   VW_CALENDAR
                                                     WHERE   CAL_DAY BETWEEN (TRUNC(SYSDATE)
                                                                              - 7)
                                                                         AND  TRUNC(SYSDATE
                                                                                    - 1)
                                                             AND BUS_DAY_FLG =
                                                                   'Y'))
                                AND HDM.VW_CURRENT_ACCOUNT.DLR_LVL_CNTL_CD <>
                                      3
                                AND HDM.VW_FUND.SHR_CLS_DESC =
                                      'Institutional Class'
                                AND HDM.VW_CURRENT_ACCOUNT.ACCT_STAT <>
                                      'Closed Status '
                                AND HDM.VW_DEALER.DLR_ID = '5471')
/



CREATE OR REPLACE FORCE VIEW HDM.VW_SUBSEQUENT_MIN_TRANSACTIONS(DATA_SOURCE, ACCT_NBR, ACCT_STAT, REGSTN_LINE_1, DLR_LVL_CNTL_CD, DLR_LVL_CNTL_DESC, FUND_NBR, FUND_SORT_ORD, COMPST_NM, AMT, REG_ACCT_INIT_INVMT, CAL_DAY, CUSTODIAN_ID) AS 
SELECT 'TransHist' AS data_source,
             hdm.vw_current_account.acct_nbr,
             hdm.vw_current_account.acct_stat,
             hdm.vw_current_account.regstn_line_1,
             hdm.vw_current_account.dlr_lvl_cntl_cd,
             hdm.vw_current_account.dlr_lvl_cntl_desc,
             hdm.vw_fund.fund_nbr,
             hdm.vw_fund.fund_sort_ord,
             hdm.vw_fund_composite.compst_nm,
             (CASE WHEN tran.shr_bal_effct_flg = 'S' THEN -1 ELSE 1 END)
             * tran.net_amt
                 amt,
             0 AS reg_acct_init_invmt,
             hdm.vw_calendar.cal_day,
             hdm.vw_current_account.custodian_id
      FROM hdm.vw_current_account,
             hdm.vw_fund,
             hdm.vw_fund_composite,
             hdm.vw_fund_trans_hist tran,
             hdm.vw_calendar,
             hdm.vw_dealer
     WHERE      (tran.dlr_key = hdm.vw_dealer.dlr_key)
             AND (tran.sttl_day_key = hdm.vw_calendar.day_key)
             AND (hdm.vw_fund.fund_key = hdm.tran.fund_key)
             AND (hdm.vw_current_account.acct_nbr = hdm.tran.acct_nbr
                    AND hdm.vw_current_account.fund_nbr = tran.fund_nbr)
             AND (hdm.vw_fund.fund_compst_key =
                        hdm.vw_fund_composite.fund_compst_key)
             AND hdm.vw_current_account.acct_setup_dt <
                      (SELECT MAX (cal_day)
                          FROM vw_calendar
                         WHERE cal_day BETWEEN (TRUNC (SYSDATE) - 7)
                                                 AND TRUNC (SYSDATE - 1)
                                 AND bus_day_flg = 'Y')
             AND hdm.vw_calendar.day_key =
                      (SELECT day_key
                          FROM vw_calendar
                         WHERE cal_day =
                                     (SELECT MAX (cal_day)
                                         FROM vw_calendar
                                        WHERE cal_day BETWEEN (TRUNC (SYSDATE) - 7)
                                                                AND TRUNC (SYSDATE - 1)
                                                AND bus_day_flg = 'Y'))
             AND hdm.vw_current_account.dlr_lvl_cntl_cd <> 3
             AND hdm.vw_fund.shr_cls_desc = 'Institutional Class'
             AND hdm.vw_current_account.acct_stat <> 'Closed Status '
             AND hdm.vw_dealer.dlr_id = '5471'
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_COMBINE_WI(TRGT_PERF_TYPE_KEY, TRGT_FUND_KEY, BMK_IDX_KEY, DAY_KEY, WLTH_IDX, ROW_STRT_DTTM) AS 
select DISTINCT
                TRGT_PERF_TYPE_KEY,
                TRGT_FUND_KEY,
                BMK_IDX_KEY,
                DAY_KEY,
                WLTH_IDX,
                ROW_STRT_DTTM
			FROM (			
				SELECT  -- TARGET AND MODEL RETURNS
				    TRGT_PERF_TYPE_KEY,
				    FUND_KEY TRGT_FUND_KEY,
				    NULL AS BMK_IDX_KEY,
				    DAY_KEY,
				    WLTH_IDX,
				    ROW_STRT_DTTM
				FROM HDM.VW_TARGET_WEALTH_INDEX
				--WHERE ROW_STRT_DTTM >  TO_DATE('$(vCheckDate)','MM/DD/YYYY HH24:MI:SS')
				UNION ALL
				SELECT  -- BENCHMARK INDEX
					(select trgt_perf_Type_key from hdm.vw_target_performance_type where trgt_perf_type = 'RIDX' ) AS TRGT_PERF_TYPE_KEY,
					FUND_KEY TRGT_FUND_KEY, IDX.BMK_IDX_KEY,idx.DAY_KEY,idx.IDX_VLTN_AMT,IDX.ROW_STRT_DTTM
					from hdm.vw_fund_composite fc,hdm.vw_fund f,hdm.vw_fund_index_rltn rl,hdm.vw_index_valuation idx,hdm.vw_benchmark_index bmk,hdm.vw_calendar cal
					where fc.FUND_COMPST_KEY = f.FUND_COMPST_KEY
					and fc.FUND_COMPST_KEY = rl.FUND_COMPST_KEY
					and rl.BMK_IDX_KEY = bmk.BMK_IDX_KEY
					and idx.BMK_IDX_KEY = bmk.BMK_IDX_KEY
					and idx.day_key=cal.day_key
					and cal_day >= to_date('31-dec-2008')
					and fc.ASSET_CLS_NM = 'Target Retirement'
					and f.SHR_CLS_DESC = 'Institutional Class'
					and perf_run_type_key = 3
					--AND IDX.ROW_STRT_DTTM >  TO_DATE('$(vCheckDate)','MM/DD/YYYY HH24:MI:SS')
				UNION ALL
				SELECT 
		            (select trgt_perf_Type_key from hdm.vw_target_performance_type where trgt_perf_type = 'RNAV' ) TRGT_PERF_TYPE_KEY,
		            FND.FUND_KEY,NULL BMK_IDX_KEY,CAL.DAY_KEY,VAL.WLTH_IDX,VAL.ROW_STRT_DTTM
		            FROM HDM.VW_FUND_VALUATION VAL, HDM.VW_FUND FND, HDM.VW_CALENDAR CAL,HDM.VW_FUND_COMPOSITE CMP
		            WHERE VAL.FUND_KEY = FND.FUND_KEY
		            AND VAL.DAY_KEY=CAL.DAY_KEY
		            AND FND.FUND_COMPST_KEY=CMP.FUND_COMPST_KEY
		            AND CMP.ASSET_CLS_NM = 'Target Retirement'
		            AND FND.SHR_CLS_DESC = 'Institutional Class'	
		            --AND VAL.ROW_STRT_DTTM >  TO_DATE('$(vCheckDate)','MM/DD/YYYY HH24:MI:SS')
		    )
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_CUSTOM_WEALTH_INDEX(TRGT_PERF_TYPE_KEY, DAY_KEY, FUND_KEY, BMK_IDX_KEY, FUND_COMPST_KEY, WLTH_IDX) AS 
select trgt_perf_type_key,day_key,f.fund_key,null as bmk_idx_key,fund_compst_key,wlth_idx
  from target_wealth_index a, fund f
  where a.fund_key=f.fund_key
  union all
  select trgt_perf_type_key,day_key,f.fund_key,null as bmk_idx_key,f.fund_compst_key,wlth_idx
  from fund_valuation a,target_performance_type t,FUND F,fund_composite cf
  where a.fund_key=f.fund_key
  and f.fund_compst_key=cf.fund_compst_key
  and trgt_perf_type='RNAV'
  and asset_cls_nm='Target Retirement'
  and shr_cls_desc = 'Institutional Class'
  union all
  select trgt_perf_type_key,day_key,fund.fund_key,a.bmk_idx_key,cf.fund_compst_key,idx_vltn_amt
  from index_valuation a,target_performance_type t,fund_composite cf,fund_index_rltn rl,fund
  where rl.fund_compst_key=cf.fund_compst_key
  and a.bmk_idx_key=rl.bmk_idx_key
  and cf.fund_compst_key=fund.fund_compst_key
  and fund.shr_cls_cd = 1
  and trgt_perf_type='RIDX'
  and asset_cls_nm='Target Retirement' 
  and perf_run_type_key=2
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_DAILY_WEIGHT(TRGT_DAILY_WGT_KEY, TRGT_FUND_KEY, DAY_KEY, FUND_KEY, SHR_QTY, MKT_VAL, DAILY_HOLDG_WGT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_DAILY_WGT_KEY","TRGT_FUND_KEY","DAY_KEY","FUND_KEY","SHR_QTY","MKT_VAL","DAILY_HOLDG_WGT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Target_Daily_Weight
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_ORIG_GLIDEPATH(ORIG_GP_KEY, TRGT_FUND_KEY, FUND_KEY, TRGT_YR, EFFTV_STRT_DT, EFFTV_END_DT, GP_WGT, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "ORIG_GP_KEY","TRGT_FUND_KEY","FUND_KEY","TRGT_YR","EFFTV_STRT_DT","EFFTV_END_DT","GP_WGT","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Target_Orig_glidepath
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_PERFORMANCE_TYPE(TRGT_PERF_TYPE_KEY, TRGT_PERF_TYPE, TRGT_PERF_TYPE_DESC, PERF_SORT_ORD, PERF_TYPE_FLG, OBJ_TYPE) AS 
SELECT "TRGT_PERF_TYPE_KEY","TRGT_PERF_TYPE","TRGT_PERF_TYPE_DESC","PERF_SORT_ORD","PERF_TYPE_FLG","OBJ_TYPE" FROM TARGET_PERFORMANCE_TYPE
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_RETURN(TRGT_RET_KEY, FUND_KEY, TRGT_PERF_TYPE_KEY, DAY_KEY, PER_KEY, BMK_IDX_KEY, TRGT_RET, BEG_DT, ANNLZN_FCTR, DISPL_SORT_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_RET_KEY","FUND_KEY","TRGT_PERF_TYPE_KEY","DAY_KEY","PER_KEY","BMK_IDX_KEY","TRGT_RET","BEG_DT","ANNLZN_FCTR","DISPL_SORT_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Target_Return
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_WEALTH_INDEX(TRGT_WLTH_IDX_KEY, TRGT_PERF_TYPE_KEY, DAY_KEY, FUND_KEY, WLTH_IDX, DAILY_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_WLTH_IDX_KEY","TRGT_PERF_TYPE_KEY","DAY_KEY","FUND_KEY","WLTH_IDX","DAILY_RET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Target_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_WEIGHTS(TRGT_WGT_KEY, TRGT_FUND_KEY, EFFTV_STRT_DT, EFFTV_END_DT, FUND_KEY, TRGT_FUND_WGT, WGT_TYPE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_WGT_KEY","TRGT_FUND_KEY","EFFTV_STRT_DT","EFFTV_END_DT","FUND_KEY","TRGT_FUND_WGT","WGT_TYPE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Target_Weights
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TARGET_WEIGHT_RETURN(CAL_DAY, TARGET_FUND, TARGET_SORT, FUND_NM, FUND_SORT_ORD, IDX_NM, FUND_RET, IDX_RET, TRGT_FUND_WGT, EFFTV_STRT_DT, EFFTV_END_DT, WEIGHT_RET) AS 
SELECT C.CAL_DAY,TF.FUND_NM TARGET_FUND,TF.FUND_SORT_ORD TARGET_SORT,F.FUND_NM,F.FUND_SORT_ORD,idx_nm, fund_ret, idx_ret ,trgt_fund_wgt,EFFTV_STRT_DT,EFFTV_END_DT, idx_ret * trgt_fund_wgt weight_ret
            FROM HDM.vw_tARGET_weights wt,HDM.VW_fund tf,HDM.VW_fund_index_rltn rl,HDM.VW_fund f,HDM.VW_benchmark_index b
            ,HDM.VW_fund_return v,HDM.VW_calendar c,HDM.VW_return_periods p,HDM.VW_PERF_RUN_TYPE t,HDM.VW_index_return idr
            WHERE wt.trgt_fund_key=tf.fund_key
            and wt.fund_key=f.fund_key
            and f.fund_compst_key = rl.fund_compst_key
            and rl.bmk_idx_key=b.bmk_idx_key
            and v.fund_key=f.fund_key
            and v.day_key=c.day_key
            and v.per_key=p.per_key
            and rl.perf_run_type_key=t.perf_run_type_key
            and rl.bmk_idx_key=idr.bmk_idx_key
            and rl.fund_compst_key=idr.fund_compst_key
            and idr.day_key=c.day_key
            and idr.per_key=p.per_key
            AND efftv_strt_dt <= c.cal_day AND efftv_end_dt >= c.cal_day
            AND wgt_type IN ('FIRM')
            AND (tf.fund_stat_cd in (1,5) or (tf.fund_incpn_dt <= c.cal_day and tf.fund_clos_dt >= c.cal_day))
            and rl.prim_bmk_flg = 'Y'
            and rl.link_prio = 1  
            and c.cal_day BETWEEN '01-jan-2016' AND  '30-sep-2016'  
            and per_nm = '1DY' 
            AND TF.FUND_NBR=2600
            and t.run_type_cd ='REPORTING'     
            ORDER BY CAL_DAY,FUND_SORT_ORD
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TGTX_RETURN(TRGT_RET_KEY, FUND_KEY, TRGT_PERF_TYPE_KEY, DAY_KEY, PER_KEY, BMK_IDX_KEY, TRGT_RET, BEG_DT, ANNLZN_FCTR, DISPL_SORT_ORD, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_RET_KEY","FUND_KEY","TRGT_PERF_TYPE_KEY","DAY_KEY","PER_KEY","BMK_IDX_KEY","TRGT_RET","BEG_DT","ANNLZN_FCTR","DISPL_SORT_ORD","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM tgtx_Return
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TGTX_WEALTH_INDEX(TRGT_WLTH_IDX_KEY, TRGT_PERF_TYPE_KEY, DAY_KEY, FUND_KEY, WLTH_IDX, DAILY_RET, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_WLTH_IDX_KEY","TRGT_PERF_TYPE_KEY","DAY_KEY","FUND_KEY","WLTH_IDX","DAILY_RET","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM tgtx_Wealth_Index
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TGTX_WEIGHTS(TRGT_WGT_KEY, TRGT_FUND_KEY, EFFTV_STRT_DT, EFFTV_END_DT, FUND_KEY, TRGT_FUND_WGT, WGT_TYPE, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "TRGT_WGT_KEY","TRGT_FUND_KEY","EFFTV_STRT_DT","EFFTV_END_DT","FUND_KEY","TRGT_FUND_WGT","WGT_TYPE","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM tgtx_Weights
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TRADE_ENTRY_METHOD(TRDE_ENTRY_MTHD_KEY, TRDE_ENTRY_MTHD_CD, TRDE_ENTRY_MTHD_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
SELECT "TRDE_ENTRY_MTHD_KEY","TRDE_ENTRY_MTHD_CD","TRDE_ENTRY_MTHD_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" FROM Trade_Entry_Method
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TRADE_ORIGIN(TRDE_ORIG_KEY, TRDE_ORIG_ID, TRDE_ORIG_DESC, ROW_STRT_DTTM, ROW_STOP_DTTM, CURR_ROW_FLG, SRC_SYS_ID, ETL_LOAD_CYC_KEY) AS 
SELECT "TRDE_ORIG_KEY","TRDE_ORIG_ID","TRDE_ORIG_DESC","ROW_STRT_DTTM","ROW_STOP_DTTM","CURR_ROW_FLG","SRC_SYS_ID","ETL_LOAD_CYC_KEY" FROM Trade_Origin
/



CREATE OR REPLACE FORCE VIEW HDM.VW_TRANSACTION_TYPE(TXN_TYPE_KEY, TXN_SFX_CD, TXN_CD, TXN_CD_DESC, TXN_TYPE_CD, TXN_TYPE_DESC, TOP_LVL_TXN_CD, TOP_LVL_TXN_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID, SHR_BAL_EFFCT_FLG) AS 
SELECT "TXN_TYPE_KEY", "TXN_SFX_CD", "TXN_CD", "TXN_CD_DESC",
          "TXN_TYPE_CD", "TXN_TYPE_DESC", "TOP_LVL_TXN_CD",
          "TOP_LVL_TXN_DESC", "CURR_ROW_FLG", "ROW_STRT_DTTM",
          "ROW_STOP_DTTM", "ETL_LOAD_CYC_KEY", "SRC_SYS_ID","SHR_BAL_EFFCT_FLG"
     FROM transaction_type
/



CREATE OR REPLACE FORCE VIEW HDM.VW_UNIVERSE(UNIV_KEY, UNIV_NM, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "UNIV_KEY","UNIV_NM","CURR_ROW_FLG","ROW_STRT_DTTM","ROW_STOP_DTTM","ETL_LOAD_CYC_KEY","SRC_SYS_ID" FROM Universe
/



CREATE OR REPLACE FORCE VIEW HDM.VW_YIELD_TYPES(YLD_TYPE_KEY, YLD_CD, YLD_DESC, CURR_ROW_FLG, ROW_STRT_DTTM, ROW_STOP_DTTM, ETL_LOAD_CYC_KEY, SRC_SYS_ID) AS 
SELECT "YLD_TYPE_KEY",
          "YLD_CD",
          "YLD_DESC",
          "CURR_ROW_FLG",
          "ROW_STRT_DTTM",
          "ROW_STOP_DTTM",
          "ETL_LOAD_CYC_KEY",
          "SRC_SYS_ID"
     FROM Yield_Types
/




 

